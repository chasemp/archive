<?xml version="1.0" encoding="UTF-8"?>

    <feed xmlns="http://www.w3.org/2005/Atom">
        <title>devops type thoughts</title>
        
        <link rel="alternate" href="/" />
        <link rel="self" href="/feed.xml" type="application/atom+xml" />
        <id>/</id>
        <updated>2015-10-09T22:53:45Z</updated>
        
        <author>
            <name>Chase Pettet</name>
            <email>chase.mp@gmail.com</email>
            <uri>/</uri>
        </author>
        
        
            <entry>
                <title>apache top</title>
                <link rel="alternate" href="/2015/10/09/apache-top/" type="text/html" />
                <id>/2015/10/09/apache-top/</id>
                <updated>2015-10-09T22:52:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;There are a few different approaches to getting &amp;#39;top&amp;#39; style insight into Apache2.x&lt;/p&gt;
&lt;h4&gt;Debian/Ubuntu &amp;#39;apachetop&amp;#39; (0.12.6-16)&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/nexcess/apachetop&#34;&gt;https://github.com/nexcess/apachetop&lt;/a&gt; (This is a fork)&lt;/p&gt;

&lt;p&gt;This is the version packaged natively for Debian.&lt;/p&gt;

&lt;p&gt;Assumes a common/combined access log file format:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apachetop -f &amp;#47;var&amp;#47;log&amp;#47;apache&amp;#47;access.log
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
last hit: 19:37:04         atop runtime:  0 days, 00:01:15             19:37:05
All:          429 reqs (   5.8/sec)       4742.7K (   64.1K/sec)      11.1K/req
2xx:     228 (53.1%) 3xx:      57 (13.3%) 4xx:     0 ( 0.0%) 5xx:   144 (33.6%)
R ( 30s):     194 reqs (   6.5/sec)       2514.0K (   83.8K/sec)      13.0K/req
2xx:      95 (49.0%) 3xx:      35 (18.0%) 4xx:     0 ( 0.0%) 5xx:    64 (33.0%)

 REQS REQ/S    KB KB/S URL
   72  2.40 873.6 29.1*/robots.txt
   28  0.93  12.3  0.4 /foo/bar
    2  0.18   1.7  0.2 /login/refresh/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can specify how many Hits (-H) or second (-T) to remember stats across (mutually exclusive).&lt;/p&gt;

&lt;p&gt;Pros:&lt;br&gt;
- Fast&lt;br&gt;
- Easily available&lt;br&gt;
- Minimum dependency&lt;br&gt;
- Forked on github&lt;/p&gt;

&lt;p&gt;Cons:&lt;br&gt;
- Missing insights that a mod_status solution has access to&lt;br&gt;
- I can&amp;#39;t get it to process the error.log&lt;br&gt;
- Stricly ncurses&lt;br&gt;
- Original seems dead &lt;a href=&#34;http://www.webta.org/projects/apachetop/&#34;&gt;http://www.webta.org/projects/apachetop/&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Apache-top&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/fr3nd/apache-top/blob/master/apache-top.py&#34;&gt;https://github.com/fr3nd/apache-top/blob/master/apache-top.py&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;apache-top -u http:&amp;#47;&amp;#47;127.0.0.1&amp;#47;server-status
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Parent Server Config. Generation: 3,
Current Time: Friday, 09-Oct-2015 19:53:25 UTC
Server uptime:  1 day 18 hours 36 minutes 29 seconds
Server load: 2.62 2.77 2.77, Active/Idle: Total/Traffic:
___._._....__..._.....W__.__..._.__..__.K_..._W_.___.._.
........................................................
........................................................
PID   M SS     CPU  VHost           IP              Request
37059 K 1   338.81  myhost.com10.1.1.1    GET /foo HTTP/1.1
5537  K 0   142.38  myhost.com10.1.1.2    GET /bar/ HTTP/1.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can sort the live output by a few criteria:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;P   Sort by PID
C   Sort by CPU usage
S   Sort by Seconds since beginning of most recent request
V   Sort by VirtualHost
M   Sort by Mopde of operation
R   Sort by Request
I   Sort by Ip
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Pros:&lt;br&gt;
- Python&lt;br&gt;
- Easily available-ish&lt;br&gt;
- Minimum dependency&lt;/p&gt;

&lt;p&gt;Cons:&lt;br&gt;
- Requires mod_status&lt;br&gt;
- Stricly ncurses&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://fr3nd.net/projects/apache-top/&#34;&gt;apache-top&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;apachetop.py (without ncurses)&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/gwillem/apachetop&#34;&gt;https://github.com/gwillem/apachetop&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I like this tool a lot and I am currently working off a small &lt;a href=&#34;https://github.com/gwillem/apachetop/pull/1&#34;&gt;fork&lt;/a&gt; but&lt;br&gt;
I have intiated a &lt;a href=&#34;https://github.com/gwillem/apachetop/pull/1&#34;&gt;Pull Request&lt;/a&gt; for my small changes.&lt;/p&gt;

&lt;p&gt;Show all non-idle workers (default output):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
pid  21019 sec 1 state W client 10.1.1.1 host mysite.com:80 uri GET /bar HTTP/1.1
pid   5774 sec 0 state K client 10.1.1.2 host mysite.com:80 uri GET /foo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;There are a number of cool and useful examples in the &lt;a href=&#34;https://github.com/gwillem/apachetop/blob/master/README.md&#34;&gt;Readme&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Repurposed the apache status parsing from apache-top.py.&lt;br&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/gwillem/apachetop&#34;&gt;cli apachetop&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Pros:&lt;br&gt;
- Python&lt;br&gt;
- Easily available-ish&lt;br&gt;
- Minimum dependency&lt;br&gt;
- &lt;a href=&#34;https://en.wikipedia.org/wiki/Unix_philosophy&#34;&gt;Unix Philosophy&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Cons:&lt;br&gt;
- Requires mod_status&lt;br&gt;
- Requires &amp;#39;watch&amp;#39; for live updating&lt;/p&gt;
&lt;h4&gt;atop&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://raw.githubusercontent.com/chnm/atop/master/atop&#34;&gt;https://raw.githubusercontent.com/chnm/atop/master/atop&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&amp;#39;links -dump &lt;a href=&#34;http://127.0.0.1/server-status&#34;&gt;http://127.0.0.1/server-status&lt;/a&gt;&amp;#39; succeeds manually but atop had issues&lt;/p&gt;

&lt;p&gt;Pros:&lt;br&gt;
- Bash&lt;br&gt;
- Easily available-ish&lt;br&gt;
- Minimum dependency&lt;/p&gt;

&lt;p&gt;Cons:&lt;br&gt;
- Didn&amp;#39;t actually work&lt;br&gt;
- Requires mod_status&lt;br&gt;
- Bash ;)&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://mossiso.com/2014/04/02/atop-apache-top-for-keeping-tabs-on-the-web-servers.html&#34;&gt;atop for web servers&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://httpd.apache.org/docs/2.4/mod/mod_status.html&#34;&gt;mod_status&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cyberciti.biz/faq/apache-server-status/&#34;&gt;nixcraft mod_status&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/chnm/atop&#34;&gt;atop&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://packages.debian.org/jessie/admin/apachetop&#34;&gt;debian apachetop package&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>specialty packet capture tools</title>
                <link rel="alternate" href="/2015/10/09/watching-web-traffic/" type="text/html" />
                <id>/2015/10/09/watching-web-traffic/</id>
                <updated>2015-10-09T22:50:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Situations where it&amp;#39;s useful to analyze traffic:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Don&amp;#39;t have access to the logs&lt;/li&gt;
&lt;li&gt;Want to look at traffic somewhere upstream like an LB&lt;/li&gt;
&lt;li&gt;Something is making logs ineffectual&lt;/li&gt;
&lt;li&gt;Other&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Pretty much all roads point to packet sniffing.&lt;/p&gt;
&lt;h4&gt;HTTPRY&lt;/h4&gt;
&lt;p&gt;An efficient packet sniffer aimed at HTTP&lt;/p&gt;

&lt;p&gt;No args output (as oneline but broken down for explanation):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
    2015-10-09 17:46:48         - timestamp
    10.0.0.1    10.0.0.2        - source-ip/dest-ip or vice versa (depending on arrow)
    &gt;                   - direction of traffic
    GET                 - http method
    foo.com             - http host
    /myuri              - the URI in question
    HTTP/1.1                - HTTP version
    -                   - status code
    -                   - reason
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The output fields are configurable.  Say you only serve one site on a box so the host&lt;br&gt;
field never changes and the objective is to narrow down a few suspect URI&amp;#39;s.&lt;/p&gt;

&lt;p&gt;httpry -f timestamp,source-ip,direction,request-uri&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;2015-10-09     18:10:43 10.0.0.1    &amp;gt;   &amp;#47;myuri
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Since httpry outputs text I can do things like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;httpry -f timestamp,source-ip,request-uri | egrep -i &amp;#39;\&amp;#47;myuri\&amp;#47;[0-9]&amp;#39;{6}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Other than text munging there are a few native mechanisms for targeting:&lt;/p&gt;

&lt;p&gt;tcpdump style filters&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;httpry &amp;#39;host 74.1.1.1 and port 8080&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;specifying an HTTP method for collection (along with ability to read/write Pcap)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;httpry -m GET,POST
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There is also a native statistics mode in &amp;#39;httpry -s&amp;#39; that by provides meta stats.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;2015-10-09 19:20:48 one.myhost.org     147 rps
2015-10-09 19:20:48 two.myhost.org     2 rps
2015-10-09 19:20:48 three.myhost.org   9 rps
2015-10-09 19:20:48 totals  156.46 rps
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Show me data aggregated in 30s buckets with a minimum treshold of 10/rps&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;httpry -s -l 10 -t 30 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;httpry has the ability to run as a daemon natively as well.&lt;/p&gt;
&lt;h4&gt;ngrep&lt;/h4&gt;
&lt;p&gt;Payload aware network search tool with grep and tcpdump like magic&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ngrep port 80 -W single

T 10.0.0.1:80 -&amp;gt; 10.0.0.2:65227 [AP] HTTP&amp;#47;1.1 200 OK..\
Date: Fri, 09 Oct 2015 21:45:16 GMT..\
Server: Apache..Strict-Transport-Security: max-age=31536000..\
X-Powered-By: PHP&amp;#47;5.5.9-1ubuntu4.13..X-Frame-Options: Deny..\
Cache-Control: private, no-cache, no-store, must-revalidate..
Pragma: no-cache..\
X-Content-Type-Options: nosniff..\
Content-Length: 49..Connection: close..Content-Type: application&amp;#47;json....\
{&amp;quot;result&amp;quot;:[],&amp;quot;error_code&amp;quot;:null,&amp;quot;error_info&amp;quot;:null}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So what if we are behind a reverse proxy and the header source IP address is only&lt;br&gt;
part of the story.  Most likely we want to analyze the X-Forwarded-For field.&lt;/p&gt;

&lt;p&gt;Sample our web traffic honoring embedded linefeeds (newline) looking for X-forwarded-for&lt;br&gt;
header fields, extracting the initial IP value, and showing the top 10 IP&amp;#39;s.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ngrep -n 1000 port 80 -W byline | \
grep -i x-forwarded-for | \
awk &amp;#39;{print $2}&amp;#39; | \
cut -d &amp;#39;,&amp;#39; -f 1 | sort | uniq -c | sort -n | tail -n 10
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Watching for mail the hard way: &amp;#39;ngrep &amp;#39;vacation&amp;#39; port 25&amp;#39;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;T 2620::62748 -&amp;gt; 2620::76:25 [A]
Return-Path: no-reply@mail.org..To: foo@mail.org..From: dude &amp;lt;no-reply
@dude.org&amp;gt;..Reply-to: noway@mail.org..Subject: foo asked for vacation
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ngrep is extremely powerful but is vulnerable to packet fragmentation.&lt;/p&gt;
&lt;h4&gt;netsniff-ng&lt;/h4&gt;
&lt;p&gt;A super efficient packet capture tool that is Pcap independent&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#47;usr&amp;#47;sbin&amp;#47;netsniff-ng
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
&lt; 3 66 1444429202.367551
 [ Eth MAC (84:78:ac:5a:19:41 =&gt; f2:3c:91:6e:f6:f5), Proto (0x0800, IPv4) ]
 [ Vendor (Unknown =&gt; Unknown) ]
 [ IPv4 Addr (99.x.x.x =&gt; 74.x.x.x), Proto (6), TTL (53), TOS (0), Ver (4),
   IHL (5), Tlen (52), ID (48089), Res (0), NoFrag (1), MoreFrag (0), FragOff (0), CS
   um (0x0daf) is ok ]
 [ TCP Port (62403 =&gt; 22 (ssh)), SN (0xbb019f19), AN (0xf7b8096d), DataOff (8
   ), Res (0), Flags (ACK ), Window (8189), CSum (0x33aa), UrgPtr (0) ]
 [ chr ....T...M..O ]
 [ hex  01 01 08 0a 54 d4 be f7 4d a3 f6 4f ]
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;netsniff-ng is interesting for a few reasons:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;It uses a zero-copy mechanism for packet capture (libpcap &amp;gt;1.0 does now too)&lt;/li&gt;
&lt;li&gt;It doesn&amp;#39;t need libpcap&lt;/li&gt;
&lt;li&gt;It can write to libpcap format really efficiently&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://dumpsterventures.com/jason/httpry/&#34;&gt;httpry main&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://isc.sans.edu/forums/diary/Web+Traffic+Analysis+with+httpry/9295/&#34;&gt;httpry 1&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://manpages.ubuntu.com/manpages/utopic/man1/httpry.1.html&#34;&gt;httpry man&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://taosecurity.blogspot.com/2008/06/logging-web-traffic-with-httpry.html&#34;&gt;tao security httpry&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://blog.mosinu.com/?p=239&#34;&gt;tcpdump tips&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://ngrep.sourceforge.net/&#34;&gt;ngrep sourceforge&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.stearns.org/doc/ngrep-intro.current.html&#34;&gt;ngrep intro&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/netsniff-ng/netsniff-ng&#34;&gt;netsniff-ng gh&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://en.wikipedia.org/wiki/Netsniff-ng&#34;&gt;netsniff-ng wp&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>IPv4 pool is empty</title>
                <link rel="alternate" href="/2015/09/25/IPv4-pool-is-empty/" type="text/html" />
                <id>/2015/09/25/IPv4-pool-is-empty/</id>
                <updated>2015-09-25T20:33:00Z</updated>
                
                <summary type="html">&lt;a href=&#34;https://www.arin.net/announcements/2015/20150924.html&#34;&gt;ARIN IPv4 Free Pool Reaches Zero&lt;/a&gt;</summary>
                <content type="html">&lt;p&gt;&lt;a href=&#34;https://www.arin.net/announcements/2015/20150924.html&#34;&gt;ARIN IPv4 Free Pool Reaches Zero&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Wow.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://www.google.com/intl/en/ipv6/statistics.html&#34;&gt;Related&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>top batches</title>
                <link rel="alternate" href="/2015/09/25/keeping-an-eye-on-top/" type="text/html" />
                <id>/2015/09/25/keeping-an-eye-on-top/</id>
                <updated>2015-09-25T17:30:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;It&amp;#39;s nice to have atop or sar running for a historical look at resource usage, but&lt;br&gt;
in some cases these are not available.  &amp;#39;Top&amp;#39; is nearly universally available.&lt;/p&gt;
&lt;h4&gt;What Top does&lt;/h4&gt;
&lt;p&gt;Gives you information on your system&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
top - 20:49:24 up  3:59,  1 user,  load average: 1.01, 1.03, 1.10
Tasks: 353 total,   1 running, 351 sleeping,   0 stopped,   1 zombie
%Cpu(s):  0.3 us,  0.1 sy,  0.0 ni, 99.6 id,  0.0 wa,  0.0 hi,  0.0 si,  0.0 st
KiB Mem:  19805422+total, 11105584 used, 18694864+free,   507824 buffers
KiB Swap:        0 total,        0 used,        0 free.  7263240 cached Mem

  PID USER      PR  NI    VIRT    RES    SHR S  %CPU %MEM     TIME+ COMMAND
 2286 myproc   20   0  0.705t 4.291g 3.053g S  19.4  2.3   9:28.25 myprocd
 1199 myproc   20   0  525620 128020  86240 S  12.9  0.1   8:22.71 myprocd
    3 root      20   0       0      0      0 S   6.5  0.0   0:04.11 ksoftirqd/0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Running natively in interactive mode &amp;#39;top&amp;#39; allows you to filter and sort.&lt;/p&gt;
&lt;h4&gt;Breaking down top output for redirection&lt;/h4&gt;
&lt;p&gt;Now we can run top in batch mode for one cycle redirecting output.  This&lt;br&gt;
absolutely could fill /tmp if you let it run wild.  This will show&lt;br&gt;
only the information on individual processes.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;top -n 1 -b \
| head -n 25 \
| egrep -v &amp;quot;top|Tasks|Cpu|Mem|Swap|PID&amp;quot; \
| tee &amp;#47;tmp&amp;#47;`date +&amp;quot;%m-%d-%y_%M:%S&amp;quot;`
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Example:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
1199 myproc   20   0  525620 138988  86240 S  12.9  0.1   9:07.36 myprocd
 2286 myproc   20   0  0.705t 4.336g 3.085g S   6.4  2.3  10:11.36 myprocd
 2297 root      20   0  137836  92084  85936 S   6.4  0.0   1:15.59 python
    1 root      20   0   28724   5108   3104 S   0.0  0.0   0:04.93 systemd
    2 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kthreadd
    3 root      20   0       0      0      0 S   0.0  0.0   0:04.24 ksoftirqd/0
    5 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/0:0H
    6 root      20   0       0      0      0 S   0.0  0.0   0:00.02 kworker/u64:0
    8 root      20   0       0      0      0 S   0.0  0.0   1:01.80 rcu_sched
    9 root      20   0       0      0      0 S   0.0  0.0   0:00.00 rcu_bh
   10 root      rt   0       0      0      0 S   0.0  0.0   0:00.06 migration/0
   11 root      rt   0       0      0      0 S   0.0  0.0   0:00.06 watchdog/0
   12 root      rt   0       0      0      0 S   0.0  0.0   0:00.05 watchdog/1
   13 root      rt   0       0      0      0 S   0.0  0.0   0:00.05 migration/1
   14 root      20   0       0      0      0 S   0.0  0.0   0:04.38 ksoftirqd/1
   15 root      20   0       0      0      0 S   0.0  0.0   0:00.00 kworker/1:0
   16 root       0 -20       0      0      0 S   0.0  0.0   0:00.00 kworker/1:0H
   18 root      rt   0       0      0      0 S   0.0  0.0   0:00.04 watchdog/2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I would love it if you could do this with htop, but alas it does not support&lt;br&gt;
batch mode.&lt;/p&gt;

&lt;p&gt;use watch -n 30 &amp;#39;$TOP_CMD&amp;#39; to run in console.  I have seen tools like Splunk/ELK use&lt;br&gt;
a similar method to get this output into a central logging tool.&lt;/p&gt;
&lt;h4&gt;References&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Sar_%28Unix%29&#34;&gt;sar&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://linux.die.net/man/1/atop&#34;&gt;atop&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://hisham.hm/htop/&#34;&gt;htop&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://lwn.net/Articles/387202/&#34;&gt;atop lwn&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>post mortems</title>
                <link rel="alternate" href="/2015/08/13/post-mortems/" type="text/html" />
                <id>/2015/08/13/post-mortems/</id>
                <updated>2015-08-13T18:44:00Z</updated>
                
                <summary type="html">&lt;a href=&#34;https://github.com/danluu/post-mortems&#34;&gt;https://github.com/danluu/post-mortems&lt;/a&gt;</summary>
                <content type="html">&lt;p&gt;&lt;a href=&#34;https://github.com/danluu/post-mortems&#34;&gt;https://github.com/danluu/post-mortems&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>exploring elasticsearch _cat</title>
                <link rel="alternate" href="/2015/08/05/exploring-elasticsearch-_cat/" type="text/html" />
                <id>/2015/08/05/exploring-elasticsearch-_cat/</id>
                <updated>2015-08-05T21:01:00Z</updated>
                
                <summary type="html">==== Preamble</summary>
                <content type="html">&lt;p&gt;==== Preamble&lt;/p&gt;

&lt;p&gt;If you want to index and search your documents with lucene then&lt;br&gt;
Elasticsearch seems to be the popular way to do so while adding&lt;br&gt;
redundandcy, clustering, and an API on top of Lucene.  Elasticsearch&lt;br&gt;
has a collection of REST API&amp;#39;s with one subset not returning json at all.&lt;br&gt;
The _cat API is meant for humans.  While there are CLI tools made&lt;br&gt;
for parsing json most of the popular tools we are used to are more&lt;br&gt;
natively served with raw textual data.&lt;/p&gt;
&lt;h4&gt;Making sure the API is responding&lt;/h4&gt;
&lt;p&gt;It&amp;#39;s worth noting that when a cluster is new and has no designated&lt;br&gt;
master nodes this API seems to hang indefinitely.  If there is a splitbrain&lt;br&gt;
problem the same thing occurs.  This can be really concerning if you are&lt;br&gt;
in trouble master role wise as the API you expect to query will not respond.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[2015-09-16 17:04:08,233][DEBUG][action.admin.cluster.health] \
[elastic-node] no known master node, scheduling a retry
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There can be duplicate information across API calls.  For instance, in order&lt;br&gt;
to make sense of the shards you undoubtably need the index status.  Whatever&lt;br&gt;
endpoint is more appropriate is ultimately a matter of perspective.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl -s &amp;#39;http:&amp;#47;&amp;#47;localhost:9200&amp;#47;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;{&lt;br&gt;
  &amp;ldquo;status&amp;rdquo; : 200,&lt;br&gt;
  &amp;ldquo;name&amp;rdquo; : &amp;ldquo;elastic-node&amp;rdquo;,&lt;br&gt;
  &amp;ldquo;cluster_name&amp;rdquo; : &amp;ldquo;my-cluster-name&amp;rdquo;,&lt;br&gt;
  &amp;ldquo;version&amp;rdquo; : {&lt;br&gt;
    &amp;ldquo;number&amp;rdquo; : &amp;ldquo;1.7.1&amp;rdquo;,&lt;br&gt;
    &amp;ldquo;build_hash&amp;rdquo; : &amp;ldquo;&amp;rdquo;,&lt;br&gt;
    &amp;ldquo;build_timestamp&amp;rdquo; : &amp;ldquo;2015-07-29T09:54:16Z&amp;rdquo;,&lt;br&gt;
    &amp;ldquo;build_snapshot&amp;rdquo; : false,&lt;br&gt;
    &amp;ldquo;lucene_version&amp;rdquo; : &amp;ldquo;4.10.4&amp;rdquo;&lt;br&gt;
  },&lt;br&gt;
  &amp;ldquo;tagline&amp;rdquo; : &amp;ldquo;You Know, for Search&amp;rdquo;&lt;br&gt;
}&lt;/p&gt;
&lt;h4&gt;Cat&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;curl -s localhost:9200&amp;#47;_cat&amp;#47;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-aliases.html&#34;&gt;aliases&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.elastic.co/guide/en/elasticsearch/reference/current/index-modules-allocation.html&#34;&gt;allocation&lt;/a&gt;&lt;br&gt;
count - document count&lt;br&gt;
fielddata   -   field data by index&lt;br&gt;
health      -   cluster health&lt;br&gt;
indices     -   index overview and status&lt;br&gt;
master      -   find current master node&lt;br&gt;
nodes       -   node status(es)&lt;br&gt;
pending_tasks   -   task backlog information &lt;br&gt;
plugins     -   plugins and versions across all nodes&lt;br&gt;
recovery    -   index/shard status with movement info&lt;br&gt;
thread pool -   tons of info on active threads across nodes&lt;br&gt;
shards      -   tons of info on shard states&lt;br&gt;
&lt;a href=&#34;https://www.elastic.co/guide/en/elasticsearch/reference/current/indices-segments.html&#34;&gt;segments&lt;/a&gt;   -   low level segment info&lt;/p&gt;
&lt;h4&gt;_cat tricks&lt;/h4&gt;&lt;h3&gt;Seeing all possible columns&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;curl &amp;#39;localhost:9200&amp;#47;_cat&amp;#47;master?help&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;id   |   | node id&lt;br&gt;
host | h | host name&lt;br&gt;
ip   |   | ip address&lt;br&gt;
node | n | node name&lt;/p&gt;
&lt;h3&gt;Column headers&lt;/h3&gt;
&lt;p&gt;A note is this will not show columns for which there are no data.  This is&lt;br&gt;
noticeable for a few endpoints such as fielddata especially.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl &amp;#39;localhost:9200&amp;#47;_cat&amp;#47;master?v&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;id                     host        ip            node&lt;br&gt;
1234         elastic-node 10.0.0.143 elastic-node&lt;/p&gt;
&lt;h3&gt;Picking relevant column headers&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;curl localhost:9200&amp;#47;_cat&amp;#47;master?h=&amp;#39;host&amp;#39;

elastic-node

curl localhost:9200&amp;#47;_cat&amp;#47;master?h=&amp;#39;host,ip&amp;#39;

elastic-node 10.0.0.143
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Watching shard movement&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;curl -s &amp;#39;localhost:9200&amp;#47;_cat&amp;#47;recovery?active_only=true&amp;#39; | \
awk &amp;#39;{printf &amp;quot;%-19s %6s %-12s =&amp;gt; %-12s\n&amp;quot;, $1, $13, $6, $7}&amp;#39; | \
sort -n -k2 -r

myindex  59.1% elastic-node1  =&amp;gt; elastic-node2
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://aphyr.com/posts/323-call-me-maybe-elasticsearch-1-5-0&#34;&gt;https://aphyr.com/posts/323-call-me-maybe-elasticsearch-1-5-0&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>gpg getting started</title>
                <link rel="alternate" href="/2015/04/29/gpg-getting-started/" type="text/html" />
                <id>/2015/04/29/gpg-getting-started/</id>
                <updated>2015-04-29T22:21:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I am regenerating my GPG key&lt;/p&gt;

&lt;p&gt;( This is not my actual key shown )&lt;/p&gt;
&lt;h4&gt;PGP&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Pretty_Good_Privacy&#34;&gt;PGP&lt;/a&gt; is an encryption standard.  GNU PG (GPG) is a common implementation.  GPG is&lt;br&gt;
used to transmit items securely, verify the integrity of source material, or to&lt;br&gt;
verify the identities of two parties.&lt;/p&gt;

&lt;p&gt;See reference for a download link and install a GPG implementation.&lt;/p&gt;
&lt;h4&gt;Generating a key pair&lt;/h4&gt;
&lt;p&gt;Options: RSA/RSA, 4096, Valid for a year or more (this can be updated later)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gpg --gen-key
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
gpg (GnuPG/MacGPG2) 2.0.27; Copyright (C) 2015 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please select what kind of key you want:
   (1) RSA and RSA (default)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection? 1
RSA keys may be between 1024 and 8192 bits long.
What keysize do you want? (2048) 4096
Requested keysize is 4096 bits
Please specify how long the key should be valid.
         0 = key does not expire
      &lt;n&gt;  = key expires in n days
      &lt;n&gt;w = key expires in n weeks
      &lt;n&gt;m = key expires in n months
      &lt;n&gt;y = key expires in n years
Key is valid for? (0)
Key does not expire at all
Is this correct? (y/N) y

GnuPG needs to construct a user ID to identify your key.

Real name: My Name
Email address: me@email.com
Comment: test key
You selected this USER-ID:
    &#34;My Name (test key) &lt;me@email.com&gt;&#34;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
You need a Passphrase to protect your secret key.

We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; this gives the random number
generator a better chance to gain enough entropy.
gpg: key 9C6095EA marked as ultimately trusted
public and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   3  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 3u
gpg: next trustdb check due at 2016-04-29
pub   4096R/9C6095EA 2015-04-29
      Key fingerprint = B670 6F65 43A0 76A3 FAF7  42DF D7F9 EDD5 9C60 95EA
uid       [ultimate] My Name (test key) &lt;me@email.com&gt;
sub   4096R/9A8C2CA5 2015-04-29
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Show my key&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;gpg --list-key me@email.com

pub   4096R&amp;#47;9C6095EA 2015-04-29
uid       [ultimate] My Name (test key) &amp;lt;me@email.com&amp;gt;
sub   4096R&amp;#47;9A8C2CA5 2015-04-29
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is my 32 bit identifier for this key: 9C6095EA.  Use the full fingerprint usually.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gpg --fingerprint 9C6095EA

pub   4096R&amp;#47;9C6095EA 2015-04-29
    Key fingerprint = B670 6F65 43A0 76A3 FAF7  42DF D7F9 EDD5 9C60 95EA
uid       [ultimate] My Name (test key) &amp;lt;me@email.com&amp;gt;
sub    4096R&amp;#47;9A8C2CA5 2015-04-29
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is your key fingerprint: &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;B670 6F65 43A0 76A3 FAF7  42DF D7F9 EDD5 9C60 95EA
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Now we can publish our key for others to find&lt;/h4&gt;
&lt;p&gt;Make sure a keyserver pool is configured such as &amp;#39;keyserver hkps://hkps.pool.sks-keyservers.net&amp;#39;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;grep -E ^keyserver * | grep pool
gpg.conf:keyserver hkps:&amp;#47;&amp;#47;hkps.pool.sks-keyservers.net
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Upload your new key:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gpg --send-keys
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Search for your new key (this may take a minute to propogate):&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;gpg  --search-keys &amp;#39;test key&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Finding keys for other people&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;gpg  --search-keys &amp;#39;linus torvalds&amp;#39;

Linus Torvalds &amp;lt;torvalds@linux-foundation.org&amp;gt;
2048 bit RSA key 00411886, created: 2011-09-20
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Remove a key from the keyring (private key)&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;gpg --delete-secret-keys me@email.com

gpg (GnuPG&amp;#47;MacGPG2) 2.0.27; Copyright (C) 2015 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

sec  4096R&amp;#47;9C6095EA 2015-04-29 My Name (test key) &amp;lt;me@email.com&amp;gt;

Delete this key from the keyring? (y&amp;#47;N) y
This is a secret key! - really delete? (y&amp;#47;N) y
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://gnupg.org/download/index.html&#34;&gt;download&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://sks-keyservers.net&#34;&gt;key servers&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://evil32.com/&#34;&gt;evil 32bit&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://en.wikipedia.org/wiki/Web_of_trust&#34;&gt;web of trust&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://www.gnupg.org/gph/en/manual/x110.html&#34;&gt;encrypt a file with gpg&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>RIPE Atlas Getting Started</title>
                <link rel="alternate" href="/2015/04/08/RIPE-Atlas-Getting-Started/" type="text/html" />
                <id>/2015/04/08/RIPE-Atlas-Getting-Started/</id>
                <updated>2015-04-08T23:15:00Z</updated>
                
                
                <content type="html">&lt;h3&gt;Preamble&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/R%C3%A9seaux_IP_Europ%C3%A9ens_Network_Coordination_Centre&#34;&gt;RIPE NCC&lt;/a&gt; is one of the Regional Internet Registries.  There are 5 (RIR&amp;#39;s) and RIPE NCC&lt;br&gt;
serves Europe.  RIPE NCC runs one of the neatest open projects on the Internet today called&lt;br&gt;
&lt;a href=&#34;https://atlas.ripe.net/&#34;&gt;RIPE ATLAS&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&amp;ldquo;With your help, the RIPE NCC is building the largest &lt;br&gt;
Internet measurement network ever made. RIPE Atlas &lt;br&gt;
employs a global network of probes that measure Internet &lt;br&gt;
connectivity and reachability, providing an unprecedented &lt;br&gt;
understanding of the state of the Internet in real time.&amp;rdquo;&lt;/p&gt;

&lt;p&gt;Imagine we have 8000+ probes scattered around that all &lt;br&gt;
report metrics back to a central place. The data would &lt;br&gt;
allow us to get a holistic view of overall trends, outages, &lt;br&gt;
and performance.  This is precisely RIPE Atlas.&lt;/p&gt;

&lt;p&gt;There are a few ways to get &lt;a href=&#34;https://atlas.ripe.net/get-involved/&#34;&gt;involved&lt;/a&gt; in RIPE Atlas:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Host a &lt;a href=&#34;https://atlas.ripe.net/get-involved/become-a-host//&#34;&gt;probe&lt;/a&gt; (A small hardware device that collects metrics)&lt;/li&gt;
&lt;li&gt;Host an &lt;a href=&#34;https://atlas.ripe.net/get-involved/become-an-anchor-host/&#34;&gt;anchor&lt;/a&gt; (A larger device &lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://atlas.ripe.net/get-involved/become-a-sponsor/&#34;&gt;Sponsor&lt;/a&gt; the effort&lt;/li&gt;
&lt;li&gt;Become an &lt;a href=&#34;https://atlas.ripe.net/get-involved/become-a-ripe-atlas-ambassador/&#34;&gt;Ambassador&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;As you host a probe, an anchor, or sponsor you get //credits//.  Credits are a system to allow&lt;br&gt;
those who contribute to benefit.  Each User-Defined Measurement will cost Credits.&lt;/p&gt;
&lt;h3&gt;Understanding User-Defined Measurements and Credits&lt;/h3&gt;
&lt;p&gt;Atlas allows users of the system to earn Credits by participating.  These credits are in turn&lt;br&gt;
used to purchase custom actions.  If you want to see the result of 10 probes world wide checking&lt;br&gt;
the SSL certificate of your endpoint it will cost 200 Credits.  There are a few controls to keep&lt;br&gt;
any one user from abusing the system: max number of parallel measurements (100),&lt;br&gt;
maximum number of probes per measurement (500), and maximum number of measurements &lt;br&gt;
towards the same target (10).&lt;/p&gt;

&lt;p&gt;If we &lt;a href=&#34;https://atlas.ripe.net/measurements/form/&#34;&gt;create&lt;/a&gt; a measurement in the UI the system will&lt;br&gt;
indicate how many points we have currently and how long the measurement can run at the current interval.&lt;/p&gt;

&lt;p&gt;Examples of use by the day for a measurement every 10 minutes from 50 global probes:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;An IPv4 ICMP ping will use 21,600 credits
An IPv4 ICMP Traceroute will use 144,000 credits
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Results from a UDM can be specified as public (default) or private.  I believe probe existence&lt;br&gt;
in general can be hidden if it is undesirable to have random users running measurements.&lt;/p&gt;
&lt;h3&gt;Anchors&lt;/h3&gt;
&lt;p&gt;My current employer hosts 3 anchors:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://atlas.ripe.net/probes/6092/&#34;&gt;https://atlas.ripe.net/probes/6092/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://atlas.ripe.net/probes/6093/&#34;&gt;https://atlas.ripe.net/probes/6093/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://atlas.ripe.net/probes/6095/&#34;&gt;https://atlas.ripe.net/probes/6095/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Anchors come with some constant measurements that do not cost in credits (one of &lt;br&gt;
the nice advantages of hosting an anchor).  A seismograph for the ICMPv4 Ping &lt;br&gt;
for 6092 can be seen here: &lt;a href=&#34;https://atlas.ripe.net/probes/6095/&#34;&gt;https://atlas.ripe.net/probes/6095/&lt;/a&gt;.  There is also&lt;br&gt;
a constant ICMPv6 Ping, v4 Traceroute, and v6 Traceroute.  Anchors also earn&lt;br&gt;
Credits at a rate higher than probes.&lt;/p&gt;
&lt;h4&gt;Running a UDM&lt;/h4&gt;
&lt;p&gt;If you are hosting a probe now and earning credits you can login and generate&lt;br&gt;
an API key for using the REST interface.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://atlas.ripe.net/keys/&#34;&gt;https://atlas.ripe.net/keys/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Launch a one time TCP traceroute from 5 random world wide hosts to en.wikipedia.org:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
curl --dump-header - -H &#34;Content-Type: application/json&#34; -H &#34;Accept: application/json&#34; -X POST -d {
 &#34;definitions&#34;: [
  {
   &#34;target&#34;: &#34;en.wikipedia.org&#34;,
   &#34;af&#34;: 4,
   &#34;timeout&#34;: 4000,
   &#34;interval&#34;: 900,
   &#34;description&#34;: &#34;Traceroute measurement to en.wikipedia.org&#34;,
   &#34;protocol&#34;: &#34;TCP&#34;,
   &#34;resolve_on_probe&#34;: false,
   &#34;packets&#34;: 3,
   &#34;size&#34;: 48,
   &#34;firsthop&#34;: 1,
   &#34;destination_option_size&#34;: 0,
   &#34;port&#34;: 443,
   &#34;paris&#34;: 16,
   &#34;maxhops&#34;: 32,
   &#34;hop_by_hop_option_size&#34;: 0,
   &#34;dontfrag&#34;: false,
   &#34;type&#34;: &#34;traceroute&#34;
  }
 ],
 &#34;probes&#34;: [
  {
   &#34;tags&#34;: {
    &#34;include&#34;: [],
    &#34;exclude&#34;: []
   },
   &#34;type&#34;: &#34;area&#34;,
   &#34;value&#34;: &#34;WW&#34;,
   &#34;requested&#34;: 5
  }
 ],
 &#34;is_oneoff&#34;: true
} https://atlas.ripe.net/api/v1/measurement/?key=YOUR_KEY_HERE
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The results of this test can be seen in the &lt;a href=&#34;https://atlas.ripe.net/measurements/1945703/&#34;&gt;UI&lt;/a&gt; or&lt;br&gt;
fetched from the CLI:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;curl https:&amp;#47;&amp;#47;atlas.ripe.net&amp;#47;api&amp;#47;v1&amp;#47;measurement&amp;#47;1945703&amp;#47;result&amp;#47;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;hideme&#39;);&#34;&gt;Show Console Traceroute Results&lt;/a&gt;&lt;br&gt;
&lt;div id=&#34;hideme&#34; style=&#34;display:none;&#34;&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&lt;br&gt;
[&lt;br&gt;
    {&lt;br&gt;
        &amp;quot;af&amp;quot;: 4,&lt;br&gt;
        &amp;quot;dst_addr&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;dst_name&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;endtime&amp;quot;: 1428526981,&lt;br&gt;
        &amp;quot;from&amp;quot;: &amp;quot;38.97.90.93&amp;quot;,&lt;br&gt;
        &amp;quot;fw&amp;quot;: 4680,&lt;br&gt;
        &amp;quot;group_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;lts&amp;quot;: 131,&lt;br&gt;
        &amp;quot;msm_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;msm_name&amp;quot;: &amp;quot;Traceroute&amp;quot;,&lt;br&gt;
        &amp;quot;paris_id&amp;quot;: 1,&lt;br&gt;
        &amp;quot;prb_id&amp;quot;: 10488,&lt;br&gt;
        &amp;quot;proto&amp;quot;: &amp;quot;TCP&amp;quot;,&lt;br&gt;
        &amp;quot;result&amp;quot;: [&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 1,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 2,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 3,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 4,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 5,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 255,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 91.818,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 52&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 100.733,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 52&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 91.175,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 52&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            }&lt;br&gt;
        ],&lt;br&gt;
        &amp;quot;size&amp;quot;: 48,&lt;br&gt;
        &amp;quot;src_addr&amp;quot;: &amp;quot;192.168.254.180&amp;quot;,&lt;br&gt;
        &amp;quot;timestamp&amp;quot;: 1428526921,&lt;br&gt;
        &amp;quot;type&amp;quot;: &amp;quot;traceroute&amp;quot;&lt;br&gt;
    },&lt;br&gt;
    {&lt;br&gt;
        &amp;quot;af&amp;quot;: 4,&lt;br&gt;
        &amp;quot;dst_addr&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;dst_name&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;endtime&amp;quot;: 1428526924,&lt;br&gt;
        &amp;quot;from&amp;quot;: &amp;quot;88.167.64.190&amp;quot;,&lt;br&gt;
        &amp;quot;fw&amp;quot;: 4680,&lt;br&gt;
        &amp;quot;group_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;lts&amp;quot;: 90,&lt;br&gt;
        &amp;quot;msm_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;msm_name&amp;quot;: &amp;quot;Traceroute&amp;quot;,&lt;br&gt;
        &amp;quot;paris_id&amp;quot;: 1,&lt;br&gt;
        &amp;quot;prb_id&amp;quot;: 12438,&lt;br&gt;
        &amp;quot;proto&amp;quot;: &amp;quot;TCP&amp;quot;,&lt;br&gt;
        &amp;quot;result&amp;quot;: [&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 1,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.1.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 0.634,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.1.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 0.494,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.1.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 0.475,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 2,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;88.167.64.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 18.663,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;88.167.64.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 17.382,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;88.167.64.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 18.105,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 3,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.33.190&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 18.531,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.33.190&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 19.627,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.33.190&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 19.286,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 4,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.51.113&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 22.306,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.51.113&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 19.809,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.51.113&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 19.336,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 5,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.160.133&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 20.541,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.160.133&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 20.812,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.160.133&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 20.104,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 6,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.249.197&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 22.469,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.249.197&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 21.755,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.249.197&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 21.857,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 7,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.59.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 26.74,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.59.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 29.898,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.59.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 29.885,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 8,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.250.217&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 27.328,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.250.217&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 30.498,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.250.217&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 29.046,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 9,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.30&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 29.912,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 247&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.30&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 29.314,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 247&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.30&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 29.492,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 247&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 10,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.38&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 37.092,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 246&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.38&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 37.719,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 246&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.38&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 37.739,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 246&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 11,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 50.213,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 245&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 38.974,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 245&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 37.763,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 245&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 12,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 38.009,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 53&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 37.662,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 53&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 37.743,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 53&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            }&lt;br&gt;
        ],&lt;br&gt;
        &amp;quot;size&amp;quot;: 48,&lt;br&gt;
        &amp;quot;src_addr&amp;quot;: &amp;quot;192.168.1.10&amp;quot;,&lt;br&gt;
        &amp;quot;timestamp&amp;quot;: 1428526922,&lt;br&gt;
        &amp;quot;type&amp;quot;: &amp;quot;traceroute&amp;quot;&lt;br&gt;
    },&lt;br&gt;
    {&lt;br&gt;
        &amp;quot;af&amp;quot;: 4,&lt;br&gt;
        &amp;quot;dst_addr&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;dst_name&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;endtime&amp;quot;: 1428526922,&lt;br&gt;
        &amp;quot;from&amp;quot;: &amp;quot;82.227.109.71&amp;quot;,&lt;br&gt;
        &amp;quot;fw&amp;quot;: 4680,&lt;br&gt;
        &amp;quot;group_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;lts&amp;quot;: 192,&lt;br&gt;
        &amp;quot;msm_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;msm_name&amp;quot;: &amp;quot;Traceroute&amp;quot;,&lt;br&gt;
        &amp;quot;paris_id&amp;quot;: 1,&lt;br&gt;
        &amp;quot;prb_id&amp;quot;: 17039,&lt;br&gt;
        &amp;quot;proto&amp;quot;: &amp;quot;TCP&amp;quot;,&lt;br&gt;
        &amp;quot;result&amp;quot;: [&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 1,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.0.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 1.089,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.0.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 0.923,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.0.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 0.824,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 2,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;82.227.109.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 39.822,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;82.227.109.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 38.573,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;82.227.109.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 39.478,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 3,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.8.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 39.041,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.8.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 39.493,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.8.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 40.031,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 4,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.9&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 42.75,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.9&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 45.663,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.9&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 45.935,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 5,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.114&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 39.734,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.114&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 47.683,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.114&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 40.024,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 6,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.238&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 48.961,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.238&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 45.305,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;194.149.161.238&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 46.711,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 7,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 54.716,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 53.405,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 55.026,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 8,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 55.611,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 55.197,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 54.512,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 9,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 54.765,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 56&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 55.599,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 56&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 54.781,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 56&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            }&lt;br&gt;
        ],&lt;br&gt;
        &amp;quot;size&amp;quot;: 48,&lt;br&gt;
        &amp;quot;src_addr&amp;quot;: &amp;quot;192.168.0.14&amp;quot;,&lt;br&gt;
        &amp;quot;timestamp&amp;quot;: 1428526920,&lt;br&gt;
        &amp;quot;type&amp;quot;: &amp;quot;traceroute&amp;quot;&lt;br&gt;
    },&lt;br&gt;
    {&lt;br&gt;
        &amp;quot;af&amp;quot;: 4,&lt;br&gt;
        &amp;quot;dst_addr&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;dst_name&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;endtime&amp;quot;: 1428526921,&lt;br&gt;
        &amp;quot;from&amp;quot;: &amp;quot;82.246.14.179&amp;quot;,&lt;br&gt;
        &amp;quot;fw&amp;quot;: 4680,&lt;br&gt;
        &amp;quot;group_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;lts&amp;quot;: 56,&lt;br&gt;
        &amp;quot;msm_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;msm_name&amp;quot;: &amp;quot;Traceroute&amp;quot;,&lt;br&gt;
        &amp;quot;paris_id&amp;quot;: 1,&lt;br&gt;
        &amp;quot;prb_id&amp;quot;: 17174,&lt;br&gt;
        &amp;quot;proto&amp;quot;: &amp;quot;TCP&amp;quot;,&lt;br&gt;
        &amp;quot;result&amp;quot;: [&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 1,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.0.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 0.63,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.0.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 0.472,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;192.168.0.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 0.477,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 64&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 2,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;82.246.14.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 6.526,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;82.246.14.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 5.47,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;82.246.14.254&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 5.253,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 88,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 63&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 3,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.26.190&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 5.481,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.26.190&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 5.331,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;213.228.26.190&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 7.4,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 253&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 4,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.50.209&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 9.41,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.50.209&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 9.985,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.50.209&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 9.51,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 252&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 5,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.59.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 13.742,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.59.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 13.712,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.59.42&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 17.792,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 251&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 6,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.250.217&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 14.821,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.250.217&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 13.654,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;78.254.250.217&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 13.857,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 250&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 7,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.30&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 208.262,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.30&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 106.709,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.30&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 42.256,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 249&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 8,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.38&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 26.323,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.38&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 24.66,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;212.27.56.38&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 26.256,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 68,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 248&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 9,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 25.272,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 247&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 25.727,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 247&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;80.249.209.176&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 25.049,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 247&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 10,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 25.339,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 55&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 28.423,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 55&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;flags&amp;quot;: &amp;quot;SA&amp;quot;,&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 25.608,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 4,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 55&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            }&lt;br&gt;
        ],&lt;br&gt;
        &amp;quot;size&amp;quot;: 48,&lt;br&gt;
        &amp;quot;src_addr&amp;quot;: &amp;quot;192.168.0.25&amp;quot;,&lt;br&gt;
        &amp;quot;timestamp&amp;quot;: 1428526920,&lt;br&gt;
        &amp;quot;type&amp;quot;: &amp;quot;traceroute&amp;quot;&lt;br&gt;
    },&lt;br&gt;
    {&lt;br&gt;
        &amp;quot;af&amp;quot;: 4,&lt;br&gt;
        &amp;quot;dst_addr&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;dst_name&amp;quot;: &amp;quot;91.198.174.192&amp;quot;,&lt;br&gt;
        &amp;quot;endtime&amp;quot;: 1428527000,&lt;br&gt;
        &amp;quot;from&amp;quot;: &amp;quot;94.125.83.239&amp;quot;,&lt;br&gt;
        &amp;quot;fw&amp;quot;: 4680,&lt;br&gt;
        &amp;quot;group_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;lts&amp;quot;: 171,&lt;br&gt;
        &amp;quot;msm_id&amp;quot;: 1945703,&lt;br&gt;
        &amp;quot;msm_name&amp;quot;: &amp;quot;Traceroute&amp;quot;,&lt;br&gt;
        &amp;quot;paris_id&amp;quot;: 1,&lt;br&gt;
        &amp;quot;prb_id&amp;quot;: 20002,&lt;br&gt;
        &amp;quot;proto&amp;quot;: &amp;quot;TCP&amp;quot;,&lt;br&gt;
        &amp;quot;result&amp;quot;: [&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 1,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;from&amp;quot;: &amp;quot;10.81.8.2&amp;quot;,&lt;br&gt;
                        &amp;quot;rtt&amp;quot;: 1.256,&lt;br&gt;
                        &amp;quot;size&amp;quot;: 28,&lt;br&gt;
                        &amp;quot;ttl&amp;quot;: 254&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 2,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 3,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 4,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 5,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 6,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            },&lt;br&gt;
            {&lt;br&gt;
                &amp;quot;hop&amp;quot;: 255,&lt;br&gt;
                &amp;quot;result&amp;quot;: [&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;&lt;/em&gt;&amp;quot;&lt;br&gt;
                    },&lt;br&gt;
                    {&lt;br&gt;
                        &amp;quot;x&amp;quot;: &amp;quot;*&amp;quot;&lt;br&gt;
                    }&lt;br&gt;
                ]&lt;br&gt;
            }&lt;br&gt;
        ],&lt;br&gt;
        &amp;quot;size&amp;quot;: 48,&lt;br&gt;
        &amp;quot;src_addr&amp;quot;: &amp;quot;10.81.8.30&amp;quot;,&lt;br&gt;
        &amp;quot;timestamp&amp;quot;: 1428526920,&lt;br&gt;
        &amp;quot;type&amp;quot;: &amp;quot;traceroute&amp;quot;&lt;br&gt;
    }&lt;br&gt;
]&lt;br&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;br&gt;
&lt;/div&gt;&lt;/p&gt;
&lt;h3&gt;Reference&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://www-static.ripe.net/static/rnd-ui/atlas/media/apply/RIPE_Atlas_flyer_2014.pdf&#34;&gt;flyer&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/RIPE-NCC/ripe.atlas.sagan&#34;&gt;sagan&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/RIPE-NCC/ripe-atlas-cousteau&#34;&gt;cousteau&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://atlas.ripe.net/docs/rest/#measurement&#34;&gt;REST measurements&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>internet culture</title>
                <link rel="alternate" href="/2015/04/08/internet-culture/" type="text/html" />
                <id>/2015/04/08/internet-culture/</id>
                <updated>2015-04-08T03:05:00Z</updated>
                
                <summary type="html">Getting help and soliciting feedback on the Internet essential reading:</summary>
                <content type="html">&lt;p&gt;Getting help and soliciting feedback on the Internet essential reading:&lt;/p&gt;

&lt;p&gt;Great presentation directed at tech folks from India primarily looking&lt;br&gt;
to enter into an Open Source mentor relationship&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.shakthimaan.com/downloads/glv/presentations/i-want-2-do-project-tell-me-wat-2-do.pdf&#34;&gt;I want 2 do project tell me how&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Phabricator great page pleading for users to provide the actual error.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://secure.phabricator.com/book/phabflavor/article/please_please_please/&#34;&gt;please please please&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The essential text from ESR&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.catb.org/%7Eesr/faqs/smart-questions.html&#34;&gt;How to ask smart questions&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>linux permissions</title>
                <link rel="alternate" href="/2015/03/24/linux-permissions/" type="text/html" />
                <id>/2015/03/24/linux-permissions/</id>
                <updated>2015-03-24T23:13:00Z</updated>
                
                <summary type="html">&lt;strong&gt;This Post is A Work in Progress&lt;/strong&gt;</summary>
                <content type="html">&lt;p&gt;&lt;strong&gt;This Post is A Work in Progress&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;There are a ton of linux permissions references around but I have referenced a new&lt;br&gt;
nuances lately and it has prompted me to write my own :)  Both as a way to dig into&lt;br&gt;
a fun topic and as somewhere to point people with questions I trust.  Best beginning&lt;br&gt;
overview &lt;a href=&#34;https://en.wikipedia.org/wiki/File_system_permissions&#34;&gt;https://en.wikipedia.org/wiki/File_system_permissions&lt;/a&gt; but I have noticed&lt;br&gt;
that what happens is a user comes across an aspect of permissions they have never seen.&lt;br&gt;&lt;br&gt;
Suddenly they question everything they know, or maybe that&amp;#39;s just me.&lt;/p&gt;

&lt;p&gt;Tools:&lt;/p&gt;

&lt;p&gt;chmod&lt;br&gt;
chown&lt;/p&gt;
&lt;h3&gt;Chmod&lt;/h3&gt;
&lt;p&gt;We want to change what abilities for the existing categories of:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;owner&lt;/li&gt;
&lt;li&gt;group&lt;/li&gt;
&lt;li&gt;everyone&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;The same settings have different meanings in the case of files and folders.&lt;/p&gt;
&lt;h3&gt;Chown&lt;/h3&gt;
&lt;p&gt;We want to change who the owner and/or group refers too.&lt;/p&gt;
&lt;h3&gt;visudo&lt;/h3&gt;
&lt;p&gt;We want to change what escalated permissions a user can access safely.&lt;/p&gt;

&lt;p&gt;root    ALL=(ALL) ALL&lt;/p&gt;
&lt;h3&gt;su&lt;/h3&gt;
&lt;p&gt;Becoming or executing commands as another user&lt;/p&gt;
&lt;h3&gt;chattr (i.e. can root protect a file so well even they can&amp;#39;t remove it?)&lt;/h3&gt;
&lt;p&gt;Change attributes on a file (usually to set an immutable bit)&lt;/p&gt;

&lt;p&gt;chattr +i filename.ext or remove chattr -i filename.ext&lt;/p&gt;
&lt;h3&gt;setcap&lt;/h3&gt;
&lt;p&gt;Setting capabilities&lt;/p&gt;
&lt;h3&gt;setuid&lt;/h3&gt;
&lt;p&gt;Setting a uid for a particular file&lt;/p&gt;
&lt;h3&gt;setgid&lt;/h3&gt;
&lt;p&gt;Setting the gid for a particular file&lt;/p&gt;
&lt;h3&gt;concepts&lt;/h3&gt;
&lt;p&gt;CAP_DAC_OVERRIDE &amp;ndash; capability root has to &amp;ldquo;ignore&amp;rdquo; permissions&lt;/p&gt;
&lt;h3&gt;Reference&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Chmod&#34;&gt;chmod&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://en.wikipedia.org/wiki/Chown&#34;&gt;chown&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.linuxnix.com/2012/01/sticky-bit-set-linux.html&#34;&gt;sticky bit&lt;/a&gt; &lt;br&gt;
&lt;a href=&#34;http://ss64.com/bash/sudo.html&#34;&gt;man sudo&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://help.ubuntu.com/community/Sudoers&#34;&gt;sudoers&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://linux.die.net/man/7/capabilities&#34;&gt;Capabilities&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.symantec.com/connect/articles/introduction-linux-capabilities-and-acls&#34;&gt;Capabilities 2&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://blog.siphos.be/2013/05/overview-of-linux-capabilities-part-1/&#34;&gt;Capabilities 3&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://unix.stackexchange.com/questions/128394/passing-capabilities-through-exec&#34;&gt;so passing capabilities&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://unix.stackexchange.com/questions/51874/root-owned-program-with-setuid-bit-on&#34;&gt;ping setuid&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://en.wikipedia.org/wiki/Setuid&#34;&gt;setuid&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://en.wikipedia.org/wiki/Group_identifier&#34;&gt;groups&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://unix.stackexchange.com/questions/21251/why-do-directories-need-the-executable-x-permission-to-be-opened&#34;&gt;so directory perms&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://en.wikipedia.org/wiki/Inode&#34;&gt;inode&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>dyn bakers dozen</title>
                <link rel="alternate" href="/2015/02/04/dyn-bakers-dozen/" type="text/html" />
                <id>/2015/02/04/dyn-bakers-dozen/</id>
                <updated>2015-02-04T23:04:00Z</updated>
                
                <summary type="html">&lt;a href=&#34;http://research.dyn.com/2015/02/bakers-dozen-2014-edition/&#34;&gt;http://research.dyn.com/2015/02/bakers-dozen-2014-edition/&lt;/a&gt;</summary>
                <content type="html">&lt;p&gt;&lt;a href=&#34;http://research.dyn.com/2015/02/bakers-dozen-2014-edition/&#34;&gt;http://research.dyn.com/2015/02/bakers-dozen-2014-edition/&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>Huge TCP TIME_WAIT count</title>
                <link rel="alternate" href="/2014/12/24/Huge-TCP-TIME_WAIT-count/" type="text/html" />
                <id>/2014/12/24/Huge-TCP-TIME_WAIT-count/</id>
                <updated>2014-12-24T19:58:00Z</updated>
                
                <summary type="html">Recently I was running a job that parses a large backlog of items and updates&lt;br&gt;
MySQL based on their outcome.  The items were being updated via API by a&lt;br&gt;
webservice on the same host.  I was restricted to processing 10 jobs in parallel or&lt;br&gt;
I would get connection errors and random connection issues.  The webservice returned&lt;br&gt;
a generic failure but my own code returned OS code 99.</summary>
                <content type="html">&lt;p&gt;Recently I was running a job that parses a large backlog of items and updates&lt;br&gt;
MySQL based on their outcome.  The items were being updated via API by a&lt;br&gt;
webservice on the same host.  I was restricted to processing 10 jobs in parallel or&lt;br&gt;
I would get connection errors and random connection issues.  The webservice returned&lt;br&gt;
a generic failure but my own code returned OS code 99.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;OS error code  99:  Cannot assign requested address
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I was regularly tracking TIME_WAIT connections into the thousands.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;netstat -anp | grep WAIT | wc -l
2034
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It turns out that client side I was exhausting my available port range for new connections.&lt;br&gt;
After a bit of reading I decided on changing the following system control parameters:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo 30 &amp;gt; &amp;#47;proc&amp;#47;sys&amp;#47;net&amp;#47;ipv4&amp;#47;tcp_fin_timeout
echo 1 &amp;gt; &amp;#47;proc&amp;#47;sys&amp;#47;net&amp;#47;ipv4&amp;#47;tcp_tw_recycle
echo 15000 65000 &amp;gt; &amp;#47;proc&amp;#47;sys&amp;#47;net&amp;#47;ipv4&amp;#47;ip_local_port_range
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Shout out to the best DBA I know Springle for the insights and help in debugging MySQL.&lt;/p&gt;
&lt;h4&gt;References&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://serverfault.com/questions/212093/how-to-reduce-number-of-sockets-in-time-wait&#34;&gt;Serverfault&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;lxr.linux.no/#linux+v3.2.8/Documentation/networking/ip-sysctl.txt#L464&#34;&gt;ip-sysctl.txt&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.speedguide.net/articles/linux-tweaking-121&#34;&gt;Speedguide&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>Phabricator conduit testing via CLI</title>
                <link rel="alternate" href="/2014/12/24/Phabricator-conduit-testing-via-CLI/" type="text/html" />
                <id>/2014/12/24/Phabricator-conduit-testing-via-CLI/</id>
                <updated>2014-12-24T19:58:00Z</updated>
                
                <summary type="html">Search for a user by username:</summary>
                <content type="html">&lt;p&gt;Search for a user by username:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;#39;{&amp;quot;usernames&amp;quot;: [&amp;quot;admin&amp;quot;]}&amp;#39; | \
&amp;#47;srv&amp;#47;phab&amp;#47;arcanist&amp;#47;bin&amp;#47;arc call-conduit user.query
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Get task information by id:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;#39;{&amp;quot;task_id&amp;quot;: &amp;quot;9&amp;quot;}&amp;#39; | \
&amp;#47;srv&amp;#47;phab&amp;#47;arcanist&amp;#47;bin&amp;#47;arc call-conduit maniphest.info
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Add comments to a task:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;#39;{&amp;quot;id&amp;quot;: &amp;quot;9&amp;quot;, &amp;quot;comments&amp;quot;: &amp;quot;this is comment1&amp;quot;}&amp;#39; | \
&amp;#47;srv&amp;#47;phab&amp;#47;arcanist&amp;#47;bin&amp;#47;arc call-conduit maniphest.update
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create a task:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;foo 123&amp;quot;}&amp;#39; | \
&amp;#47;srv&amp;#47;phab&amp;#47;arcanist&amp;#47;bin&amp;#47;arc call-conduit maniphest.createtask
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Create a task while supplying a &lt;a href=&#34;https://secure.phabricator.com/book/phabricator/article/custom_fields/&#34;&gt;custom field value&lt;/a&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;#39;{&amp;quot;title&amp;quot;:&amp;quot;foo 234&amp;quot;, &amp;quot;auxiliary&amp;quot;:{&amp;quot;std:maniphest:external_id&amp;quot;:&amp;quot;789&amp;quot;}}&amp;#39; | \
&amp;#47;srv&amp;#47;phab&amp;#47;arcanist&amp;#47;bin&amp;#47;arc call-conduit maniphest.createtask
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you want more debugging information on any call you can add &amp;ndash;trace.&lt;/p&gt;
&lt;h4&gt;References&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://secure.phabricator.com/book/phabricator/article/custom_fields/&#34;&gt;Phab custom fields&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://secure.phabricator.com/book/phabdev/article/conduit/&#34;&gt;Phab conduit&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>Testing email</title>
                <link rel="alternate" href="/2014/12/24/Testing-email/" type="text/html" />
                <id>/2014/12/24/Testing-email/</id>
                <updated>2014-12-24T19:58:00Z</updated>
                
                <summary type="html">I&amp;#39;ve always tested email via Telnet, and have even sat in on interviews where&lt;br&gt;
how to test email this way was one of the debugging problems.  Recently though&lt;br&gt;
I have come to use Swaks as a slicker alternative.</summary>
                <content type="html">&lt;p&gt;I&amp;#39;ve always tested email via Telnet, and have even sat in on interviews where&lt;br&gt;
how to test email this way was one of the debugging problems.  Recently though&lt;br&gt;
I have come to use Swaks as a slicker alternative.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aptitude install swaks

 swaks --to task@example.com \
 --from me@example.com \
 --h-Subject: &amp;#39;my email&amp;#39; \
 --server localhost
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;References&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.jetmore.org/john/code/swaks/&#34;&gt;Swaks&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://exchange.mvps.org/smtp_frames.htm&#34;&gt;SMTP Frames&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>Getting Phabricator Conduit end points</title>
                <link rel="alternate" href="/2014/12/24/Getting-Phabricator-Conduit-end-points/" type="text/html" />
                <id>/2014/12/24/Getting-Phabricator-Conduit-end-points/</id>
                <updated>2014-12-24T19:57:00Z</updated>
                
                <summary type="html">Recently I&amp;#39;ve been spending a lot of time with Phabricator, and I often reference&lt;br&gt;
the API specs.  This is a command that has been useful.</summary>
                <content type="html">&lt;p&gt;Recently I&amp;#39;ve been spending a lot of time with Phabricator, and I often reference&lt;br&gt;
the API specs.  This is a command that has been useful.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo {} | arc call-conduit conduit.query | python -m json.tool | less
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;References:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://phabricator.org&#34;&gt;Phabricator&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>osx clang compiler unknown option</title>
                <link rel="alternate" href="/2014/03/18/osx-clang-compiler-unknown-option/" type="text/html" />
                <id>/2014/03/18/osx-clang-compiler-unknown-option/</id>
                <updated>2014-03-18T22:25:00Z</updated>
                
                <summary type="html">As of OSX Xcode tools &amp;lt;=5.1 the clang compiler treats any unknown flag as an error.&lt;br&gt;
This can cause some issues with existing tools that have old flags, or uncommon flags,&lt;br&gt;
or who knows what.</summary>
                <content type="html">&lt;p&gt;As of OSX Xcode tools &amp;lt;=5.1 the clang compiler treats any unknown flag as an error.&lt;br&gt;
This can cause some issues with existing tools that have old flags, or uncommon flags,&lt;br&gt;
or who knows what.&lt;/p&gt;

&lt;p&gt;You see something like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;clang: error: unknown argument: &amp;#39;-mno-fused-madd&amp;#39; [-Wunused-command-line-argument-hard-error-in-future]
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I see this when doing:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#on maverick
pip install mynt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It is an easy fix for now to ignore this for an oneoff:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ARCHFLAGS=-Wno-error=unused-command-line-argument-hard-error-in-future pip install mynt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I have read you can also ditch the OSX native python and install it from brew and things work out.&lt;/p&gt;
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://stackoverflow.com/questions/22313407/clang-error-unknown-argument-mno-fused-madd-python-package-installation-fa&#34;&gt;so&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://clang.llvm.org/docs/UsersManual.html&#34;&gt;compiler docs&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/rmagick/rmagick/issues/96&#34;&gt;ruby guys are seeing it too&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>python monitoring with diamond statsd graphite</title>
                <link rel="alternate" href="/2014/02/27/python-monitoring-with-diamond-statsd-graphite/" type="text/html" />
                <id>/2014/02/27/python-monitoring-with-diamond-statsd-graphite/</id>
                <updated>2014-02-27T19:01:00Z</updated>
                
                <summary type="html">If you stayed late at the DevOpsKC meetup last night you have may have caught me giving this talk about getting a monitoring system going using python from end-to-end.  The meet was at offices of &lt;a href=&#34;http://www.codero.com/&#34;&gt;codero&lt;/a&gt; who were gracious hosts, and the food was provided by Cerner.  Thanks again to the folks put this stuff together.  </summary>
                <content type="html">&lt;p&gt;If you stayed late at the DevOpsKC meetup last night you have may have caught me giving this talk about getting a monitoring system going using python from end-to-end.  The meet was at offices of &lt;a href=&#34;http://www.codero.com/&#34;&gt;codero&lt;/a&gt; who were gracious hosts, and the food was provided by Cerner.  Thanks again to the folks put this stuff together.  &lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;iframe src=&#34;http://www.slideshare.net/slideshow/embed_code/31729631&#34; width=&#34;476&#34; height=&#34;400&#34; frameborder=&#34;0&#34; marginwidth=&#34;0&#34; marginheight=&#34;0&#34; scrolling=&#34;no&#34;&gt;&lt;/iframe&gt;&lt;/center&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;/assets/slides/python_and_trending_data_ops.pdf&#34;&gt;slides pdf&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.meetup.com/DevOps-Kansas-City/&#34;&gt;devops kc&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>screen shots I have saved</title>
                <link rel="alternate" href="/2014/02/25/screen-shots/" type="text/html" />
                <id>/2014/02/25/screen-shots/</id>
                <updated>2014-02-25T18:57:00Z</updated>
                
                <summary type="html">Gotta love the Python community.</summary>
                <content type="html">&lt;p&gt;Gotta love the Python community.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;/assets/images/ha/feb_25_2014/hapython.png&#34; alt=&#34;py&#34; title=&#34;py&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;I&amp;#39;m not math genius but this seems wrong.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;/assets/images/ha/feb_25_2014/haqualys.png&#34; alt=&#34;q&#34; title=&#34;q&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;Everyone has one of these days.  &amp;#39;G&amp;#39; is a friend of mine.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;/assets/images/ha/feb_25_2014/hagrif.png&#34; alt=&#34;grif&#34; title=&#34;grif&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;Seems legit.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;/assets/images/ha/feb_25_2014/hajs.png&#34; alt=&#34;js&#34; title=&#34;js&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;I just like the formality of it.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;/assets/images/ha/feb_25_2014/haerror.png&#34; alt=&#34;error&#34; title=&#34;error&#34;&gt;&lt;/center&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>cisco ssl vpn from cli</title>
                <link rel="alternate" href="/2014/01/27/cisco-ssl-vpn-from-cli/" type="text/html" />
                <id>/2014/01/27/cisco-ssl-vpn-from-cli/</id>
                <updated>2014-01-27T22:25:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Using a Cisco SSL VPN without a GUI.&lt;/p&gt;
&lt;h4&gt;Install packages&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install openconnect links vpnc-scripts
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
/.
/usr
/usr/bin
/usr/bin/openconnect
/usr/share
/usr/share/doc
/usr/share/doc/openconnect
/usr/share/doc/openconnect/AUTHORS
/usr/share/doc/openconnect/copyright
/usr/share/doc/openconnect/changelog.Debian.gz
/usr/share/doc/openconnect/TODO
/usr/lib
/usr/lib/NetworkManager
/usr/lib/NetworkManager/nm-openconnect-auth-dialog
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Get your certificate&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;links https:&amp;#47;&amp;#47;yourdomain&amp;#47;+CSCOCA+&amp;#47;login.html
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;looks like&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Cisco Logo ASA - Local Certificate Authority                                           
                                                                                         
  ASA - Local Certificate Authority                                                      
                                                                                         
  Username          _____________________                                                
  One-time Password _____________________                                                
  [ Submit ]   [ Reset ]                                                                 
  NOTE: On successful authentication:                                                    
    * Open or Save the generated                                                         
      certificate                                                                        
    * Install the certificate in the                                                     
      browser store                                                                      
    * Close all the browser windows, and                                                 
    * Restart the SSL VPN connection                                                     
   (c)Cisco Systems, Inc. All rights reserved
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Fill in the fields and [Submit].  Your cert will download.&lt;/p&gt;
&lt;h4&gt;Connect to your VPN endpoint&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
#Try to connect
openconnect -c $certificate -b\
            --key-password=$keypass  \
            -u $vpnuser $vpnendpoint
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;looks like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Shutting down openconnect vpn tunnel.
openconnect: no process found
Attempting to connect to 199.15.160.254:443
SSL negotiation with ra.deviantart.net
Connected to HTTPS on ra.deviantart.net
GET https://ra.deviantart.net/
Got HTTP response: HTTP/1.0 302 Object Moved
SSL negotiation with ra.deviantart.net
Connected to HTTPS on ra.deviantart.net
GET https://ra.deviantart.net/+webvpn+/index.html
Please enter your username and password.
Password: --your pass here ;) --
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Using your connection&lt;/h4&gt;
&lt;p&gt;You should see your tunnel interface if you run:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ifconfig | grep tun0 | awk &amp;#39;{print $1}&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Add routing for your remote network&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;route add -net 192.168.0.0 netmask 255.255.0.0 dev tun0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now you should be able to hit an IP across the tunnel.&lt;/p&gt;
&lt;h4&gt;Notes&lt;/h4&gt;
&lt;p&gt;You can install and use the vpnc-script to manage DNS and things smartly.  You can use the &amp;ndash;script flag:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;--script &amp;#47;usr&amp;#47;share&amp;#47;vpnc-scripts&amp;#47;vpnc-script
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Your certificate passphrase is probably the OTP you used&lt;/p&gt;

&lt;p&gt;If you make a script for managing connections you may need to clear out stale ones at the top&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;    killall openconnect
    iptables -F
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.infradead.org/openconnect/&#34;&gt;openconnect&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>pfx from crt and key and into your ASA</title>
                <link rel="alternate" href="/2014/01/21/pfx-from-crt-and-key/" type="text/html" />
                <id>/2014/01/21/pfx-from-crt-and-key/</id>
                <updated>2014-01-21T22:28:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Some devices that use certificates require them to be uploaded in pfx format.&lt;/p&gt;

&lt;p&gt;What is pfx?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
    In cryptography, PKCS #12 defines an archive file format \
    for storing many cryptography objects as a single file. \
    It is commonly used to bundle a private key with its X.509 \
    certificate or to bundle all the members of a chain of trust. \
    A PKCS #12 file may be encrypted and signed.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Typically, when you generate an SSL certificate you get a mine.key file and a mine.crt file&lt;/p&gt;

&lt;p&gt;PFX format is used by Cisco ASA devices&lt;/p&gt;
&lt;h4&gt;Installing OpenSSL&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install openssl
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Make sure your .key file is valid&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;openssl x509 -text -in myfile.key
&lt;/code&gt;&lt;/pre&gt;&lt;h5&gt;Making a PFX file&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;
openssl pkcs12 \                 
        -export \                #We are exporting!
        -out myfile.pfx \        #Your intended .pfx
        -inkey myfile.key \      #Your file.key
        -in myfile.crt \         #Your file.crt
        -certfile digicertca.crt #Your CA certificate
&lt;/code&gt;&lt;/pre&gt;
&lt;h5&gt;Adding your .pfx to your ASA&lt;/h5&gt;
&lt;p&gt;I am using ASDM for this as it&amp;#39;s far easier.  This is one of the few things I think the GUI has right.  My device management.&lt;/p&gt;

&lt;p&gt;Manage your identitfy certs&lt;br&gt;
&lt;img src=&#34;/assets/images/pfx/my-device-cert-management.png&#34; alt=&#34;cert1&#34; title=&#34;cert1&#34;&gt;&lt;/p&gt;

&lt;p&gt;Add a new one&lt;br&gt;
&lt;img src=&#34;/assets/images/pfx/my-device-add-cert.png&#34; alt=&#34;cert2&#34; title=&#34;cert2&#34;&gt;&lt;/p&gt;

&lt;p&gt;Browse to your pfx (note: the pfx must have a passphrase)&lt;br&gt;
&lt;img src=&#34;/assets/images/pfx/my-device-cert-upload.png&#34; alt=&#34;cert3&#34; title=&#34;cert3&#34;&gt;&lt;/p&gt;

&lt;p&gt;Now go to the SSL Settings section&lt;br&gt;
&lt;img src=&#34;/assets/images/pfx/my-device-cert-to-int.png&#34; alt=&#34;cert4&#34; title=&#34;cert4&#34;&gt;&lt;/p&gt;

&lt;p&gt;Select and interface and edit.  Choose your new pfx.&lt;br&gt;
&lt;img src=&#34;/assets/images/pfx/my-device-interface-pick.png&#34; alt=&#34;cert5&#34; title=&#34;cert5&#34;&gt;&lt;/p&gt;
&lt;h4&gt;Notes&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cisco.com/en/US/products/ps6120/&#34;&gt;Cisco ASA&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://en.wikipedia.org/wiki/PKCS_12&#34;&gt;PFX&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.openssl.org/&#34;&gt;OpenSSL&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>gahh...tmpreaper</title>
                <link rel="alternate" href="/2014/01/17/gahh...tmpreaper/" type="text/html" />
                <id>/2014/01/17/gahh...tmpreaper/</id>
                <updated>2014-01-17T17:57:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I am seeing the same issue as this &lt;a href=&#34;https://lists.debian.org/debian-user/2005/06/msg00799.html&#34;&gt;gentlemen&lt;/a&gt; when trying to use &lt;a href=&#34;http://manpages.ubuntu.com/manpages/hardy/man8/tmpreaper.8.html&#34;&gt;tmpreaper&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If you use the &amp;ndash;test switch you can see the internals of how tmpreaper recognizes files and it is without the container directory context so it doesn&amp;#39;t read &amp;#39;/hi/hello&amp;#39; with &amp;#39;/hi*&amp;#39; if you use &amp;ndash;protect.  It only sees the hello file individually.  This is not the behavior I need at the moment.  I do not know the name of each file I need to protect.  Some things like passenger use (and maybe abuse) &amp;#39;/tmp&amp;#39; extensively.&lt;/p&gt;

&lt;p&gt;Example of files passenger can land in /tmp:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
/tmp/passenger.1.0/
`-- generation-1
    |-- backends
    |   |-- ruby.3X77Nbh9Ie2tsn7AcReQJh9Aq9gqSK3MF0afBS5qYgJDNxcTMblyrxW
    |-- buffered_uploads
    |-- config_files.txt
    |-- helper_server.pid
    |-- logging.socket
    |-- passenger-status-password.txt
    |-- socket
    |-- structure_version.txt
    `-- web_server.txt
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Using &amp;#39;find&amp;#39;&lt;/h4&gt;
&lt;p&gt;The goal is to remove files and directories left in &amp;#39;/tmp&amp;#39; and not touched within the last hour.  Cleaning &amp;#39;/tmp&amp;#39; is one of those problems that is so common there are solutions all over the Internet.  This seems to be a version of the sanest approach.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#path to find files in /tmp (uses shell globbing) and have the full path
#files only and not modified in last hour (-60 would find only files that were modified)
/usr/bin/find /tmp/* -mmin +60 -type f | \
    #breaking args on newlines to account for spaces in file names
    #-r for xargs does not attempt to run the following command
    #if the array is empty
    xargs -d &#39;\n&#39; -r rm -v
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The whole idea is to be able to protect (as in not remove) a file by path in a sane way.&lt;/p&gt;

&lt;p&gt;If I exclude &amp;#39;/tmp/yo&amp;#39; I want the option to match &amp;#39;/tmp/yo/foo&amp;#39; and &amp;#39;/tmp/yo/bar&amp;#39;.  This kind of flexibility implies regex. &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
/usr/bin/find /tmp/* -mmin +60 -type f | \
    #Regex for exclusions \
    grep -v -E ^/tmp/yo | \
    xargs -d &#39;\n&#39; -r rm -v
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;I can also use lines in a file to group.&lt;/p&gt;

&lt;p&gt;mystuff.exclusions&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
    ^/tmp/yo
    ^/tmp/passenger
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Find command reading in regex cleanup exclusions from a file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
/usr/bin/find /tmp/* -mmin +60 -type f | \
    #read in from a file natively
    grep -v -E -f mystuff.exclusions | \
    xargs -d &#39;\n&#39; -r rm -v
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Getting those left over directories&lt;/h4&gt;
&lt;p&gt;Now remove the remaining empty directories.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#once again using globbing to get full file paths
#dirs not updated in 60 minutes and empty
#we are also using rmdir which will not remove a dir that isn&#39;t empty
#by the time we get to it.  Removing a nasty race condition if you use
#&#39;rm -R&#39;.  &#39;--ignore-fail-on-non-empty&#39; swallows the error that occurs in
#that situation.
/usr/bin/find /tmp/*  -mmin +60 -type d -empty | \
    xargs -d &#39;\n&#39; -r rmdir --ignore-fail-on-non-empty
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Final Version&lt;/h4&gt;
&lt;p&gt;My exclusions file with one regex per line:&lt;/p&gt;

&lt;p&gt;mystuff.exclusions&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&lt;br&gt;
    ^/tmp/yo&lt;br&gt;
    ^/tmp/passenger&lt;br&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#!/bin/bash
#file cleanup
#I am using head to keep the limit of files artificially down that we 
#try to remove.  However, xargs should do the &#39;right thing&#39; if given large lists.
/usr/bin/find /tmp/* -mmin +60 -type f | \
    grep -v -E -f mystuff.exclusions | \
    head -n 1000 | \
    xargs -d &#39;\n&#39; -r rm -v

#dir cleanup
/usr/bin/find /tmp/* -mmin +60 -type d -empty | \
    xargs -d &#39;\n&#39; -r rmdir --ignore-fail-on-non-empty
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Place in file and run this hourly:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;0 * * * * &amp;#47;usr&amp;#47;local&amp;#47;bin&amp;#47;myscript.sh &amp;gt;&amp;#47;dev&amp;#47;null 2&amp;gt;&amp;amp;1
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;
&lt;p&gt;Much as been said about the harm of xargs.  I tried this originally using the -print0 option in find, and the -0 option for xargs to appropriately handle files with space in them.  I wasn&amp;#39;t able to wrangle that in a way that made sense with my exclusion logic.  I really wanted to read in my list of exclusions from a file for use-case specific reasons.  With xargs it seems, don&amp;#39;t use it until you need to use it is the best advice.&lt;/p&gt;

&lt;p&gt;There is a &lt;a href=&#34;https://code.google.com/p/phusion-passenger/issues/detail?id=365&#34;&gt;way&lt;/a&gt; to tell Passenger not to use /tmp.  It would probably be a good idea no matter what.&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://www.phusionpassenger.com/&#34;&gt;passenger&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://manpages.ubuntu.com/manpages/hardy/man8/tmpreaper.8.html&#34;&gt;tmpreaper&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>google oauth2 reverse proxy</title>
                <link rel="alternate" href="/2014/01/02/google-oauth2-reverse-proxy/" type="text/html" />
                <id>/2014/01/02/google-oauth2-reverse-proxy/</id>
                <updated>2014-01-02T22:00:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Using google auth for an external resource.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/googleoauth/googleoauthpre.png&#34; alt=&#34;one&#34;&gt;&lt;/p&gt;

&lt;p&gt;In this example our auth proxy is in a testbed so ports have been changed:&lt;/p&gt;

&lt;p&gt;NGINX is 8080&lt;br&gt;
Google Auth Proxy is 4180&lt;br&gt;
Apache is 80&lt;/p&gt;
&lt;h4&gt;Get a Google Oauth2 Token For Your App (webpage)&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;/assets/images/googleoauth/googoauth1.png&#34; alt=&#34;two&#34;&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://developers.google.com/accounts/docs/OAuth2WebServer&#34;&gt;instructions&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Stand Up Nginx to listen on the Internet&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
upstream staff {
    server 127.0.0.1:80;
}

server {

    listen   8080;
    server_name staff.da

    access_log  /var/log/nginx/localhost.access.log;

        location / {
            proxy_pass http://127.0.0.1:4180;
            proxy_set_header Host $host;
            proxy_set_header X-Real-IP $remote_addr;
            proxy_set_header X-Scheme $scheme;
            proxy_connect_timeout 1;
            proxy_send_timeout 30;
            proxy_read_timeout 30;
        }

}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Bitly service doing reverse proxy using Google oAut&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;/assets/images/googleoauth/googlebitly.png&#34; alt=&#34;two&#34;&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
/usr/lib/go/bin/google_auth_proxy \

    #this is our redirection domain if auth is happy
    --redirect-url=&#34;https://mydomain.com&#34; \

    #this is the registered domain
    --google-apps-domain=&#34;http://mydomain.com&#34; \

    #this is your protected resource
    --upstream=http://127.0.0.1:80/ \

    --client-id=--&gt;YOUR CLIENT ID FROM GOOOOOOOOOOOGLE&lt;--
    --client-secret=--&gt;YOUR CLIENT SECRETE&lt;--\

    --cookie-secret=wtfmysecrettokenreplacethis

&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Visit your Nginx service in a browser&amp;hellip;&lt;/h4&gt;
&lt;p&gt;&amp;hellip;and get redirected to the google oauth2 handler.&lt;/p&gt;

&lt;p&gt;&amp;ndash;redacted site&amp;ndash;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/googleoauth/googleoauthpage.jpg&#34; alt=&#34;two&#34;&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Click sign in with Google&lt;/li&gt;
&lt;li&gt;Accept that this web page wants to access your account auth&lt;/li&gt;
&lt;li&gt;Sign in (or if you are already signed in well played!)&lt;/li&gt;
&lt;li&gt;You get redirected to your site&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Notes&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Certain trails are hardcoded this can come in handy&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;
    #apache2.0 style
    Redirect /oauth/callback /
    Redirect /oauth2/callback /
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;If you have mydomain.org and you authenticate to &lt;a href=&#34;mailto:you@funtimes.org&#34;&gt;you@funtimes.org&lt;/a&gt; with google it will be rejected by the service.  You can whitelist emails to allow the domain/google email domain mismatch.&lt;/p&gt;

&lt;p&gt;&amp;ndash;authenticated-emails-file=&amp;ldquo;/root/email&amp;rdquo; #one email per line&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;You can also force the cookie domain&lt;/p&gt;

&lt;p&gt;&amp;ndash;cookie-domain=&amp;ldquo;&lt;a href=&#34;http://mydomain.org&#34;&gt;http://mydomain.org&lt;/a&gt;&amp;rdquo; \&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/bitly/google_auth_proxy&#34;&gt;bitly provider&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>trying out landscape.io</title>
                <link rel="alternate" href="/2013/11/12/trying-out-landscape.io/" type="text/html" />
                <id>/2013/11/12/trying-out-landscape.io/</id>
                <updated>2013-11-12T22:06:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I recently came across a service in beta scoring Python repositories on github.&lt;/p&gt;
&lt;h4&gt;&lt;a href=&#34;https://landscape.io&#34;&gt;Landscape&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;In their own words:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Landscape is a code quality inspector for Python codebases.
It inspects your code to find errors, possible problems, security issues.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Basically, you associate their service with your repo and they use Pylint and other tools to assign it an overall score based on PEP8 compatibility and other criteria.&lt;/p&gt;
&lt;h4&gt;Using &lt;a href=&#34;https://github.com/chasemp/sup&#34;&gt;Sup&lt;/a&gt; as an example&lt;/h4&gt;
&lt;p&gt;I have this very small project that a few people use in place of Ping so I pointed it towards that.&lt;/p&gt;

&lt;p&gt;I received an email with my first report card:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/landscape/landscape_initial_sup_rating.png&#34; alt=&#34;rc1&#34;&gt;&lt;/p&gt;

&lt;p&gt;As shown on the site:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/landscape/land_scape_sup_54.png&#34; alt=&#34;rcsite&#34;&gt;&lt;/p&gt;

&lt;p&gt;54% is listed as an &amp;#39;OK&amp;#39; rating.&lt;/p&gt;
&lt;h4&gt;What is it they are finding?&lt;/h4&gt;
&lt;p&gt;Most of what they found is cruft that should be cleaned up or removed.&lt;/p&gt;

&lt;p&gt;The socket module being reimported in my code for different classes&amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/landscape/landscape_rating_ex1.png&#34; alt=&#34;ex1&#34;&gt;&lt;/p&gt;

&lt;p&gt;An unused import from a previous refactoring&amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/landscape/landscape_rating_ex2.png&#34; alt=&#34;ex2&#34;&gt;&lt;/p&gt;

&lt;p&gt;An unused exception assignment from debugging&amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/landscape/landscape_rating_ex3.png&#34; alt=&#34;ex3&#34;&gt;&lt;/p&gt;
&lt;h4&gt;Improving my score&lt;/h4&gt;
&lt;p&gt;I addressed some of the concerns as seen &lt;a href=&#34;https://github.com/chasemp/sup/commit/9f04409f4ab0a65480289842621b889970390cfa&#34;&gt;here&lt;/a&gt; and got my new score.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/landscape/landscape_new_sup_rating.png&#34; alt=&#34;newrating&#34;&gt;&lt;/p&gt;
&lt;h4&gt;Thoughts&lt;/h4&gt;
&lt;p&gt;Seems pretty nice, and it&amp;#39;s free so I can&amp;#39;t complain. Right now it&amp;#39;s only applicable to public Python repositories on github though.  The only thing I wasn&amp;#39;t fond of was that after I had pushed my commit there was nothing on the site in my email saying they were running a new test.  I thought for sure from the delay there was a problem.&lt;/p&gt;

&lt;p&gt;My initial pushed fixes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Commit:  9f04409f4ab0a65480289842621b889970390cfa
Author:  Chase MP &lt;rush@deviantart.com&gt;
Date:    (27 hours ago) 2013-11-11 13:11:59 -0600
Subject: landscape cleanup and port niceties
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The new email didn&amp;#39;t come until &lt;pre&gt;&lt;code&gt; 11/11/13 6:57 PM &lt;/code&gt;&lt;/pre&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://landscape.io&#34;&gt;landscape&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>user args to python variables</title>
                <link rel="alternate" href="/2013/11/04/user-args-to-python-variables/" type="text/html" />
                <id>/2013/11/04/user-args-to-python-variables/</id>
                <updated>2013-11-04T21:15:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Sometimes there is no choice to but to take a certain action from a configuration file or user input.  This can involve a device type or parameter that is essentially a class specification.  There are few ways to do this kind of matching that I know of.&lt;/p&gt;

&lt;p&gt;All of these examples have the same output:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;me@vm:python test.py Fun
Fun
HI Im Fun!
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Using &lt;a href=&#34;http://docs.python.org/2/library/functions.html#eval&#34;&gt;Eval&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Well&amp;hellip;&lt;a href=&#34;http://docs.python.org/2/library/functions.html#eval&#34;&gt;eval&lt;/a&gt; can ultimately be used for good or evil. This is pretty much evil but does work.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import sys

class Fun(object):
    def __init__(self):
        print &#39;HI Im Fun!&#39;

arg = sys.argv[1]
print arg
myclass = eval(arg)
instance = myclass()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The obvious fear here is someone doing something harmful that could start like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python test.py &amp;quot;sys.path.append(&amp;#39;&amp;#47;opt&amp;#39;)&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Which just results in:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sys.path.append(&amp;#39;&amp;#47;opt&amp;#39;)
Traceback (most recent call last):
File &amp;quot;test.py&amp;quot;, line 10, in &amp;lt;module&amp;gt;
instance = myclass()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;But does show harm potential as we can see &amp;#39;/opt&amp;#39; in our modified path.&lt;/p&gt;
&lt;h4&gt;Using &lt;a href=&#34;http://docs.python.org/2/library/functions.html#getattr&#34;&gt;Getattr&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Probably the most canonical and readable option.  This is still, at least in my eyes, a potentially unsafe operation if it is as blatant as this.  Taking a raw string from a user as your class name is definitly not something to do in the wild.  Python namespaces can be tricky things and getattr is not to be used without caution.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import sys

class Fun(object):
    def __init__(self):
        print &#39;HI Im Fun!&#39;

arg = sys.argv[1]
print arg
myclass = getattr(sys.modules[__name__], arg)
instance = myclass()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Predefined dictionary&lt;/h4&gt;
&lt;p&gt;This may be the most manual and safest option.  Manual being the downside.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import sys

class Fun(object):
    def __init__(self):
        print &#39;HI Im Fun!&#39;

classes = {&#39;Fun&#39;: Fun}

arg = sys.argv[1]
print arg
myclass = classes[arg]
instance = myclass()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Inspect defined dictionary&lt;/h4&gt;
&lt;p&gt;This is the approach I have taken in the past.  This allows for only predefined classes by convention, and the list doesn&amp;#39;t have to be maintained manually.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import sys

class user_Fun(object):
    def __init__(self):
        print &#39;HI Im Fun!&#39;

#classes = {&#39;Fun&#39;: Fun}

import inspect
#http://stackoverflow.com/questions/1796180/python-get-list-of-all-classes-within-current-module
clsmembers = inspect.getmembers(sys.modules[__name__], inspect.isclass)
#[(&#39;user_Fun&#39;, &lt;class &#39;__main__.user_Fun&#39;&gt;)]
classes = {}
for discoveredclass in clsmembers:
    classes[discoveredclass[0].split(&#39;_&#39;)[1]] = discoveredclass[1]

#we get
#print classes &gt;&gt; {&#39;Fun&#39;: &lt;class &#39;__main__.user_Fun&#39;&gt;}

arg = sys.argv[1]
print arg
myclass = classes[arg]
instance = myclass()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://docs.python.org/2/library/functions.html#getattr&#34;&gt;getattr&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.python.org/2/library/functions.html#eval&#34;&gt;eval&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.python.org/2/library/inspect.html&#34;&gt;inspect&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>tcl in IOS</title>
                <link rel="alternate" href="/2013/10/24/tcl-in-IOS/" type="text/html" />
                <id>/2013/10/24/tcl-in-IOS/</id>
                <updated>2013-10-24T21:29:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;IOS has come with a &lt;a href=&#34;http://en.wikipedia.org/wiki/Tcl&#34;&gt;TCL&lt;/a&gt; interpreter baked in for awhile now.  It is suprisingly full featured and awesome.  These are some basic ideas and things I have included in my own scripts.&lt;/p&gt;
&lt;h4&gt;Printing out a message from your script&lt;/h4&gt;
&lt;p&gt;puts &amp;ldquo;\nHello World!&amp;rdquo;&lt;/p&gt;
&lt;h4&gt;Shut down an interface&lt;/h4&gt;
&lt;p&gt;puts &amp;ldquo;\nShutdown loopback&amp;rdquo;&lt;br&gt;
ios_config &amp;ldquo;interface Loopback0&amp;rdquo; &amp;ldquo;shutdown&amp;rdquo;&lt;/p&gt;
&lt;h4&gt;Removing an advertised network from BGP&lt;/h4&gt;
&lt;p&gt;puts &amp;ldquo;\nRemoving &amp;#39;network 1.0.0.0 mask 255.255.255.0&amp;#39;&amp;rdquo;&lt;br&gt;
ios_config &amp;ldquo;router bgp l335&amp;rdquo; &amp;ldquo;address-family ipv4&amp;rdquo; &amp;ldquo;no network 1.0.0.0 mask 255.255.255.0&amp;rdquo;&lt;/p&gt;
&lt;h4&gt;Echoing an affected portion of the configuration during execution&lt;/h4&gt;
&lt;p&gt;puts &amp;ldquo;\nShow section BGP&amp;rdquo;&lt;br&gt;
puts [ exec &amp;ldquo;show run | section bgp&amp;rdquo; ]&lt;/p&gt;
&lt;h4&gt;Sleep for a certain amount of time then run a command&lt;/h4&gt;
&lt;p&gt;after 1000&lt;br&gt;
puts [ exec &amp;ldquo;show ip interface brief&amp;rdquo; ]&lt;/p&gt;
&lt;h4&gt;Change MOTD banner to reflect some system status&lt;/h4&gt;
&lt;p&gt;puts &amp;ldquo;\nsetting appropriate banner&amp;rdquo;&lt;br&gt;
ios_config &amp;ldquo;no banner motd&amp;rdquo;&lt;br&gt;
ios_config &amp;ldquo;banner motd c CURRENTLY UPDATING THIS CONFIGURATION c&amp;rdquo;&lt;/p&gt;
&lt;h4&gt;Integration a TCL script&lt;/h4&gt;
&lt;p&gt;Instead of constantly running things like &amp;ldquo;tclsh mystuff.tcl&amp;rdquo; you can set an alias so the command is easier to use.&lt;/p&gt;

&lt;p&gt;Write your script and &amp;#39;copy tftp flash:&amp;#39;&amp;hellip;&lt;/p&gt;

&lt;p&gt;So you see something like&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
asr01#dir
Directory of bootflash:/
   20  -rw-         100  Oct 22 2013 11:40:02 -07:00  mystuff.tcl
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then set an alias &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alias exec mystuff tclsh flash:mystuff.tcl
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now you can just run your script using the &amp;#39;mystuff&amp;#39; command.&lt;/p&gt;
&lt;h4&gt;References&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.sadikhov.com/forum/index.php?/topic/175724-tcl-scripting-in-ios-easy-to-understand-tutorial/&#34;&gt;simple tcl in ios tutorial&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/docs/ios-xml/ios/ios_tcl/configuration/12-4t/nm-script-tcl.html&#34;&gt;official cisco ios tcl docs&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>bgp traffic shaping</title>
                <link rel="alternate" href="/2013/10/23/bgp-traffic-shaping/" type="text/html" />
                <id>/2013/10/23/bgp-traffic-shaping/</id>
                <updated>2013-10-23T21:28:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Traffic engineering in BGP is probably the most common problem encountered.  This is not intended to be a complete primer on it, just a few thoughts.&lt;/p&gt;
&lt;h4&gt;BGP Selection process (cisco oriented) in my shorthand:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;prefer path with highest WEIGHT (local to the router)&lt;/li&gt;
&lt;li&gt;prefer path with hight LOCAL_PREF (usually local to an AS)&lt;/li&gt;
&lt;li&gt;prefer locally originated (network statement, aggregate BGP, or IGP source)&lt;/li&gt;
&lt;li&gt;prefer the path with the shortest AS_PATH (unless &amp;#39;bestpath as-path ignore&amp;#39;)&lt;/li&gt;
&lt;li&gt;prefer the path with the lowest origin type (ex. IGP is lower than EGP)&lt;/li&gt;
&lt;li&gt;prefer the path with the lowest multi-exit discriminator (MED value)
&amp;ndash; first AS must be the same for this to matter unless &amp;#39;bgp always-compare-med&amp;#39;
&amp;ndash; no med means med is 0 unless &amp;#39;bgp bestpath med missing-as-worst&amp;#39;
&amp;ndash; bgp deterministic-med command can change this&lt;/li&gt;
&lt;li&gt;prefer eBGP over iBGP paths.&lt;/li&gt;
&lt;li&gt;prefer the path with the lowest IGP metric to the BGP next hop (continue on even if bestpath is already selected)&lt;/li&gt;
&lt;li&gt;determine if multiple paths require installation in the routing table for BGP Multipath&lt;/li&gt;
&lt;li&gt;when both paths are external, prefer the path that was received first (the oldest one).&lt;/li&gt;
&lt;li&gt;Prefer the route that comes from the BGP router with the lowest router ID (bgp router-id or highest IP)&lt;/li&gt;
&lt;li&gt;if the originator or router ID is the same for multiple paths, prefer the path with the minimum cluster list length.&lt;/li&gt;
&lt;li&gt;prefer the path that comes from the lowest neighbor address.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I am going to look at two scenarios: one for inbound and one for outbound traffic.&lt;/p&gt;
&lt;h4&gt;Starting Configuration&lt;/h4&gt;
&lt;p&gt;Our starting boiler plate configuration using a private AS.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
router bgp 64512
 bgp router-id 192.168.1.3
 no bgp fast-external-fallover
 bgp log-neighbor-changes
 bgp graceful-restart restart-time 120
 bgp graceful-restart stalepath-time 360
 bgp graceful-restart
 bgp maxas-limit 200
 no bgp default ipv4-unicast
 neighbor 192.168.2.2 remote-as 64513
 neighbor 192.168.2.2 description NEIGHBORONE
 neighbor 192.168.2.2 version 4
 neighbor 192.168.3.2 remote-as 64514
 neighbor 192.168.3.2 description NEIGHBORTWO
 neighbor 192.168.3.2 version 4
 !
 address-family ipv4
  neighbor 192.168.2.2 activate
  neighbor 192.168.2.2 soft-reconfiguration inbound
  neighbor 192.168.3.2 activate
  neighbor 192.168.3.2 soft-reconfiguration inbound
 exit-address-family
 !
ip bgp-community new-format
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When it comes to influencing outbound traffic Weight on a Cisco device can be the simplest option.  It is also heavy handed since it overrides native BGP best path selection.  In-bound traffic shapping on the other hand solely using BGP is a strange beast as no matter how many times you prepend your AS for an ISP it is still possible for it to be chosen.  The best you can do, is the best you can do.  If you really need a dark link your options are to not advertise BGP or redirect traffic at other points in the process.&lt;/p&gt;
&lt;h4&gt;prepending to shape inbound traffic&lt;/h4&gt;
&lt;p&gt;Using prepend to artificially inflate your route path via one ISP.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
!
!5 is a pretty reasonable prepend starting point
route-map PREPEND_FIVE permit 10
 set as-path prepend 64512 64512 64512 64512 64512
!         
router bgp 64512
 !
 address-family ipv4
  !
  !prepend your AS as you send out your advert
  neighbor 192.168.3.2 route-map PREPEND_FIVE out
  !
  end
 !
!reestablish your relationship nicely
clear ip bgp 192.168.3.2 soft out
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;using a tie breaker to influence outbound traffic&lt;/h4&gt;
&lt;p&gt;There are a few ways to do this, but this being really explicit is nice for demonstration.  Basically, we are giving all path length ties that match a regex to ISP1.  This can be tweaked depending on how favorable one ISP may be over another by assigning more or fewer tie breakers.  This is a nice to way to balance outbound as it still allows for optimum BGP route selection in most cases while influencing the utilization of your links in a deterministic way.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
!
!match AS-PATHS ending in 0-5
ip as-path access-list 1 permit [0-5]$
!
!set up route map to assign LOW metric to matching as-paths to ISP1
route-map NEIGHBORTWO-in permit 10
 match as-path 1
 set metric 10
!
!set up route map to assign HIGH metric to matching as-paths to ISP1
route-map NEIGHBORTWO-in permit 20
 set metric 20
!         
!set up route map to assign HIGH metric to matching as-paths to ISP2
route-map NEIGHBORONE-in permit 10
 match as-path 1
 set metric 20
!         
!set up route map to assign LOW metric to matching as-paths to ISP2
route-map NEIGHBORONE-in permit 20
 set metric 10
!
router bgp 64512
 !
 bgp always-compare-med
 !
 address-family ipv4
  neighbor 192.168.2.2 route-map NEIGHBORONE-in in
  neighbor 192.168.3.2 route-map NEIGHBORTWO-in in
 !
 end
 !
wr mem
!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Distribute your outbound ties to get more use out of a less preferable ISP link:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
*&gt; 1.0.0.0/24       192.168.2.2          10             0 64513 15169 i
*                   192.168.3.2           20             0 64514 2828 15169 i
*  1.0.4.0/24       192.168.2.2          20             0 64513 2828 7545 56203 i
*&gt;                  192.168.3.2           10             0 64514 2828 7545 56203 i
*  1.0.5.0/24       192.168.2.2          20             0 64513 2828 7545 56203 i
*&gt;                  192.168.3.2           10             0 64514 2828 7545 56203 i
*  1.0.6.0/24       192.168.2.2          20             0 64513 2828 4826 38803 56203 i
*&gt;                  192.168.3.2           10             0 64514 2828 4826 38803 56203 i
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The better ISP still wins when Path is the deciding factor:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
*&gt; 1.0.20.0/23      192.168.2.2          10             0 64513 2519 i
*                   192.168.3.2           20             0 64514 2828 2516 2519 i

*&gt; 1.0.26.0/23      192.168.2.2          10             0 64513 2519 i
*                   192.168.3.2           20             0 64514 2828 2516 2519 i
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cisco.com/en/US/tech/tk365/technologies_tech_note09186a0080094431.shtml&#34;&gt;bgp path selection&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/tech/tk365/technologies_tech_note09186a0080094934.shtml&#34;&gt;using med well&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>lets not do opsdev</title>
                <link rel="alternate" href="/2013/10/17/lets-not-do-opsdev/" type="text/html" />
                <id>/2013/10/17/lets-not-do-opsdev/</id>
                <updated>2013-10-17T16:26:00Z</updated>
                
                <summary type="html">This is a talk I gave to the &lt;a href=&#34;http://www.meetup.com/DevOps-Kansas-City/events/142487902/&#34;&gt;devops KC&lt;/a&gt; group at &lt;a href=&#34;http://www.kauffman.org/what-we-do/programs/entrepreneurship/kauffman-laboratories-for-enterprise-creation&#34;&gt;kauffman labs&lt;/a&gt;.</summary>
                <content type="html">&lt;p&gt;This is a talk I gave to the &lt;a href=&#34;http://www.meetup.com/DevOps-Kansas-City/events/142487902/&#34;&gt;devops KC&lt;/a&gt; group at &lt;a href=&#34;http://www.kauffman.org/what-we-do/programs/entrepreneurship/kauffman-laboratories-for-enterprise-creation&#34;&gt;kauffman labs&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;iframe src=&#34;http://www.slideshare.net/slideshow/embed_code/27298299&#34; width=&#34;427&#34; height=&#34;356&#34; frameborder=&#34;0&#34; marginwidth=&#34;0&#34; marginheight=&#34;0&#34; scrolling=&#34;no&#34; style=&#34;border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px&#34; allowfullscreen&gt; &lt;/iframe&gt; &lt;div style=&#34;margin-bottom:5px&#34;&gt; &lt;strong&gt; &lt;a href=&#34;https://www.slideshare.net/chasepettet/lets-not-doopsdev&#34; title=&#34;Lets not do_opsdev&#34; target=&#34;_blank&#34;&gt;Lets not do_opsdev&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href=&#34;http://www.slideshare.net/chasepettet&#34; target=&#34;_blank&#34;&gt;chase pettet&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/center&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;/assets/slides/lets_not_do_opsdev.pdf&#34;&gt;slides pdf&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.meetup.com/DevOps-Kansas-City/&#34;&gt;devops kc&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>dynamic bash prompts</title>
                <link rel="alternate" href="/2013/10/09/dynamic-bash-prompts/" type="text/html" />
                <id>/2013/10/09/dynamic-bash-prompts/</id>
                <updated>2013-10-09T21:18:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Getting useful info into the prompt.  Using git as an example.&lt;/p&gt;
&lt;h4&gt;Shell script /usr/local/bin/prompt.sh&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
NORMAL=$(tput sgr0)
RED=$(tput setaf 1; tput bold)
MAGENTA=$(tput setaf 5)
BLUE=$(tput setaf 4)

function red() {
    echo -e &#34;$RED$*$NORMAL&#34;
}

function mag() {
    echo -e &#34;$MAGENTA$*$NORMAL&#34;
}

function blue() {
    echo -e &#34;$BLUE$*$NORMAL&#34;
}


function parse_git_branch {
    gs=$(git rev-parse --symbolic-full-name --abbrev-ref HEAD 2&gt; /dev/null)
    if [ -z &#34;$gs&#34; ]; then
      return
    fi
    if [ &#34;$gs&#34; == &#34;master&#34; ]
    then
        gs=$(mag &#34;m&#34;)
    else
        gs=$(red &#34;$gs&#34;)
    fi

    echo &#34;[$gs]&#34;
}

parse_git_branch
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;.bashrc&lt;/h4&gt;
&lt;p&gt;Here we capture and extend the PROMPT_COMMAND in case it was defined previously.  On OSX Darwin it is.  We also define our PS1 in  PROMPT_COMMAND.  This does mean basically that we are executing our prompt.sh each time we hit return.  This does not feel sluggish for me, and this way when I use my setup in different environments I don&amp;#39;t have to worry about PS1 being defined somewhere else conflicting or stomping on my changes as we are going to prepend anyway.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#so as not to stomp on existing prompt commands
#we capture them to append our own
if [ -z &#34;$PROMPT_COMMAND&#34; ]; then
    PREV_CMD=
else
    PREV_CMD=&#34;${PROMPT_COMMAND}; &#34;
fi

PROMPT_COMMAND=&#34;${PREV_CMD}&#34;&#39;if [ -z &#34;${_PS1_ORIG}&#34; ]; then
                    export _PS1_ORIG=$PS1;
                fi;
                export _PS1=&#34;$(/usr/local/bin/prompt.sh)&#34;;
                PS1=&#34;${_PS1}${_PS1_ORIG}&#34;&#39;

export PROMPT_COMMAND
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>sqlite truncate</title>
                <link rel="alternate" href="/2013/10/04/sqlite-truncate/" type="text/html" />
                <id>/2013/10/04/sqlite-truncate/</id>
                <updated>2013-10-04T21:18:00Z</updated>
                
                <summary type="html">SQLite does not seem to support the &lt;a href=&#34;http://dev.mysql.com/doc/refman/5.0/en/truncate-table.html&#34;&gt;truncate&lt;/a&gt; command.  This is hacky way to do it.</summary>
                <content type="html">&lt;p&gt;SQLite does not seem to support the &lt;a href=&#34;http://dev.mysql.com/doc/refman/5.0/en/truncate-table.html&#34;&gt;truncate&lt;/a&gt; command.  This is hacky way to do it.&lt;/p&gt;

&lt;p&gt;Getting the schema for a table name&amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;pre&gt;&lt;code&gt;&lt;br&gt;
SQLite version 3.7.7 2011-06-25 16:35:41&lt;br&gt;
Enter &amp;quot;.help&amp;quot; for instructions&lt;br&gt;
Enter SQL statements terminated with a &amp;quot;;&amp;quot;&lt;br&gt;
sqlite&amp;gt; .schema&lt;br&gt;
&lt;/pre&gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Let&amp;#39;s say this is part of our schema&amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;CREATE TABLE MYTABLE(myfield TEXT NOT NULL,
                       datetime timestamp);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Drop all rows in a table&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Delete from MYTABLE
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Reset autoincrement counter if applicable&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;DELETE FROM SQLITE_SEQUENCE WHERE name=&amp;#39;MYTABLE&amp;#39;;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://sqlite.org/lang_delete.html&#34;&gt;sqlite delete&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>fabric basics part 2</title>
                <link rel="alternate" href="/2013/10/04/fabric-basics-part-2/" type="text/html" />
                <id>/2013/10/04/fabric-basics-part-2/</id>
                <updated>2013-10-04T21:17:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Small fabric examples of functionality continued from fabric basics.&lt;/p&gt;
&lt;h4&gt;Define server roles&lt;/h4&gt;
&lt;p&gt;Server roles allow you to group boxes for taking actions against them as a cluster.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
from fabric.api import env, sudo, parallel, roles

env.roledefs = {
    &#39;web&#39;: [&#39;host1&#39;, &#39;host2&#39;, &#39;host3&#39;, &#39;host4&#39;, &#39;host5&#39;],
}

@roles(&#39;web&#39;)
def uname():
    sudo(&#39;uname -a&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:$ time fab uname
[host1] Executing task &#39;uname&#39;
[host1] sudo: uname -a
[host1] out: Linux host1 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host1] out: 

[host2] Executing task &#39;uname&#39;
[host2] sudo: uname -a
[host2] out: Linux host2 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host2] out: 

[host3] Executing task &#39;uname&#39;
[host3] sudo: uname -a
[host3] out: Linux host3 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host3] out: 

[host4] Executing task &#39;uname&#39;
[host4] sudo: uname -a
[host4] out: Linux host4 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host4] out: 

[host5] Executing task &#39;uname&#39;
[host5] sudo: uname -a
[host5] out: Linux host5 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host5] out: 


Done.
Disconnecting from host3... done.
Disconnecting from host4... done.
Disconnecting from host5... done.
Disconnecting from host1... done.
Disconnecting from host2... done.

real    0m11.328s
user    0m0.396s
sys 0m0.079s
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Run tasks in &lt;a href=&#34;http://docs.fabfile.org/en/1.3.2/usage/parallel.html&#34;&gt;parallel&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Simultaneous instead of serial. Notice 2.6s vs. 11.328s above.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
from fabric.api import env, sudo, parallel, roles

env.roledefs = {
    &#39;web&#39;: [&#39;host1&#39;, &#39;host2&#39;, &#39;host3&#39;, &#39;host4&#39;, &#39;host5&#39;],
}

@parallel
@roles(&#39;web&#39;)
def uname():
    sudo(&#39;uname -a&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
[host1] Executing task &#39;uname&#39;
[host2] Executing task &#39;uname&#39;
[host3] Executing task &#39;uname&#39;
[host4] Executing task &#39;uname&#39;
[host5] Executing task &#39;uname&#39;
[host5] sudo: uname -a
[host4] sudo: uname -a
[host3] sudo: uname -a
[host2] sudo: uname -a
[host1] sudo: uname -a
[host5] out: Linux host5 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host5] out: 
[host3] out: Linux host3 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host3] out: 
[host4] out: Linux host4 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host4] out: 
[host1] out: Linux host1 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host1] out: 
[host2] out: Linux host2 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1+deb7u1 x86_64 GNU/Linux
[host2] out: 


Done.

real    0m2.164s
user    0m0.549s
sys 0m0.116s
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;running commands on remote in bg&lt;/h4&gt;
&lt;p&gt;Because of how remote shells are spawned running commands in the background remotely can be tricky.  This example is provided in the wiki.  I did not get this to work reliably.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;run(&amp;quot;nohup %s &amp;gt;&amp;amp; &amp;#47;dev&amp;#47;null &amp;lt; &amp;#47;dev&amp;#47;null &amp;amp;&amp;quot; % (cmd,))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I prefer using &lt;a href=&#34;http://stackoverflow.com/questions/8775598/start-a-background-process-with-nohup-using-fabric&#34;&gt;dtach&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aptitude install dtach
def bg_cmd(cmd):
    run(&amp;#39;dtach -n `mktemp -u &amp;#47;tmp&amp;#47;%s.XXXX` %s&amp;#39; % (env.user, cmd)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This way if a job runs long or hangs you can always remote in and attach to the session to investigate.&lt;/p&gt;
&lt;h4&gt;Using sudo&lt;/h4&gt;
&lt;p&gt;If you need to escalate permissions on a remote host you can use sudo().  If you are using key based authentication with key forwarding you should have things configured so passwords are not required.  However, you can also have it prompt for a passphrase.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;me@vm:$ time fab uname -H user@idle01
[user@idle01] Executing task &amp;#39;uname&amp;#39;
[user@idle01] sudo: uname -a
[user@idle01] Passphrase for private key: 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Regular sudo commands with key auth can be run using run() as well.  This works fine.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;def foo():
    run(&amp;#39;sudo whoami&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;When restarting a daemon try &lt;a href=&#34;https://github.com/fabric/fabric/issues/395&#34;&gt;&amp;#39;pty=False&amp;#39;&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;If this is a lab scenario with constantly changing host names and keys you can use &lt;a href=&#34;http://docs.fabfile.org/en/1.4.2/usage/env.html#disable-known-hosts&#34;&gt;disable known hosts&lt;/a&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;in order to avoid&amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;fabric.exceptions.NetworkError: \
Host key for OLDHOST did not match pre-existing key! \
Server&amp;#39;s key was changed recently, or possible man-in-the-middle attack.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://docs.fabfile.org/en/1.3.4/faq.html&#34;&gt;fabric faq&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/fabric/fabric/issues/216&#34;&gt;issue on running procs in bg&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://stackoverflow.com/questions/16367144/fabric-sudo-silently-failing&#34;&gt;restarting daemon on so&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.linuxandlife.com/2012/01/make-sudo-stop-asking-for-password-when.html&#34;&gt;sudo no password&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.pythonforbeginners.com/systems-programming/how-to-use-fabric-in-python/&#34;&gt;fabric howto&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://stackoverflow.com/questions/3737003/can-i-prevent-fabric-from-prompting-me-for-a-sudo-password&#34;&gt;sudo and prompts&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>fabric basics</title>
                <link rel="alternate" href="/2013/09/26/fabric-basics/" type="text/html" />
                <id>/2013/09/26/fabric-basics/</id>
                <updated>2013-09-26T17:22:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Fabric is a framework for environment automation.  Often it is used for code deployments but that is only a possibility and not a limitation.&lt;/p&gt;
&lt;h4&gt;Writing a Fabric function&lt;/h4&gt;
&lt;p&gt;Fabric uses the python path to look for something to import called &amp;#39;fabfile&amp;#39;.  This can be a fabfile.py file&lt;br&gt;
in your current directory or a fabfile/&lt;strong&gt;init&lt;/strong&gt;.py module somewhere in the python path.  &lt;/p&gt;

&lt;p&gt;Python Path On a Python2.7 System:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; import sys; print sys.path
[&#39;&#39;, &#39;/usr/lib/python2.7&#39;, &#39;/usr/lib/python2.7/plat-linux2&#39;,
     &#39;/usr/lib/python2.7/lib-tk&#39;, &#39;/usr/lib/python2.7/lib-old&#39;,
     &#39;/usr/lib/python2.7/lib-dynload&#39;, &#39;/usr/local/lib/python2.7/dist-packages&#39;,
     &#39;/usr/lib/python2.7/dist-packages&#39;, &#39;/usr/lib/pymodules/python2.7&#39;]
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Fabric &amp;#39;Hello World!&amp;#39;&lt;/h4&gt;
&lt;p&gt;Create a fabfile.py in your current directory and add this hello() function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
├── fabfile.py

    def hello():
        print(&#34;Hello World!&#34;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;List the available fabric commands using the &amp;#39;fab&amp;#39; utility:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@vm:~&amp;#47;fabric# fab -l
Available commands:

    hello
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Execute the &amp;#39;hello&amp;#39; function.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@vm:~&amp;#47;fabric# fab hello
Hello World!

Done.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Fabric and run local commands&lt;/h4&gt;
&lt;p&gt;Add the following to fabfile.py&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from fabric.api import local
def localetcissue():
    print local(&amp;#39;cat &amp;#47;etc&amp;#47;issue&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Execute your command:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@vm:~&amp;#47;fabric# fab localetcissue
[localhost] run: cat &amp;#47;etc&amp;#47;issue
Debian GNU&amp;#47;Linux 7.1 \n \l

Done.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Fabric can run remote commands&lt;/h4&gt;
&lt;p&gt;This is assuming you have ssh key based authentication setup.  If not then try out these &lt;a href=&#34;https://help.github.com/articles/generating-ssh-keys&#34;&gt;instructions&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Add the following to fabfile.py&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;from fabric.api import run
def whoami():
    print run(&amp;#39;whoami&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Execute your command:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@vm:~&amp;#47;fabric# fab -H remotehost.com whoami
[&amp;#39;remotehost.com&amp;#39;]
[remotehost.com] run: whoami
[remotehost.com] out: root
serviceuser

Done.
Disconnecting from remotehost.com... done.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Fabric can report remote command failure or success&lt;/h4&gt;
&lt;p&gt;Add the following to fabfile.py&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
def success():
     result = run(&#39;file /opt&#39;)
     if result.return_code == 0: 
         print &#39;return code is 0&#39;
     print result

def fail():
    result = run(&#39;file /what&#39;)
    if result.return_code != 0: 
        print &#39;return code is not 0&#39;
    print result
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Execute your commands:&lt;/p&gt;

&lt;p&gt;Success&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
root@vm:~/fabric# fab -H remotehost.com success
[&#39;remotehost.com&#39;]
[remotehost.com] run: file /opt
[remotehost.com] out: /opt: directory
return code is 0
/opt: directory

Done.
Disconnecting from remotehost.com... done.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Falure&amp;hellip;(as an exception)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
[&#39;remotehost.com&#39;]
[remotehost.com] run: file /what
[remotehost.com] out: /what: ERROR: cannot open `/what&#39; (No such file or directory)

Fatal error: run() encountered an error (return code 1) while executing &#39;file /what&#39;

Aborting.
Disconnecting from remotehost.com... done.
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Fabric can change behavior and settings with &lt;a href=&#34;http://docs.fabfile.org/en/1.4.0/usage/env.html&#34;&gt;ENV&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Getting remote failures but continuing execution.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
from fabric.api import env
env.warn_only = True
def fail():
    result = run(&#39;file /what&#39;)
    if result.return_code != 0: 
        print &#39;return code is not 0&#39;
    print result
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Failure (handled gracefully)&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
root@vm:~/fabric# fab -H remotehost.com fail
[&#39;remotehost.com&#39;]
[remotehost.com] run: file /what
[remotehost.com] out: /what: ERROR: cannot open `/what&#39; (No such file or directory)

Warning: run() encountered an error (return code 1) while executing &#39;file /what&#39;

return code is not 0
/what: ERROR: cannot open `/what&#39; (No such file or directory)

Done.
Disconnecting from remotehost.com... done.
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;&lt;a href=&#34;http://docs.fabfile.org/en/1.4.0/usage/env.html&#34;&gt;ENV&lt;/a&gt; can be directly manipulated but it is canonical either way&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
from fabric.api import env, run
#specify a host to run command on
env.hosts = [&#39;remotehost.com&#39;]
#specify remote user to use
env.user = &#39;serviceuser&#39;
#specify key file to use
env.key_filename = &#39;/home/serviceuser/serviceuser.pem&#39;
#only warn on failure
env.warn_only = True

def whoami():
    print env.host_string
    print run(&#39;whoami&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This execution&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
root@vm:~/fabric# fab whoami
[&#39;remotehost.com&#39;]
remotehost.com
[remotehost.com] run: whoami
[remotehost.com] out: serviceuser
serviceuser

Done.
Disconnecting from remotehost.com... done.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Looks the same as this execution&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
root@vm:~/fabric# fab -H remotehost.com whoami
[&#39;remotehost.com&#39;]
remotehost.com
[remotehost.com] run: whoami
[remotehost.com] out: serviceuser
serviceuser

Done.
Disconnecting from remotehost.com... done.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It all sets env.host_string in the end.  I think of it basically as namespace-ish.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;env.host_string = &amp;#39;remotehost2.com&amp;#39; &amp;gt; env.hosts = [&amp;#39;remotehost.com&amp;#39;] &amp;gt; fab -H remotehost.com whoami
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you set this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
def whoami():
    env.host_string = &#39;remotehost2.com&#39;
    print run(&#39;whoami&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you do &amp;#39;fab -H remotehost.com whoami&amp;#39; or &amp;#39;&amp;#39;env.hosts = [&amp;#39;remotehost.com&amp;#39;]&amp;#39; it still executes on &amp;#39;remotehost2.com&amp;#39;.&lt;/p&gt;
&lt;h4&gt;Fabric functions can accept arguments form the CLI&lt;/h4&gt;
&lt;p&gt;Using the &amp;#39;with&amp;#39; statement here to hide native fabric output since I want to more tightly control what is terminal output in this scenario.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
from fabric.api import env, run, hide

def command(cmd):
    with hide(&#39;everything&#39;):
        print run(cmd)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Execution runs as me with my ssh key (with argument passing)&amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rush@vm:~&amp;#47;fabric$ fab -H remotehost2.com command:cmd=&amp;#39;uname -a&amp;#39;
Linux remotehost2.com 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1 x86_64 GNU&amp;#47;Linux

Done.
Disconnecting from remotehost2.com... done.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Fabric functions can be run with fabric as a normal library&lt;/h4&gt;
&lt;p&gt;Setting up your script to use a service account.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import sys
from fabric.api import env, run, hide

def cmd(host, cmd, user):
    import sys
    env.host_string = host
    env.user = user
    env.key_filename = &#39;/home/%s/.ssh/id_rsa&#39; % (user,)
    with hide(&#39;everything&#39;):
        return run(cmd)

print cmd(sys.argv[1], sys.argv[2], &#39;serviceuser&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Execution&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
root@vm:~/fabric# python cmd.py remotehost2.com &#39;ls -al&#39;
total 12
drwxr-xr-x 3 serviceuser users   65 Apr  9  2012 .
drwxr-xr-x 9 root        root    96 Jan 11  2013 ..
drwx------ 2 serviceuser root    28 Apr  9  2012 .ssh
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/fabric/fabric&#34;&gt;fabric on gh&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.fabfile.org/en/1.4.0/usage/env.html&#34;&gt;ENV&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.fabfile.org/en/1.4.0/usage/output_controls.html&#34;&gt;output controls&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://stackoverflow.com/questions/4888568/can-i-catch-error-codes-when-using-fabric-to-run-calls-in-a-remote-shell&#34;&gt;so errors code with fabric&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.debian-administration.org/articles/671&#34;&gt;debian intro&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.linuxjournal.com/content/fabric-system-administrators-best-friend?page=0,1&#34;&gt;linux journal&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>sup intro devops kc</title>
                <link rel="alternate" href="/2013/09/26/sup-intro-devops-kc/" type="text/html" />
                <id>/2013/09/26/sup-intro-devops-kc/</id>
                <updated>2013-09-26T16:34:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Presentation&lt;/h4&gt;
&lt;p&gt;I walked through these slides demonstrating the simple tool &lt;a href=&#34;https://github.com/chasemp/sup&#34;&gt;sup.py&lt;/a&gt; I wrote at the &lt;a href=&#34;http://www.meetup.com/DevOps-Kansas-City/&#34;&gt;devops kc meetup&lt;/a&gt;.  Sup can be used in place of ping/tcping/httping on some occasions to great/medium/some success!&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;iframe src=&#34;http://www.slideshare.net/slideshow/embed_code/26585437&#34; width=&#34;476&#34; height=&#34;400&#34; frameborder=&#34;0&#34; marginwidth=&#34;0&#34; marginheight=&#34;0&#34; scrolling=&#34;no&#34;&gt;&lt;/iframe&gt;&lt;/center&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;/assets/slides/sup_intro.pdf&#34;&gt;slides pdf&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.meetup.com/DevOps-Kansas-City/&#34;&gt;devops kc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.vanheusden.com/httping/&#34;&gt;httping&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.elifulkerson.com/projects/tcping.phphttp://www.elifulkerson.com/projects/tcping.php&#34;&gt;tcping&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://nmap.org/&#34;&gt;nmap&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>freeradius external authentication</title>
                <link rel="alternate" href="/2013/09/16/freeradius-external-authentication/" type="text/html" />
                <id>/2013/09/16/freeradius-external-authentication/</id>
                <updated>2013-09-16T16:35:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Installing Freeradius&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install freeradius
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Package: freeradius
Status: install ok installed
Maintainer: Josip Rodin &lt;joy-packages@debian.org&gt;
Architecture: amd64
Version: 2.1.10+dfsg-2+squeeze1
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Installing example external auth script&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;git clone https:&amp;#47;&amp;#47;github.com&amp;#47;chasemp&amp;#47;fradiusauth.git
cp fradiusauth&amp;#47;fradiusauth.py &amp;#47;usr&amp;#47;local&amp;#47;bin&amp;#47;
cp fradiusauth&amp;#47;libradclient.py &amp;#47;usr&amp;#47;local&amp;#47;bin&amp;#47;
chmod +x &amp;#47;usr&amp;#47;local&amp;#47;bin&amp;#47;fradiusauth.py
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Change &amp;#39;chasemp&amp;#39; user and password to yours.&lt;/p&gt;
&lt;h4&gt;Make the external script responsible for auth and add user&lt;/h4&gt;
&lt;p&gt;This signifies that freeradius should call your external script for authentication. It will wait for execution of the script to finish and use the exit code.  0 is considered a healthy and viable auth, and anything else is considered invalid.&lt;/p&gt;

&lt;p&gt;/etc/freeradius/users/&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
DEFAULT  Auth-Type = Accept
         Exec-Program-Wait = &#34;/usr/local/bin/fradiusauth.py %{User-Name} \
                                                           &#39;%{User-Password}&#39; \
                                                            %{Calling-Station-Id} \
                                                            %{NAS-IP-Address} \
                                                            %{Framed-Protocol}&#34;,
         Fall-Through = Yes

&lt;yourusername&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Add your client&lt;/h4&gt;
&lt;p&gt;This should reflect the calling IP the authentication host is calling from.&lt;/p&gt;

&lt;p&gt;/etc/freeradius/clients.conf&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
client 127.0.0.1 {
  secret = radsecret
  shortname = myhost
  nastype = other
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Testing authentication&lt;/h4&gt;
&lt;p&gt;There is a good and basic radius client implementation on gh called &lt;a href=&#34;https://github.com/chasemp/py-radius.git&#34;&gt;py-radius&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
git clone https://github.com/chasemp/py-radius.git
cd py-radius
python setup.py install
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;libradclient.py 127.0.0.1 radsecret &amp;lt;yourusername&amp;gt; &amp;lt;yourpass&amp;gt;
&amp;lt;you&amp;gt; authenticated
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;Freeradius support the &amp;#39;reload&amp;#39; command for init&lt;/li&gt;
&lt;li&gt;If you want to debug radius stop the service and launch in your terminal like &amp;#39;/usr/bin/freeradius -X&amp;#39;&lt;/li&gt;
&lt;li&gt;-X debugging sessions will receive incoming passwords &lt;strong&gt;unencrypted&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;Referenence&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/chasemp/fradiusauth&#34;&gt;gh&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/btimby/py-radius&#34;&gt;py radius&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://freeradius.org/&#34;&gt;freeradius&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>selecting a subset for sampling</title>
                <link rel="alternate" href="/2013/09/13/selecting-a-subset-for-sampling/" type="text/html" />
                <id>/2013/09/13/selecting-a-subset-for-sampling/</id>
                <updated>2013-09-13T16:36:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;In the devops world there are a lot of reasons to want good stats, but sometimes the load for collecting those stats on every execution of a script or web page is too invasive.  &lt;a href=&#34;http://en.wikipedia.org/wiki/A/B_testing&#34;&gt;A/B testing&lt;/a&gt; is another place where we want to select a certain portion of served pages and take appropriate action.  The straight forward way to select a subset is a state based system.  For every page that executes you can add an id to a set in redis.  If you are looking for 5% of pages then look to see if the item count is 20.  If you are number 20 you can flush the list and the count starts over.  This is not meant for real world usage but that is the basic idea behind selecting a portion of pages by keeping state between all executions.&lt;/p&gt;

&lt;p&gt;If the state based system is too slow, clunky, unreliable or inelegant there has to be an alternative.&lt;/p&gt;
&lt;h4&gt;Modulo Operation&lt;/h4&gt;
&lt;p&gt;The &lt;a href=&#34;http://en.wikipedia.org/wiki/Modulo_operation&#34;&gt;modulo operation&lt;/a&gt; finds the remainder of one number divided by another.&lt;/p&gt;

&lt;p&gt;Example of Modulo operations:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; 1 % 1
0
&gt;&gt;&gt; 2 % 1
0
&gt;&gt;&gt; 5 % 2
1
&gt;&gt;&gt; 9 / 4
2
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So you take all the numbers 1 - 100 the percentage of modulus operations with a remainder of 0 for the number 10 is 10%.&lt;/p&gt;
&lt;h4&gt;Combining stateful tracking of executions and modulus&lt;/h4&gt;
&lt;p&gt;If you want to you can combine these two ideas.  In order to sample 5% of executions you could track the execution order of your scripts in redis (or somwhere) looking for a modulus operation remainder of 0 each time to identify an appropriate sample page.  Exectuions 1 - 19 will not be sampled, but 20 will.  So will 40, 60, 80, and 100.  When script 101 queries to see where in the order it is it will be told it is 1 and the cycle starts over.  This way each job would have a 5% chance of being selected as a sample.&lt;/p&gt;

&lt;p&gt;This is not any more advantages than the simply having every page know when it&amp;#39;s number 20.&lt;/p&gt;
&lt;h4&gt;Using the law of averages to provide a quick sample determination&lt;/h4&gt;
&lt;p&gt;Let&amp;#39;s say we have a simple query and we want 10% to send a stat to statsd.  The pseudo code might look like&lt;/p&gt;
&lt;h1&gt;python-ish pseudo code&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;
import random
sample_interval = 20
start_time = time.time()
user_id = execute_mysql_query(&#39;select %s from users&#39; % username)
total_time = time.time() - start_time
print user_id
if random.randint(0, 100) % sample_interal == 0:
    submit_to_statsd(&#39;time.to.query.userid&#39;, total_time)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Over time this should submit a sample of 5% of all user_id queries to statsd.  The first 100 you may get 0, 5, or 8 but with a larger sample you get around 5% and it is much cheaper than trying to have each execution determine where it is in the pecking order for stats submission.&lt;/p&gt;
&lt;h4&gt;Just how accurate is the law of averages here?&lt;/h4&gt;
&lt;p&gt;Here is a snippet to figure out the percentage of matches in a spread for a particular modulus integer.  Ideally using the operation &amp;#39;int % 10 == 0&amp;#39; will have a sample rate of 10 percent.  The user passes in the top end of the range, we cycle through 10 times.  The number of matches in each pass is summed and then used to calculate in the average match percentage across all tries.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import sys
import random
try_match = []
tries = 10
#make 10 passes of user defined range
while tries &gt; 0:
    match = []
    #how many times should I try to match my modulus op
    for i in range(0, int(sys.argv[1])):
        if random.randint(0, 100) % 10 == 0:
            match.append(i)

    #append the number of matches
    try_match.append(len(match))
    tries -= 1

average_sampled = sum(try_match) / 10
print average_sampled * 100 / int(sys.argv[1]) 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Looks like (actual runs)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:~/php# python modulo.py 10
10
me@vm:~/php# python modulo.py 100
11
me@vm:~/php# python modulo.py 1000
10
me@vm:~/php# python modulo.py 10000
10
me@vm:~/php# python modulo.py 100000
10
me@vm:~/php# python modulo.py 1000000
10
me@vm:~/php# python modulo.py 10000000
10
me@vm:~/php# python modulo.py 100000000
10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is almost too perfect but the idea is this the accuracy of percentage sampled gets better over the long run.  In &lt;br&gt;
reality if you run this 10 times it won&amp;#39;t be 10% all of the time, but if you run it against 1000 it will be most of the &lt;br&gt;
time.&lt;/p&gt;

&lt;p&gt;Testing against a small range is wildly variable:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:~/php# python modulo.py 10
10
me@vm:~/php# python modulo.py 10
10
me@vm:~/php# python modulo.py 10
10
me@vm:~/php# python modulo.py 10
10
me@vm:~/php# python modulo.py 10
0
me@vm:~/php# python modulo.py 10
0
me@vm:~/php# python modulo.py 10
10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Testing against a large range is nicely consistent:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:~/php# python modulo.py 1000
10
me@vm:~/php# python modulo.py 1000
11
me@vm:~/php# python modulo.py 1000
10
me@vm:~/php# python modulo.py 1000
11
me@vm:~/php# python modulo.py 1000
10
me@vm:~/php# python modulo.py 1000
10
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Using this to match 10% of PHP pages&lt;/h4&gt;
&lt;p&gt;I am going to use the following code to test this principle for PHP.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
$sample_rate = 10;
$total_tries = $argv[1];
$matches = array();
$nonmatches = array();
echo &#34;$total_tries \n&#34;;
foreach (range(1, $total_tries) as $number) {

    $random_number = rand();

    if ($random_number % $sample_rate === 0) {
        $matches[] = $random_number;
        // if this were a real page you would submit your stat here
        // since it matches your sample rate
    }
    else {
        $nonmatches[] = $random_number;
    }
}

$matchcount = count($matches);
$nonmatchcount = count($nonmatches);
print &#34;matches: $matchcount\n&#34;;
print &#34;nonmatches: $nonmatchcount\n&#34;;
$dive = $matchcount * 100;
$prc = $dive / $total_tries;
echo &#34;$prc&#34; . &#34;\n&#34;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Looks Like&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:~/php# php modtest.php 10  
10 
matches: 0
nonmatches: 10
0

me@vm:~/php# php modtest.php 100
100 
matches: 9
nonmatches: 91
9

me@vm:~/php# php modtest.php 1000
1000 
matches: 104
nonmatches: 896
10.4

me@vm:~/php# php modtest.php 10000
10000 
matches: 971
nonmatches: 9029
9.71

me@vm:~/php# php modtest.php 100000
100000 
matches: 10114
nonmatches: 89886
10.114

me@vm:~/php# php modtest.php 1000000
1000000 
matches: 99407
nonmatches: 900593
9.9407

me@vm:~/php# php modtest.php 1000000 
1000000 
matches: 99716
nonmatches: 900284
9.9716

me@vm:~/php# php modtest.php 10000000
10000000 
matches: 1001427
nonmatches: 8998573
10.01427
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://stackoverflow.com/questions/5555712/generate-a-random-number-in-python&#34;&gt;random numbers in python&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.python.org/2/library/random.html&#34;&gt;py random doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://en.wikipedia.org/wiki/Law_of_averages&#34;&gt;loa&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://en.wikipedia.org/wiki/Modulus&#34;&gt;module wiki&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/chasemp/archive/tree/master/modtest&#34;&gt;on gh&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>graphite on centos6 lessons learned</title>
                <link rel="alternate" href="/2013/09/12/graphite-on-centos6-lessons-learned/" type="text/html" />
                <id>/2013/09/12/graphite-on-centos6-lessons-learned/</id>
                <updated>2013-09-12T16:37:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Getting graphite going on CentOS 6&lt;/p&gt;
&lt;h4&gt;Installing packages&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
yum update
yum -y groupinstall &#39;Development Tools&#39;
sudo yum install http://yum.puppetlabs.com/el/6/products/i386/puppetlabs-release-6-7.noarch.rpm
sudo yum install  http://mirror-fpt-telecom.fpt.net/fedora/epel/6/i386/epel-release-6-8.noarch.rpm
yum update
yum install -y pycairo mod_python mod_wsgi Django python-ldap python-memcached \
               python-sqlite2  bitmap bitmap-fonts python-devel python-crypto \
               pyOpenSSL gcc python-zope-filesystem python-zope-interface \
               git zlib-static git tree rsync git python-pip python-devel httpd \
               django-tagging links htop
yum install twisted
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;pip install whisper
pip install carbon
pip install graphite-web
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Check for missing dependencies&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@vm:~# python &amp;#47;tmp&amp;#47;pip-build-me&amp;#47;graphite-web&amp;#47;check-dependencies.py

All necessary dependencies are met.
All optional dependencies are met.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Fixup config files and permissions&lt;/h4&gt;
&lt;p&gt;Fixing permissions since pip doesn&amp;#39;t have distro specific knowledge to set this up.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
chown -R apache:apache /opt/graphite/storage/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Setting up configurations from example defaults.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
cp /opt/graphite/webapp/graphite/local_settings.py.example \
              /opt/graphite/webapp/graphite/local_settings.py
cp /opt/graphite/conf/carbon.conf.example /opt/graphite/conf/carbon.conf
cp /opt/graphite/conf/storage-schemas.conf.example /opt/graphite/conf/storage-schemas.conf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Run database setup&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
python /opt/graphite/webapp/graphite/manage.py syncdb
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Setup more configurations from defaults&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
cd /opt/graphite/conf/
sudo cp graphite.wsgi.example graphite.wsgi
sudo cp storage-schemas.conf.example storage-schemas.conf
sudo cp carbon.conf.example carbon.conf
cd /opt/graphite/webapp/graphite
sudo cp local_settings.py.example local_settings.py
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;make sure if you are using django 1.4 this portion of local_settings.py is uncommented&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
# The default is &#39;django.db.backends.sqlite3&#39; with file &#39;graphite.db&#39;
# located in STORAGE_DIR
#
DATABASES = {
    &#39;default&#39;: {
        &#39;NAME&#39;: &#39;/opt/graphite/storage/graphite.db&#39;,
        &#39;ENGINE&#39;: &#39;django.db.backends.sqlite3&#39;,
        &#39;USER&#39;: &#39;&#39;,
        &#39;PASSWORD&#39;: &#39;&#39;,
        &#39;HOST&#39;: &#39;&#39;,
        &#39;PORT&#39;: &#39;&#39;
    }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Configuring HTTPD&lt;/h4&gt;
&lt;p&gt;cat /etc/httpd/conf.d/wsgi.conf &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;WSGISocketPrefix &amp;#47;var&amp;#47;run&amp;#47;wsgi
LoadModule wsgi_module modules&amp;#47;mod_wsgi.so
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;cat /etc/httpd/conf.d/graphite.conf&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
ServerName your.com
Document &#34;/opt/graphite/webapp&#34;
WSGIDaemonProcess graphite processes=5 threads=5 display-name=&#39;%{GROUP}&#39; inactivity-timeout=120
WSGIProcessGroup graphite
WSGIApplicationGroup %{GLOBAL}
WSGIImportScript /opt/graphite/conf/graphite.wsgi process-group=graphite application-group=%{GLOBAL}
WSGIScriptAlias / /opt/graphite/conf/graphite.wsgi 
_&lt;_Location /_&gt;_
    AuthType None
    Require all granted
    Satisfy Any
_&lt;_/Location_&gt;_
Alias /content/ /opt/graphite/webapp/content/
_&lt;_Location &#34;/content/&#34;_&gt;_
    SetHandler None
_&lt;_/Location_&gt;_
Alias /media/ &#34;@DJANGO_me@/contrib/admin/media/&#34;
_&lt;_Location &#34;/media/&#34;_&gt;_
    SetHandler None
_&lt;_/Location_&gt;_
_&lt;_Directory /opt/graphite/conf/_&gt;_
    Order deny,allow
    Allow from all
_&lt;_/Directory_&gt;_
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Remove welcome default&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;rm -f &amp;#47;etc&amp;#47;httpd&amp;#47;conf.d&amp;#47;welcome.conf
chown -R apache:apache &amp;#47;opt&amp;#47;graphite&amp;#47;storage
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Carbon LSB init script&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;n &amp;#47;etc&amp;#47;init.d&amp;#47;carbon
chmod +x  &amp;#47;etc&amp;#47;init.d&amp;#47;carbon
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;contents:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#!/bin/bash -e

#Define dependencies
CARBON_BIN=/opt/graphite/bin/carbon-cache.py
PGREP=/usr/bin/pgrep

function verifyfile() {
    local BIN=$1
    test -x $BIN || { echo &#34;$BIN not installed&#34;;
        if [ &#34;$1&#34; = &#34;stop&#34; ]; then exit 0;
        else exit 5; fi; }
}

# Check for missing binaries
verifyfile &#34;$CARBONB_BIN&#34;
verifyfile &#34;$PGREP&#34;

case &#34;$1&#34; in
    start)
        if [ &#34;$($PGREP -f $CARBON_BIN)&#34; ]
        then
            echo &#34;already running&#34;;
            exit 0
        fi

        $CARBON_BIN start
        $0 status
        ;;
    stop)

        function exterminate() {
            local PROC=$1
            pid=$(pgrep -f $PROC)
            if [ !&#34;$pid&#34; ]
            then
                kill -9 $pid;
                sleep 1;
            fi
        }

        exterminate &#34;$CARBON_BIN&#34;
        $0 status
        ;;
    restart)
        $0 stop
        sleep 1
        $0 start
        ;;
    status)

        if [ &#34;$($PGREP -f $CARBON_BIN)&#34; ]
        then
            echo &#34;running&#34;;
        else
            echo &#34;not running&#34;;
        fi
        ;;
    *)
        $0 status
        ;;
esac
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Starting things&lt;/h4&gt;
&lt;p&gt;/etc/init.d/carbon restart&lt;br&gt;
/etc/init.d/httpd restart&lt;/p&gt;
&lt;h4&gt;Notes&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;django errors&lt;/p&gt;

&lt;p&gt;If you try to start httpd and you see lots of errors, especially this error:&lt;/p&gt;

&lt;p&gt;[Thu Sep 12 12:45:52 2013] [error] IntegrityError: column user_id is not unique&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;You need to update your local_settings.py as noted above.  And anytime you edit local_settings.py you need to rerun your &lt;br&gt;
db sync.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;python &amp;#47;opt&amp;#47;graphite&amp;#47;webapp&amp;#47;graphite&amp;#47;manage.py syncdb&amp;lt;&amp;#47;code&amp;gt;&amp;lt;&amp;#47;pre&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;ol&gt;
&lt;li&gt;&lt;p&gt;You can list all grouped installs via yum&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;yum grouplist&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;&lt;p&gt;Twisted seems to throw this error a lot, it is a python path issue and is a pain to track down and fix.&lt;/p&gt;

&lt;p&gt;exceptions.ImportError: cannot import name _PY3&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://graphite.wikidot.com/getting-your-data-into-graphite&#34;&gt;getting stuff into graphite&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://stackoverflow.com/questions/9850581/django-error-when-installing-graphite-settings-data%0Abases-is-improperly-configu&#34;&gt;django fixup&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.rampmeupscotty.com/blog/2012/08/07/installing-graphite-on-centos-6-dot-2/&#34;&gt;centos 6 walk through&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://gist.github.com/dillera/1634493&#34;&gt;gist based instructions&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>profiling mysql queries</title>
                <link rel="alternate" href="/2013/09/09/profiling-mysql-queries/" type="text/html" />
                <id>/2013/09/09/profiling-mysql-queries/</id>
                <updated>2013-09-09T19:02:00Z</updated>
                
                <summary type="html">MySQL has some native profiling and troubleshootings logs for queries.  Logging of &lt;a href=&#34;http://dev.mysql.com/doc/refman/5.0/en/slow-query-log.html&#34;&gt;slow queries&lt;/a&gt; or even all &lt;a href=&#34;http://dev.mysql.com/doc/refman/5.1/en/query-log.html&#34;&gt;queries&lt;/a&gt; done is possible, but can be a performance hit.  In some instances not having access to the application or permissions within SQL can also be a problem.</summary>
                <content type="html">&lt;p&gt;MySQL has some native profiling and troubleshootings logs for queries.  Logging of &lt;a href=&#34;http://dev.mysql.com/doc/refman/5.0/en/slow-query-log.html&#34;&gt;slow queries&lt;/a&gt; or even all &lt;a href=&#34;http://dev.mysql.com/doc/refman/5.1/en/query-log.html&#34;&gt;queries&lt;/a&gt; done is possible, but can be a performance hit.  In some instances not having access to the application or permissions within SQL can also be a problem.&lt;/p&gt;

&lt;p&gt;You can get some good information using mysqadmin such as a count by query type.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
root@vm:~# mysqladmin ext | grep -e &#39;Com_\(update\|select\|insert\)&#39;
| Com_insert                               | 207         |
| Com_insert_select                        | 0           |
| Com_select                               | 12423       |
| Com_update                               | 71          |
| Com_update_multi                         | 0           |
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you want more details without inteferring with MySQL Percona Tool Kit is a nice idea.&lt;/p&gt;
&lt;h4&gt;Installing Percona Tool kit&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
wget http://www.percona.com/redir/downloads/percona-toolkit/LATEST/deb/percona-toolkit_2.2.4_all.deb
aptitude install libdbd-mysql-perl libdbd-mysql-5.1-perl libterm-readkey-perl libio-socket-ssl-perl
dpkg -i percona-toolkit_2.2.4_all.deb 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Make sure it has the tool we want&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@vm:~# which pt-query-digest
&amp;#47;usr&amp;#47;bin&amp;#47;pt-query-digest
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Capture Query Traffic&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;tcpdump -s 65535 -x -nn -q -tttt -i any port 3306 &amp;gt; mysql.netdump.txt
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Translating Network Dump into MySQL details&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;pt-query-digest --type tcpdump mysql.tcp.txt &amp;gt; dump.log
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Some useful details: ranking of queries by time spent, index ratio, break down of query durations, and a breakout of individual queries.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;hideme&#39;);&#34;&gt;Show Example dump.log Analysis&lt;/a&gt;&lt;/p&gt;

&lt;div id=&#34;hideme&#34; style=&#34;display:none;&#34;&gt;
&lt;pre&gt;&lt;code&gt;
# 600ms user time, 60ms system time, 26.84M rss, 85.55M vsz
# Current date: Mon Sep  9 15:24:54 2013
# Hostname: vm
# Files: mysql.netdump.txt
# Overall: 603 total, 112 unique, 15.68 QPS, 0.01x concurrency ___________
# Time range: 2013-09-09 15:24:07.234666 to 15:24:45.693738
# Attribute          total     min     max     avg     95%  stddev  median
# ============     ======= ======= ======= ======= ======= ======= =======
# Exec time          230ms       0     8ms   380us     1ms   794us   159us
# Rows affecte         105       0       2    0.17    0.99    0.42       0
# Query size       293.92k      14  59.65k  499.14  299.03   4.02k   84.10
# Warning coun          17       0       2    0.03       0    0.17       0
# Boolean:
# No index use   1% yes,  98% no

# Profile
# Rank Query ID           Response time Calls R/Call V/M   Item
# ==== ================== ============= ===== ====== ===== ===============
#    1 0x5D51E5F01B88B79E  0.0368 16.0%    77 0.0005  0.00 ADMIN CONNECT
#    2 0xAD033812F7A933C3  0.0224  9.8%     6 0.0037  0.00 INSERT STUFF1
#    3 0x43777589CE6D9294  0.0135  5.9%     4 0.0034  0.00 SELECT YOUR_STUFF2
#    4 0x1C67569E33078F1D  0.0108  4.7%     6 0.0018  0.00 INSERT YOUR_STUFF3

# Query 1: 2.01 QPS, 0.00x concurrency, ID 0x5D51E5F01B88B79E at byte 985002
# This item is included in the report because it matches --limit.
# Scores: V/M = 0.00
# Time range: 2013-09-09 15:24:07.234666 to 15:24:45.626723
# Attribute    pct   total     min     max     avg     95%  stddev  median
# ============ === ======= ======= ======= ======= ======= ======= =======
# Count         12      77
# Exec time     16    37ms    84us     8ms   477us     1ms   995us   260us
# Rows affecte   0       0       0       0       0       0       0       0
# Query size     0   2.26k      30      30      30      30       0      30
# Warning coun   0       0       0       0       0       0       0       0
# String:
# Databases     (23/29%), mydb (12/15%)... 21 more
# Hosts        127.0.0.1
# Users        you (53/68%), me (15/19%), yourmom (9/11%)
# Query_time distribution
#   1us
#  10us  ######
# 100us  ################################################################
#   1ms  ####
#  10ms
# 100ms
#    1s
#  10s+
administrator command: Connect\G
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.mysqlperformanceblog.com/2007/05/31/mysql-slow-query-log-in-the-table/&#34;&gt;slow log&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.mysqlperformanceblog.com/2008/11/07/poor-mans-query-logging/&#34;&gt;poor mans query log&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.percona.com/software/percona-toolkit&#34;&gt;took kit&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>making sense of squid logs</title>
                <link rel="alternate" href="/2013/09/05/making-sense-of-squid-logs/" type="text/html" />
                <id>/2013/09/05/making-sense-of-squid-logs/</id>
                <updated>2013-09-05T16:38:00Z</updated>
                
                <summary type="html">Squid defaults to logging things using epoch time.  Which can be a pain to decypher if you are in a hurry.</summary>
                <content type="html">&lt;p&gt;Squid defaults to logging things using epoch time.  Which can be a pain to decypher if you are in a hurry.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;1378405786.009      0 127.0.0.1 TCP_DENIED&amp;#47;400 1342 GET NONE:&amp;#47;&amp;#47; - NONE&amp;#47;- text&amp;#47;html
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You see: &lt;strong&gt;1378405786.009&lt;/strong&gt;&lt;br&gt;
It means: &lt;strong&gt;GMT: Thu, 05 Sep 2013 18:29:46 GMT&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Years ago I wrote a &lt;a href=&#34;https://raw.github.com/chasemp/archive/master/parse_squid.py&#34;&gt;script&lt;/a&gt; to handle this on-the-fly as I was looking for information I needed to pass an audit.  In a pinch, on an unfamiliar server, it works.  But it&amp;#39;s not ideal.&lt;/p&gt;

&lt;p&gt;This configuration in /etc/squid/squid.conf makes timestamps natively sane:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;logformat sanelogfrmt %tl.%03tu %6tr %&amp;gt;a %Ss&amp;#47;%03Hs %&amp;lt;st %rm %ru %un %Sh&amp;#47;%&amp;lt;A %mt
access_log &amp;#47;var&amp;#47;log&amp;#47;squid&amp;#47;access.log sanelogfrmt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Looks like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;05&amp;#47;Sep&amp;#47;2013:11:30:46 -0700      0 127.0.0.1 TCP_DENIED&amp;#47;400 1342 \
GET NONE:&amp;#47;&amp;#47; - NONE&amp;#47;- text&amp;#47;html
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;For a nice explaination of the fields in this log see the &lt;a href=&#34;http://trafficserver.apache.org/docs/trunk/admin/working-log-files/log-formats.en.html&#34;&gt;docs&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Some version of squid support the &lt;strong&gt;emulate_httpd_log on&lt;/strong&gt; option as well.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://wiki.squid-cache.org/Features/LogFormat&#34;&gt;squid wiki&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://trafficserver.apache.org/docs/trunk/admin/working-log-files/log-formats.en.html&#34;&gt;docs on format&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://devel.squid-cache.org/customlog/logformat.html&#34;&gt;squid docs on log field options&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://answers.splunk.com/answers/13599/custom-squid-log-format&#34;&gt;splunk doc&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>python urllib2 and https proxy</title>
                <link rel="alternate" href="/2013/08/28/python-urllib2-and-https-proxy/" type="text/html" />
                <id>/2013/08/28/python-urllib2-and-https-proxy/</id>
                <updated>2013-08-28T17:20:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Since urllib2 openers are global I recently had some expected behavior I would like to explore.&lt;/p&gt;
&lt;h4&gt;urllib2, https, and proxies&lt;/h4&gt;
&lt;p&gt;urllib2 does &lt;a href=&#34;http://docs.python.org/2/howto/urllib2.html#id8&#34;&gt;not&lt;/a&gt; support https proxy natively.  There is a nice activestate &lt;a href=&#34;http://code.activestate.com/recipes/456195/&#34;&gt;recipe&lt;/a&gt; for handling it though.&lt;/p&gt;

&lt;p&gt;There is one &lt;a href=&#34;http://sourceforge.net/p/pywebsvcs/bugs/296/&#34;&gt;bug&lt;/a&gt; I ran into.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Time TimeoutSocket fake socket doesn&amp;#39;t have a sendall method \
so you get the above error when using https.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I am saving this module as &lt;a href=&#34;javascript:toggleDiv(&#39;hideme&#39;);&#34;&gt;sslhandler.py&lt;/a&gt;&lt;/p&gt;

&lt;div id=&#34;hideme&#34; style=&#34;display:none;&#34;&gt;
&lt;pre&gt;&lt;code&gt;
import urllib2
import urllib
import httplib
import socket
import ssl


class ProxyHTTPConnection(httplib.HTTPConnection):

    _ports = {&#39;http&#39;: 80, &#39;https&#39;: 443}

    def request(self, method, url, body=None, headers={}):
        #request is called before connect, so can interpret url and get
        #real host/port to be used to make CONNECT request to proxy
        proto, rest = urllib.splittype(url)

        if proto is None:
            raise ValueError(&#34;unknown URL type: %s&#34; % (url,))

        #get host
        host, rest = urllib.splithost(rest)
        #try to get port
        host, port = urllib.splitport(host)
        #if port is not defined try to get from proto
        if port is None:
            try:
                port = self._ports[proto]
            except KeyError:
                raise ValueError(&#34;unknown protocol for: %s&#34; % (url,))

        self._real_host = host
        self._real_port = port
        httplib.HTTPConnection.request(self, method, url, body, headers)

    def connect(self):
        httplib.HTTPConnection.connect(self)
        #send proxy CONNECT request
        self.send(&#34;CONNECT %s:%d HTTP/1.0\r\n\r\n&#34; % (self._real_host, self._real_port))
        #expect a HTTP/1.0 200 Connection established
        response = self.response_class(self.sock, strict=self.strict, method=self._method)
        (version, code, message) = response._read_status()
        #probably here we can handle auth requests...
        if code != 200:
            #proxy returned and error, abort connection, and raise exception
            self.close()
            raise socket.error, &#34;Proxy connection failed: %d %s&#34; % (code, message.strip())
        #eat up header block from proxy....
        while True:
            #should not use directly fp probablu
            line = response.fp.readline()
            if line == &#39;\r\n&#39;:
                break


class ProxyHTTPSConnection(ProxyHTTPConnection):

    default_port = 443

    def __init__(self, host, port=None, key_file=None, cert_file=None, strict=None, timeout=&#39;30&#39;):
        ProxyHTTPConnection.__init__(self, host, port)
        self.key_file = key_file
        self.cert_file = cert_file

    def connect(self):
        ProxyHTTPConnection.connect(self)
        #make the sock ssl-aware
        self.sock = ssl.wrap_socket(self.sock, self.key_file, self.cert_file)


class ConnectHTTPHandler(urllib2.HTTPHandler):

    def do_open(self, http_class, req):
        return urllib2.HTTPHandler.do_open(self, ProxyHTTPConnection, req)


class ConnectHTTPSHandler(urllib2.HTTPSHandler):

    def do_open(self, http_class, req):
        return urllib2.HTTPSHandler.do_open(self, ProxyHTTPSConnection, req)
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h4&gt;Making normal non-proxy post&lt;/h4&gt;
&lt;p&gt;This is a post with generic data as the payload&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import json
import urllib2
import os 

def post(url, trail, **kwargs):
    #posting key with None values is not received well better to strip them
    data = json.dumps(dict((k, v) for k, v in kwargs.iteritems() if v is not None))
    req = urllib2.Request(url + trail, data, {&#39;Content-Type&#39;: &#39;application/json&#39;})
    f = urllib2.urlopen(req)
    response = f.read()
    f.close()
    return json.loads(response)

if __name__ == &#39;__main__&#39;:
    print post(&#39;http://localhost&#39;, &#39;/info&#39;, {&#39;data&#39;: &#39;value&#39;})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is sufficient for making a post to a local REST API.&lt;/p&gt;

&lt;p&gt;I am saving this file as &lt;strong&gt;basic.py&lt;/strong&gt;.&lt;/p&gt;
&lt;h4&gt;Making a request through the proxy using our https opener&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
import urllib2
from sslhandler import ConnectHTTPHandler, ConnectHTTPSHandler

def request(url, trail):
    opener = urllib2.build_opener(ConnectHTTPHandler, ConnectHTTPSHandler)
    urllib2.install_opener(opener)
    req = urllib2.Request(url=url + trail)
    proxy = &#39;ourproxy.com:8000&#39;
    req.set_proxy(proxy, &#39;https&#39;)
    return urllib2.urlopen(req).read()

if __name__ == &#39;__main__&#39;:
    print request(&#39;https://remotehost&#39;, &#39;/info&#39;)
&lt;/pre&gt;&lt;/code&gt;

This uses our urllib2 opener to connect through a proxy using the CONNECT method

I am saving this file as __proxied.py__.

#### Now let&amp;rsquo;s say there is a job that calls both.

We have three files:

    sslhandler.py
    basic.py
    proxied.py

We will make two scripts that call both of these and see what happens.

##### First script&amp;hellip;

&lt;pre&gt;&lt;code&gt;
from basic import post
from proxied import request
print post(&#39;http://localhost&#39;, &#39;/info&#39;, {&#39;data&#39;: &#39;value&#39;})
print request(&#39;https://remotehost&#39;, &#39;/info&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;example output:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#echoed
{&#39;data&#39;: &#39;value&#39;}
#string response
hello!
&lt;/code&gt;&lt;/pre&gt;
&lt;h5&gt;Second script&amp;hellip;&lt;/h5&gt;
&lt;pre&gt;&lt;code&gt;
from basic import post
from proxied import request
print request(&#39;https://remotehost&#39;, &#39;/info&#39;)
print post(&#39;http://localhost&#39;, &#39;/info&#39;, {&#39;data&#39;: &#39;value&#39;})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;example output:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
hello!
Traceback (most recent call last):
  File &#34;sslhandler.py&#34;, line 93, in &lt;module&gt;
    f = urllib2.urlopen(req)
  File &#34;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py&#34;, \
    line 126, in urlopen
    return _opener.open(url, data, timeout)
  File &#34;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py&#34;, \
    line 394, in open
    response = self._open(req, data)
  File &#34;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py&#34;, \
    line 412, in _open
    &#39;_open&#39;, req)
  File &#34;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py&#34;, \
    line 372, in _call_chain
    result = func(*args)
  File &#34;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py&#34;, \
    line 1207, in https_open
    return self.do_open(httplib.HTTPSConnection, req)
  File &#34;sslhandler.py&#34;, line 84, in do_open
    return urllib2.HTTPSHandler.do_open(self, ProxyHTTPSConnection, req)
  File &#34;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib2.py&#34;, \
    line 1174, in do_open
    raise URLError(err)
urllib2.URLError: &lt;urlopen error [Errno 61] Connection refused&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Our local call failed and the remote one succeeded when we reversed them.&lt;/p&gt;
&lt;h4&gt;Why does urllib2 hate me?&lt;/h4&gt;
&lt;p&gt;The basic idea here is when the basic post is the first directive everything is fine, but if we make the proxy request first then both try to use the proxy.&lt;/p&gt;

&lt;p&gt;This a product of the urllib2 &lt;a href=&#34;http://docs.python.org/2/library/urllib2.html#urllib2.install_opener&#34;&gt;opener&lt;/a&gt; being global.  Even though these are two libraries the way import handles arranging resources both are calling the same instance of urllib2.&lt;/p&gt;

&lt;p&gt;So I can&amp;#39;t install my proxy opener and call urllib2 without using it&lt;/p&gt;
&lt;h4&gt;Solution 1&lt;/h4&gt;
&lt;p&gt;We can build our opener and use it without &lt;strong&gt;installing&lt;/strong&gt; it.&lt;/p&gt;

&lt;p&gt;We need to change &lt;strong&gt;proxied.py&lt;/strong&gt; &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import urllib2
from sslhandler import ConnectHTTPHandler, ConnectHTTPSHandler

def request(url, trail):
    proxyhandler = urllib2.build_opener(ConnectHTTPHandler, ConnectHTTPSHandler)
    req = urllib2.Request(url=url + trail)
    proxy = &#39;ourproxy.com:8000&#39;
    req.set_proxy(proxy, &#39;https&#39;)
    return proxyhandler.open(req).read()

if __name__ == &#39;__main__&#39;:
    print request(&#39;https://remotehost&#39;, &#39;/info&#39;)
&lt;/pre&gt;&lt;/code&gt;

Now we are not changing the state of the global urllib2 handler so all is well.

&lt;pre&gt;&lt;code&gt;
from basic import post
from proxied import request
print request(&#39;https://remotehost&#39;, &#39;/info&#39;)
print post(&#39;http://localhost&#39;, &#39;/info&#39;, {&#39;data&#39;: &#39;value&#39;})
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Works:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#string response
hello!
#echoed
{&#39;data&#39;: &#39;value&#39;}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Solution 2&lt;/h4&gt;
&lt;p&gt;We can reset the state of urllib2 by reloading the module.  This is not the ideal&lt;br&gt;
solution, and is certainly heavy handed but it is demonstrative.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
from sslhandler import ConnectHTTPHandler, ConnectHTTPSHandler

def request(url, trail):
    import urllib2
    opener = urllib2.build_opener(ConnectHTTPHandler, ConnectHTTPSHandler)
    urllib2.install_opener(opener)
    req = urllib2.Request(url=url + trail)
    proxy = &#39;ourproxy.com:8000&#39;
    req.set_proxy(proxy, &#39;https&#39;)
    urllib2 = reload(urllib2)
    return urllib2.urlopen(req).read()

if __name__ == &#39;__main__&#39;:
    print request(&#39;https://remotehost&#39;, &#39;/info&#39;)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Works:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#string response
hello!
#echoed
{&#39;data&#39;: &#39;value&#39;}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Solution 3&lt;/h4&gt;
&lt;p&gt;use the &lt;a href=&#34;http://www.python-requests.org/en/latest/&#34;&gt;requests&lt;/a&gt; module.&lt;/p&gt;

&lt;p&gt;Not a full example but you get the idea.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
https_proxy = &#34;10.10.1.11:1080&#34;

proxies = { 
              &#34;https&#34; : https_proxy, 
            }

r = requests.get(&#39;https://remotehost/info&#39;, proxies=proxies)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Conclusion&lt;/h4&gt;
&lt;p&gt;I like the requests module.&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://code.activestate.com/recipes/456195/&#34;&gt;SSl proxy&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.python.org/2/library/urllib2.html&#34;&gt;urllib2 docs&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>vmware fusion nix shared folders</title>
                <link rel="alternate" href="/2013/08/28/vmware-fusion-nix-shared-folders/" type="text/html" />
                <id>/2013/08/28/vmware-fusion-nix-shared-folders/</id>
                <updated>2013-08-28T15:48:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Installing tools in your VM&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install open-vm-tools
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Setting up your Share in VMWare&lt;/h4&gt;
&lt;p&gt;Go to your VM Settings page =&amp;gt; Sharing =&amp;gt; +(add new share) =&amp;gt; &amp;#39;shared&amp;#39;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/vmwareshared/vmwareshared.png&#34; alt=&#34;vmwareshared&#34;&gt;&lt;/p&gt;
&lt;h4&gt;Mount your share&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;cd &amp;#47;mnt&amp;#47;
mkdir ops
sudo mount -t vmhgfs .host:&amp;#47;ops &amp;#47;mnt&amp;#47;ops
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;References&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.howtogeek.com/howto/ubuntu/how-to-share-folders-with-your-ubuntu-virtual-machine-guest/&#34;&gt;howto geek&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://askubuntu.com/questions/29284/how-do-i-mount-shared-folders-win7-host-in-ubuntu-guest-using-vmwaretools-v&#34;&gt;ask ubuntu&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>making debs from php pecl</title>
                <link rel="alternate" href="/2013/08/22/making-debs-from-php-pecl/" type="text/html" />
                <id>/2013/08/22/making-debs-from-php-pecl/</id>
                <updated>2013-08-22T21:44:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Bending PECL to your deb building will.&lt;/p&gt;
&lt;h4&gt;Installing Packages&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;apt-get install dh-make-php \
                php5-dev \
                build-essential \
                libmagic-dev \
                debhelper \
                buildpackage
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Example 1&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
git clone https://github.com/php-test-helpers/php-test-helpers.git
cd php-test-helpers/
phpize
./configure
make
make test
make install
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Example 2&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
pecl download phpunit/test_helpers
dh-make-pecl --maintainer &#34;Your Name &lt;me@example.com&gt;&#34; --arch amd64 test_helpers-1.1.0.tgz 
cd php-test-helpers-1.1.0/ &amp;&amp; ./debian/rules binary
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.mabishu.com/blog/2011/03/20/how-to-easily-create-debian-packages-for-php-extensions/&#34;&gt;pecl howto&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.dotdeb.org/2008/09/25/how-to-package-php-extensions-by-yourself/&#34;&gt;php extension howto&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://manpages.ubuntu.com/manpages/lucid/man1/dh-make-pear.1.html&#34;&gt;dh-make-pear&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://manpages.ubuntu.com/manpages/raring/man1/debpear.1.html&#34;&gt;debpear man&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://pear.phpunit.de/&#34;&gt;pear channel&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/php-test-helpers/php-test-helpers&#34;&gt;test-helpers gh&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>packaging R modules for debian</title>
                <link rel="alternate" href="/2013/08/21/packaging-R-modules-for-debian/" type="text/html" />
                <id>/2013/08/21/packaging-R-modules-for-debian/</id>
                <updated>2013-08-21T21:44:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;R is a well known statistics language and ecosystem.  Some of the more common extensions to it are available in the Debian repo&amp;#39;s but not all.&lt;/p&gt;
&lt;h4&gt;Install on a test VM&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install -y r-base fakeroot dpkg-deb build-essential
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This will result in a lot of dependency packages so site back for a bit.&lt;/p&gt;
&lt;h4&gt;Getting your module&lt;/h4&gt;
&lt;p&gt;R has something akin to CPAN or PyPI that we can use to grab our module&lt;/p&gt;

&lt;p&gt;Drop into R shell&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;me@vm:~# R
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
R version 2.15.1 (2012-06-22) -- &#34;Roasted Marshmallows&#34;
Copyright (C) 2012 The R Foundation for Statistical Computing
ISBN 3-900051-07-0
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type &#39;license()&#39; or &#39;licence()&#39; for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type &#39;contributors()&#39; for more information and
&#39;citation()&#39; on how to cite R or R packages in publications.

Type &#39;demo()&#39; for some demos, &#39;help()&#39; for on-line help, or
&#39;help.start()&#39; for an HTML browser interface to help.
Type &#39;q()&#39; to quit R.

&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This will download and compile the rsvgdevice module&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;utils::install.packages(c(&amp;#39;RSvgDevice&amp;#39;));
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Installing package(s) into ‘/usr/local/lib/R/site-library’
(as ‘lib’ is unspecified)
trying URL &#39;http://rweb.quant.ku.edu/cran/src/contrib/RSvgDevice_0.6.4.3.tar.gz&#39;
Content type &#39;application/x-gzip&#39; length 8710 bytes
opened URL
==================================================
downloaded 8710 bytes

* installing *source* package ‘RSvgDevice’ ...
** package ‘RSvgDevice’ successfully unpacked and MD5 sums checked
** libs
gcc -std=gnu99 -I/usr/share/R/include -DNDEBUG      -fpic  -O2 -pipe -g  -c devSVG.c -o devSVG.o
gcc -std=gnu99 -shared -o RSvgDevice.so devSVG.o -L/usr/lib/R/lib -lR
installing to /usr/local/lib/R/site-library/RSvgDevice/libs
** R
** preparing package for lazy loading
** help
*** installing help indices
** building package indices
** testing if installed package can be loaded

* DONE (RSvgDevice)

The downloaded source packages are in
    ‘/tmp/RtmpTMUZS0/downloaded_packages’
&gt; quit()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Your library is in /usr/local/lib/R/site-library/&lt;/p&gt;
&lt;h4&gt;Prepping your package&lt;/h4&gt;
&lt;p&gt;We are going to make a package named r-spec-rsvgdevice&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mkdir -p r-spec-rsvgdevice&amp;#47;src&amp;#47;usr&amp;#47;local&amp;#47;lib&amp;#47;R&amp;#47;site-library&amp;#47;
cd r-spec-rsvgdevice
mkdir -p .&amp;#47;src&amp;#47;DEBIAN&amp;#47;
cp -R &amp;#47;src&amp;#47;usr&amp;#47;local&amp;#47;lib&amp;#47;R&amp;#47;site-library&amp;#47;RSvgDevice .&amp;#47;src&amp;#47;usr&amp;#47;local&amp;#47;lib&amp;#47;R&amp;#47;site-library&amp;#47;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Making your control file&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;vim .&amp;#47;src&amp;#47;DEBIAN&amp;#47;CONTROL
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Package: r-spec-rsvgdevice
Priority: optional
Section: misc
Maintainer: You you@you.com
Architecture: all
Version: 0.6.4.3
Homepage: http://cran.r-project.org/web/packages/RSvgDevice/index.html
Description: svgdevice
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Building your package&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
mkdir r-spec-rsvgdevice_0.6.4.3_all
cp -R src/* r-spec-rsvgdevice_0.6.4.3_all
fakeroot dpkg-deb -b r-spec-rsvgdevice_0.6.4.3_all
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;dpkg-deb: building package `r-spec-rsvgdevice&amp;#39; in `r-spec-rsvgdevice_0.6.4.3_all.deb&amp;#39;.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Installing&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;dpkg -i r-spec-rsvgdevice_0.6.4.3_all.deb 
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Selecting previously unselected package r-spec-rsvgdevice.
(Reading database ... 52624 files and directories currently installed.)
Unpacking r-spec-rsvgdevice (from r-spec-rsvgdevice_0.6.4.3_all.deb) ...
Setting up r-spec-rsvgdevice (0.6.4.3) ...
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Verifying Installation&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
#R
R&gt;
&gt; library()

Packages in library ‘/usr/local/lib/R/site-library’:

RSvgDevice              An R SVG graphics device.
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>asa hairpinning</title>
                <link rel="alternate" href="/2013/08/20/asa-hairpinning/" type="text/html" />
                <id>/2013/08/20/asa-hairpinning/</id>
                <updated>2013-08-20T21:44:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Hairpinning is when you exit a firewall on the via on the same interface you terminate a VPN.  Essentially, you usually establish a dynamic tunnel on the external interface and that same external interface has L2L tunnels established that you need to go over.  Hairpinning is making a U-Turn.&lt;/p&gt;
&lt;h4&gt;Diagram&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;/assets/images/hairpinning.png&#34; alt=&#34;hairpinning&#34;&gt;&lt;/p&gt;
&lt;h4&gt;Making sure my RA VPN users get the route&lt;/h4&gt;
&lt;p&gt;I am adding the network for FW2 to the split tunnel ACL on FW1.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FW1(config)# access-list SPLITTUN standard permit 10.10.0.0 255.255.0.0  
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Making sure traffic that comes in the outside interface and leave it&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;FW1(config)#same-security-traffic permit intra-interface
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Making sure NAT is handled&lt;/h4&gt;
&lt;p&gt;In my case I want to exclude NAT for these hosts as it is not required.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
nat (Outside,Outside) source static NETWORK_OBJ_10.0.16.0/24 \
                             NETWORK_OBJ_10.0.16.0/24 \
                             destination static FW2_HOSTS_10.10.0.0_24 \
                             FW2_HOSTS_10.10.0.0_24
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notice that &lt;em&gt;(Outside, Outside)&lt;/em&gt; for hairpinning.&lt;/p&gt;
&lt;h4&gt;packet tracer&lt;/h4&gt;
&lt;p&gt;Showing the traffic flow.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;FW1(config)# packet-tracer input outside tcp 10.0.16.70 http 10.10.0.4 http
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;hideme&#39;);&#34;&gt;Show packet-tracer&lt;/a&gt;&lt;br&gt;
&lt;div id=&#34;hideme&#34; style=&#34;display:none;&#34;&gt;&lt;br&gt;
&lt;pre&gt;&lt;code&gt;&lt;br&gt;
Phase: 1&lt;br&gt;
Type: ACCESS-LIST&lt;br&gt;
Subtype: log&lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
access-group Outside_access_in in interface Outside&lt;br&gt;
access-list Outside_access_in extended permit tcp any any eq www &lt;br&gt;
Additional Information:&lt;br&gt;
 Forward Flow based lookup yields rule:&lt;br&gt;
 in  id=0xacdc0680, priority=13, domain=permit, deny=false&lt;br&gt;
    hits=626508, user_data=0xa90df480, cs_id=0x0, use_real_addr, flags=0x0, protocol=6&lt;br&gt;
    src ip/id=0.0.0.0, mask=0.0.0.0, port=0&lt;br&gt;
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=80, dscp=0x0&lt;br&gt;
    input_ifc=Outside, output_ifc=any&lt;/p&gt;

&lt;p&gt;Phase: 2&lt;br&gt;
Type: IP-OPTIONS&lt;br&gt;
Subtype: &lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Forward Flow based lookup yields rule:&lt;br&gt;
 in  id=0xacc20be8, priority=0, domain=inspect-ip-options, deny=true&lt;br&gt;
    hits=7983735, user_data=0x0, cs_id=0x0, reverse, flags=0x0, protocol=0&lt;br&gt;
        src ip/id=0.0.0.0, mask=0.0.0.0, port=0&lt;br&gt;
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=0, dscp=0x0&lt;br&gt;
    input_ifc=Outside, output_ifc=any&lt;/p&gt;

&lt;p&gt;Phase: 3&lt;br&gt;
Type: CP-PUNT&lt;br&gt;
Subtype: &lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Forward Flow based lookup yields rule:&lt;br&gt;
 in  id=0xad356ee0, priority=89, domain=punt, deny=true&lt;br&gt;
    hits=89, user_data=0xac768378, cs_id=0x0, flags=0x0, protocol=0&lt;br&gt;
    src ip/id=10.0.16.70, mask=255.255.255.255, port=0&lt;br&gt;
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=0, dscp=0x0&lt;br&gt;
    input_ifc=Outside, output_ifc=any&lt;/p&gt;

&lt;p&gt;Phase: 4&lt;br&gt;
Type: ACCESS-LIST&lt;br&gt;
Subtype: vpn-user&lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Forward Flow based lookup yields rule:&lt;br&gt;
 in  id=0xadb9fea8, priority=13, domain=vpn-user, deny=false&lt;br&gt;
    hits=22, user_data=0xa90dd600, filter_id=0xa(RACL-ADMIN), protocol=0&lt;br&gt;
    src ip=0.0.0.0, mask=0.0.0.0, port=0&lt;br&gt;
    dst ip=0.0.0.0, mask=0.0.0.0, port=0&lt;/p&gt;

&lt;p&gt;Phase: 5&lt;br&gt;
Type: VPN&lt;br&gt;
Subtype: ipsec-tunnel-flow&lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Forward Flow based lookup yields rule:&lt;br&gt;
 in  id=0xadba0308, priority=69, domain=ipsec-tunnel-flow, deny=false&lt;br&gt;
    hits=89, user_data=0xd93c504, cs_id=0x0, reverse, flags=0x0, protocol=0&lt;br&gt;
    src ip/id=10.0.16.70, mask=255.255.255.255, port=0&lt;br&gt;
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=0, dscp=0x0&lt;br&gt;
    input_ifc=Outside, output_ifc=any&lt;/p&gt;

&lt;p&gt;Phase: 6&lt;br&gt;
Type: FOVER&lt;br&gt;
Subtype: standby-update&lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Forward Flow based lookup yields rule:&lt;br&gt;
 in  id=0xacd15e28, priority=20, domain=lu, deny=false&lt;br&gt;
    hits=2767281, user_data=0x0, cs_id=0x0, flags=0x0, protocol=6&lt;br&gt;
    src ip/id=0.0.0.0, mask=0.0.0.0, port=0&lt;br&gt;
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=0, dscp=0x0&lt;br&gt;
    input_ifc=Outside, output_ifc=any&lt;/p&gt;

&lt;p&gt;Phase: 7&lt;br&gt;
Type: NAT&lt;br&gt;
Subtype: &lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
nat (Outside,Outside) source static NETWORK_OBJ_10.0.16.0/24 \&lt;br&gt;
                                    NETWORK_OBJ_10.0.16.0/24 \&lt;br&gt;
                                    destination static FW2_HOSTS_10.10.0.0_24 \&lt;br&gt;
                                    FW2_HOSTS_10.10.0.0_24&lt;br&gt;
Additional Information:&lt;br&gt;
Static translate 10.0.16.70/80 to 10.0.16.70/80&lt;br&gt;
 Forward Flow based lookup yields rule:&lt;br&gt;
 in  id=0xad3af9c0, priority=6, domain=nat, deny=false&lt;br&gt;
    hits=422, user_data=0xadc36ad0, cs_id=0x0, use_real_addr, flags=0x0, protocol=0&lt;br&gt;
    src ip/id=10.1.6.0, mask=255.255.255.0, port=0&lt;br&gt;
    dst ip/id=10.2.1.0, mask=255.255.255.0, port=0, dscp=0x0&lt;br&gt;
    input_ifc=Outside, output_ifc=Outside&lt;/p&gt;

&lt;p&gt;Phase: 8&lt;br&gt;
Type: VPN&lt;br&gt;
Subtype: encrypt&lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Forward Flow based lookup yields rule:&lt;br&gt;
 out id=0xad379f08, priority=70, domain=encrypt, deny=false&lt;br&gt;
    hits=2, user_data=0xd94f6c4, cs_id=0xacdbae48, reverse, flags=0x0, protocol=0&lt;br&gt;
    src ip/id=10.1.0.0, mask=255.255.0.0, port=0&lt;br&gt;
    dst ip/id=10.2.1.0, mask=255.255.255.0, port=0, dscp=0x0&lt;br&gt;
    input_ifc=any, output_ifc=Outside&lt;/p&gt;

&lt;p&gt;Phase: 9&lt;br&gt;
Type: VPN&lt;br&gt;
Subtype: ipsec-tunnel-flow&lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Reverse Flow based lookup yields rule:&lt;br&gt;
 in  id=0xac882b98, priority=69, domain=ipsec-tunnel-flow, deny=false&lt;br&gt;
    hits=2, user_data=0xd950a5c, cs_id=0x0, reverse, flags=0x0, protocol=0&lt;br&gt;
    src ip/id=10.2.1.0, mask=255.255.255.0, port=0&lt;br&gt;
    dst ip/id=10.1.0.0, mask=255.255.0.0, port=0, dscp=0x0&lt;br&gt;
    input_ifc=Outside, output_ifc=any&lt;/p&gt;

&lt;p&gt;Phase: 10&lt;br&gt;&lt;br&gt;
Type: IP-OPTIONS&lt;br&gt;
Subtype: &lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Reverse Flow based lookup yields rule:&lt;br&gt;
 in  id=0xacc20be8, priority=0, domain=inspect-ip-options, deny=true&lt;br&gt;
    hits=7983737, user_data=0x0, cs_id=0x0, reverse, flags=0x0, protocol=0&lt;br&gt;
    src ip/id=0.0.0.0, mask=0.0.0.0, port=0&lt;br&gt;
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=0, dscp=0x0&lt;br&gt;
    input_ifc=Outside, output_ifc=any&lt;/p&gt;

&lt;p&gt;Phase: 11&lt;br&gt;
Type: VPN&lt;br&gt;
Subtype: encrypt&lt;br&gt;
Result: ALLOW&lt;br&gt;
Config:&lt;br&gt;
Additional Information:&lt;br&gt;
 Reverse Flow based lookup yields rule:&lt;br&gt;
 out id=0xae4af120, priority=70, domain=encrypt, deny=false&lt;br&gt;
    hits=88, user_data=0xd93b30c, cs_id=0x0, reverse, flags=0x0, protocol=0&lt;br&gt;
    src ip/id=0.0.0.0, mask=0.0.0.0, port=0&lt;br&gt;
    dst ip/id=10.0.16.70, mask=255.255.255.255, port=0, dscp=0x0&lt;br&gt;
        input_ifc=any, output_ifc=Outside&lt;/p&gt;

&lt;p&gt;Result:&lt;br&gt;
input-interface: Outside&lt;br&gt;
input-status: up&lt;br&gt;
input-line-status: up&lt;br&gt;
Action: allow&lt;br&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;br&gt;
&lt;/div&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>ios diff run and start</title>
                <link rel="alternate" href="/2013/08/19/ios-diff-run-and-start/" type="text/html" />
                <id>/2013/08/19/ios-diff-run-and-start/</id>
                <updated>2013-08-19T17:23:00Z</updated>
                
                <summary type="html">Archive is incredibly useful for IOS and IOS-XE.  One of the things I have always wanted since starting into the Cisco world is a way to diff the start and running configuration.</summary>
                <content type="html">&lt;p&gt;Archive is incredibly useful for IOS and IOS-XE.  One of the things I have always wanted since starting into the Cisco world is a way to diff the start and running configuration.&lt;/p&gt;

&lt;p&gt;Now I have it.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;show archive config diff
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
+router bgp 100
+network 10.0.0.0 255.0.0.0
int gi0/0/0
+shutdown
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://learningnetwork.cisco.com/thread/38330&#34;&gt;cisco forums&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>site loadtesting wrk</title>
                <link rel="alternate" href="/2013/08/16/site-loadtesting-wrk/" type="text/html" />
                <id>/2013/08/16/site-loadtesting-wrk/</id>
                <updated>2013-08-16T21:44:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Although tools like &lt;a href=&#34;http://httpd.apache.org/docs/2.2/programs/ab.html&#34;&gt;ab&lt;/a&gt; and &lt;a href=&#34;http://www.joedog.org/siege-home/&#34;&gt;siege&lt;/a&gt; are common place wrk seems really interesting.&lt;/p&gt;
&lt;h4&gt;Installing&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;git clone https:&amp;#47;&amp;#47;github.com&amp;#47;wg&amp;#47;wrk.git
aptitude update
aptitude install -y build-essential libssl-dev
cd wrk

make
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/wrk.o src/wrk.c
src/wrk.c: In function ‘format_request’:
src/wrk.c:478:9: warning: implicit declaration of function ‘strncasecmp’ [-Wimplicit-function-declaration]
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/net.o src/net.c
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/ssl.o src/ssl.c
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/aprintf.o src/aprintf.c
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/stats.o src/stats.c
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/units.o src/units.c
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/ae.o src/ae.c
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/zmalloc.o src/zmalloc.c
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/http_parser.o src/http_parser.c
cc -std=c99 -Wall -O2 -D_REENTRANT -c -o obj/tinymt64.o src/tinymt64.c
cc  -o wrk obj/wrk.o obj/net.o obj/ssl.o obj/aprintf.o obj/stats.o \
obj/units.o obj/ae.o obj/zmalloc.o obj/http_parser.o obj/tinymt64.o -lpthread -lm -lcrypto -lssl
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Source host specfications&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;cpuspecs&#39;);&#34;&gt;Show CPU Specs&lt;/a&gt;&lt;/p&gt;

&lt;div id=&#34;cpuspecs&#34; style=&#34;display:none;&#34;&gt;
&lt;pre&gt;&lt;code&gt;
processor       : 0
vendor_id       : GenuineIntel
cpu family      : 6
model           : 15
model name      : Intel(R) Xeon(R) CPU            5130  @ 2.00GHz
stepping        : 6
microcode       : 0xc6
cpu MHz         : 2000.020
cache size      : 4096 KB
physical id     : 0
siblings        : 2
core id         : 0
cpu cores       : 2
apicid          : 0
initial apicid  : 0
fpu             : yes
fpu_exception   : yes
cpuid level     : 10
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx lm constant_tsc arch_perfmon pebs bts rep_good nopl aperfmperf pni dtes64 monitor ds_cpl vmx tm2 ssse3 cx16 xtpr pdcm dca lahf_lm dtherm tpr_shadow
bogomips        : 4000.04
clflush size    : 64
cache_alignment : 64
address sizes   : 36 bits physical, 48 bits virtual
power management:

processor       : 1
vendor_id       : GenuineIntel
cpu family      : 6
model           : 15
model name      : Intel(R) Xeon(R) CPU            5130  @ 2.00GHz
stepping        : 6
microcode       : 0xc6
cpu MHz         : 2000.020
cache size      : 4096 KB
physical id     : 3
siblings        : 2
core id         : 0
cpu cores       : 2
apicid          : 6
initial apicid  : 6
fpu             : yes
fpu_exception   : yes
cpuid level     : 10
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx lm constant_tsc arch_perfmon pebs bts rep_good nopl aperfmperf pni dtes64 monitor ds_cpl vmx tm2 ssse3 cx16 xtpr pdcm dca lahf_lm dtherm tpr_shadow
bogomips        : 4000.48
clflush size    : 64
cache_alignment : 64
address sizes   : 36 bits physical, 48 bits virtual
power management:

processor       : 2
vendor_id       : GenuineIntel
cpu family      : 6
model           : 15
model name      : Intel(R) Xeon(R) CPU            5130  @ 2.00GHz
stepping        : 6
microcode       : 0xc6
cpu MHz         : 2000.020
cache size      : 4096 KB
physical id     : 0
siblings        : 2
core id         : 1
cpu cores       : 2
apicid          : 1
initial apicid  : 1
fpu             : yes
fpu_exception   : yes
cpuid level     : 10
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx lm constant_tsc arch_perfmon pebs bts rep_good nopl aperfmperf pni dtes64 monitor ds_cpl vmx tm2 ssse3 cx16 xtpr pdcm dca lahf_lm dtherm tpr_shadow
bogomips        : 4000.48
clflush size    : 64
cache_alignment : 64
address sizes   : 36 bits physical, 48 bits virtual
power management:

processor       : 3
vendor_id       : GenuineIntel
cpu family      : 6
model           : 15
model name      : Intel(R) Xeon(R) CPU            5130  @ 2.00GHz
stepping        : 6
microcode       : 0xc6
cpu MHz         : 2000.020
cache size      : 4096 KB
physical id     : 3
siblings        : 2
core id         : 1
cpu cores       : 2
apicid          : 7
initial apicid  : 7
fpu             : yes
fpu_exception   : yes
cpuid level     : 10
wp              : yes
flags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe syscall nx lm constant_tsc arch_perfmon pebs bts rep_good nopl aperfmperf pni dtes64 monitor ds_cpl vmx tm2 ssse3 cx16 xtpr pdcm dca lahf_lm dtherm tpr_shadow
bogomips        : 4000.46
clflush size    : 64
cache_alignment : 64
address sizes   : 36 bits physical, 48 bits virtual
power management:
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;memspecs&#39;);&#34;&gt;Show Mem Specs&lt;/a&gt;&lt;/p&gt;

&lt;div id=&#34;memspecs&#34; style=&#34;display:none;&#34;&gt;
&lt;pre&gt;&lt;code&gt;
MemTotal:       16473572 kB
MemFree:        16194832 kB
Buffers:             652 kB
Cached:            74176 kB
SwapCached:            0 kB
Active:           143896 kB
Inactive:          46656 kB
Active(anon):     115776 kB
Inactive(anon):      144 kB
Active(file):      28120 kB
Inactive(file):    46512 kB
Unevictable:           0 kB
Mlocked:               0 kB
SwapTotal:             0 kB
SwapFree:              0 kB
Dirty:                16 kB
Writeback:             0 kB
AnonPages:        115752 kB
Mapped:            12160 kB
Shmem:               196 kB
Slab:              31552 kB
SReclaimable:      20640 kB
SUnreclaim:        10912 kB
KernelStack:         720 kB
PageTables:         2460 kB
NFS_Unstable:          0 kB
Bounce:                0 kB
WritebackTmp:          0 kB
CommitLimit:     8236784 kB
Committed_AS:     188232 kB
VmallocTotal:   34359738367 kB
VmallocUsed:       49480 kB
VmallocChunk:   34359686268 kB
HardwareCorrupted:     0 kB
AnonHugePages:         0 kB
HugePages_Total:       0
HugePages_Free:        0
HugePages_Rsvd:        0
HugePages_Surp:        0
Hugepagesize:       2048 kB
DirectMap4k:       50560 kB
DirectMap2M:    16726016 kB
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;This server has a 1 Gig Intel NIC.&lt;/p&gt;
&lt;h4&gt;wrk usage&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
Usage: wrk &lt;options&gt; &lt;url&gt;                            
  Options:                                            
    -c, --connections &lt;N&gt;  Connections to keep open   
    -d, --duration    &lt;T&gt;  Duration of test           
    -t, --threads     &lt;N&gt;  Number of threads to use   
                                                      
    -H, --header      &lt;H&gt;  Add header to request      
    -M, --method      &lt;M&gt;  HTTP method                
        --body        &lt;B&gt;  Request body               
        --latency          Print latency statistics   
        --timeout     &lt;T&gt;  Socket/request timeout     
    -v, --version          Print version details      
                                                      
  Numeric arguments may include a SI unit (1k, 1M, 1G)
  Time arguments may include a time unit (2s, 2m, 2h)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;WRK test: 1&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@box:~&amp;#47;wrk# .&amp;#47;wrk -c 100 -d 60 -t 30 http:&amp;#47;&amp;#47;webdos
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/assets/images/wrk/wrk1load.png&#34; alt=&#34;diagram&#34; title=&#34;wrk1load&#34;&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Running 1m test @ http://webdos
  30 threads and 100 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     5.09s     6.81s   25.97s    86.54%
    Req/Sec   328.61    826.17     8.22k    87.67%
  560450 requests in 1.01m, 245.83MB read
  Socket errors: connect 0, read 8, write 0, timeout 821
Requests/sec:   9263.04
Transfer/sec:      4.06MB
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Minimal load all around.  Less than 1.0 in top.  Htop shows 20% CPU and &lt;br&gt;
a small memory footprint.&lt;/p&gt;
&lt;h4&gt;WRK test: 2&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@box:~&amp;#47;wrk# .&amp;#47;wrk -c 1000 -d 60 -t 300 http:&amp;#47;&amp;#47;webdos
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/assets/images/wrk/wrk2cpu.png&#34; alt=&#34;diagram&#34; title=&#34;wrk2cpu&#34;&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Running 1m test @ http://webdos
  300 threads and 1000 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     9.63s     5.14s   25.99s    84.13%
    Req/Sec    51.22    292.17     7.44k    95.93%
  538639 requests in 1.00m, 236.26MB read
  Socket errors: connect 0, read 808, write 0, timeout 23144
Requests/sec:   8974.12
Transfer/sec:      3.94MB
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Load kicks up to 1.5-ish, and CPU hovers around 40-45%.  Memory&lt;br&gt;
footprint stills manageable.&lt;/p&gt;
&lt;h4&gt;WRK test: 3&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@box:~&amp;#47;wrk# .&amp;#47;wrk -c 10000 -d 60 -t 1000 http:&amp;#47;&amp;#47;webdos
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;/assets/images/wrk/wrk3cpu.png&#34; alt=&#34;diagram&#34; title=&#34;wrk3cpu&#34;&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Running 1m test @ http://webdos
  1000 threads and 10000 connections
  Thread Stats   Avg      Stdev     Max   +/- Stdev
    Latency     5.75s     6.79s   26.48s    76.56%
    Req/Sec   113.72    490.76     9.44k    94.07%
  561991 requests in 1.00m, 246.50MB read
  Socket errors: connect 0, read 10046, write 0, timeout 285789
Requests/sec:   9363.01
Transfer/sec:      4.11MB
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;CPU is finally taking a hit.  Now using 70% of available resources most of the time, but wrk seems to be distributing load well.  Memory is now showing some definite usage, but still a CPU intensive operation.&lt;/p&gt;
&lt;h4&gt;WRK Test: 4&lt;/h4&gt;
&lt;p&gt;This is going well beyond our means to see what happens.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;.&amp;#47;wrk -c 100000 -d 60 -t 10000 http:&amp;#47;&amp;#47;webdos
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;hellip;aaaaaaand the box completely died.&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/wg/wrk&#34;&gt;wrk on gh&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>graphite test clients</title>
                <link rel="alternate" href="/2013/08/15/graphite-test-clients/" type="text/html" />
                <id>/2013/08/15/graphite-test-clients/</id>
                <updated>2013-08-15T23:22:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Sending data to statsd&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://raw.github.com/chasemp/bin/master/graphite/statsd_client.py&#34;&gt;statsd client&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Looks like&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
1379719305.18 0.670906537626
test.counter.srpoint5:1|c|@0.2
test.fixed.counter.1:1|c
test.nonrandom:1|ms
test.nonrandom:2|ms
test.nonrandom:3|ms
test.random.gauge:0.670906537626|g
test.random.timer:0.670906537626|ms
test.random.set:0.670906537626|s
test.random.counter:0.670906537626|c
test.fixed.counter.2:2|c
test.fixed.counter.updown.1:1|c
test.fixed.counter.updown.1:-1|c
test.fixed.counter.updown.1_1:1.1|c
test.fixed.counter.updown.1_1:-1|c
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;send test data to graphite carbon listener&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
#!/usr/bin/env python
import socket
import time
from random import randint

CARBON_SERVER = &#39;127.0.0.1&#39;
CARBON_PORT = 8000

def send(m):
    sock = socket.socket()
    sock.connect((CARBON_SERVER, CARBON_PORT))
    sock.sendall(m)
    sock.close()

while 1:
    print &#39;send&#39;, time.time()
    send(&#39;test.yup:1|s&#39;)
    time.sleep(10)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;send test data to graphite carbon listener pickled&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
!/usr/bin/env python
import pickle
import time
import struct
import socket

list = [(&#39;chase&#39;, (time.time(), 1)), (&#39;chase2&#39;, (time.time(), 1))]

print list
payload = pickle.dumps(list)
header = struct.pack(&#34;!L&#34;, len(payload))
message = header + payload

def main():
        s = socket.socket()
        s.connect((&#39;10.1.107.27&#39;, 2003))
        s.sendall(message)
        s.close()
main()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Simple python statsd client library&lt;/h4&gt;&lt;h4&gt;Testing statsd with invalid data&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
import socket
# addressing information of target
IPADDR = &#39;127.0.0.1&#39;
PORTNUM = 9000

s = socket.socket(socket.AF_INET, socket.SOCK_DGRAM, 0)
s.connect((IPADDR, PORTNUM))
s.send(&#34;goodcount:1|c|@0.5&#34;)
s.send(&#34;goodcount:1|c|@1&#34;)
s.send(&#34;badcount1:2|c|@&#34;)
s.send(&#34;badcount2:3|c|what&#34;)
s.send(&#34;notype:5|&#34;)
s.send(&#34;no|:5g&#34;)
s.close()
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>anatomy of a fw vpn issue</title>
                <link rel="alternate" href="/2013/08/14/anatomy-of-a-fw-issue/" type="text/html" />
                <id>/2013/08/14/anatomy-of-a-fw-issue/</id>
                <updated>2013-08-14T16:44:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I recently had to jump in on a Firewall issue. Traffic was not passing on a new IPSec tunnel.  I thought I would layout my troubleshooting for further reflection.&lt;/p&gt;
&lt;h4&gt;Problem&lt;/h4&gt;
&lt;p&gt;Sorry, no visio.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/anatonmyfw.png&#34; alt=&#34;diagram&#34; title=&#34;fw&#34;&gt;&lt;/p&gt;

&lt;p&gt;The VPN between FW1 and FW2 does not pass traffic.  FW1 is the hub of several VPN L2L tunnels. FW2 has no pre-exiting VPN sessions.&lt;/p&gt;

&lt;p&gt;Details have been masked for obvious reasons.&lt;/p&gt;
&lt;h3&gt;Verify basic IP connectivity&lt;/h3&gt;&lt;h4&gt;HOST2&lt;/h4&gt;
&lt;p&gt;What is my ip?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@HOST2# ifconfig
eth2      Link encap:Ethernet  HWaddr 00:50:56:02:XX.XX  
          inet addr:10.10.0.4  Bcast:10.10.0.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;What are my routes?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@HOST2# ip route show
10.10.0.0/24 dev eth2  proto kernel  scope link  src 10.10.0.4 
169.254.0.0/16 dev eth2  scope link  metric 1002 
default via 10.10.0.1 dev eth2 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Can I ping my default gw?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@HOST2# ping 10.10.0.1
PING 10.10.0.1 (10.10.0.1) 56(84) bytes of data.
64 bytes from 10.10.0.1: ICMP_seq=6 ttl=63 time=49.2 ms
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;HOST1&lt;/h4&gt;
&lt;p&gt;What is my ip?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
[root@HOST1 ~]# ifconfig
eth0      Link encap:Ethernet  HWaddr 00:50:56:02:XX.XX  
          inet addr:10.0.0.230  Bcast:10.10.0.255  Mask:255.255.255.0
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;What are my routes?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
[root@HOST1 ~]# ip route show
10.0.0.0/24 dev eth0  proto kernel  scope link  src 10.0.0.230
default via 10.0.0.210 dev eth0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Can I ping my default gw?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
[root@HOST1 ~]# ping 10.0.0.210
PING 10.0.0.210 (10.0.0.210) 56(84) bytes of data.
64 bytes from 10.0.0.210: ICMP_seq=6 ttl=63 time=49.2 ms
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;FW1&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
FW1&gt; ping 1.1.1.1
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 1.1.1.1, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 40/50/60 ms
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
FW1&gt; ping 10.0.0.230
Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to banacek, timeout is 2 seconds:
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 1/1/1 ms
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;FW2&lt;/h3&gt;
&lt;p&gt;Here&amp;#39;s the kicker.  This is a black box to me.  I knew enough to know that it should work.&lt;/p&gt;
&lt;h3&gt;Foreknowledge&lt;/h3&gt;
&lt;p&gt;I knew this was the relevant stanza on FW1.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
crypto map outside_map 120 match address yeehaw-cryptomap
crypto map outside_map 120 set pfs
crypto map outside_map 120 set peer 1.1.1.1
crypto map outside_map 120 set transform-set ESP-AES-256-SHA
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Investigating&lt;/h3&gt;
&lt;p&gt;SSH&amp;#39;ed into FW1 to check things out.&lt;/p&gt;

&lt;p&gt;Show me the offending crypt-map&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1# sh ru  cry map | in 120
crypto map outside_map 120 match address yeehaw-cryptomap
crypto map outside_map 120 set pfs 
crypto map outside_map 120 set peer 1.1.1.1 
crypto map outside_map 120 set transform-set ESP-AES-256-SHA
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;show me any relevant security associations, A.K.A. Is The Tunnel Up?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# sh cry ipse sa peer 1.1.1.1
peer address: 1.1.1.1
    Crypto map tag: outside_map, seq num: 120, local addr: 2.2.2.2

      access-list yeehaw-cryptomap extended permit ip 10.0.0.0 255.255.0.0 10.10.0.0 255.255.0.0 log 
      local ident (addr/mask/prot/port): (10.0.0.0/255.255.255.0/0/0)
      remote ident (addr/mask/prot/port): (10.10.0.0/255.255.255.0/0/0)
      current_peer: 1.1.1.1

      #pkts encaps: 0, #pkts encrypt: 0, #pkts digest: 0
      #pkts decaps: 3, #pkts decrypt: 3, #pkts verify: 3
      #pkts compressed: 0, #pkts decompressed: 0
      #pkts not compressed: 0, #pkts comp failed: 0, #pkts decomp failed: 0
      #pre-frag successes: 0, #pre-frag failures: 0, #fragments created: 0
      #PMTUs sent: 0, #PMTUs rcvd: 0, #decapsulated frgs needing reassembly: 0
      #send errors: 0, #recv errors: 0

      local crypto endpt.: 2.2.2.2/0, remote crypto endpt.: 1.1.1.1/0
      path mtu 1500, ipsec overhead 74, media mtu 1500
      current outbound spi: C6DB9A2B
      current inbound spi : 946A6811

    inbound esp sas:
      spi: 0x946A6811 (2490001425)
         transform: esp-aes-256 esp-sha-hmac no compression 
         in use settings ={L2L, Tunnel, PFS Group 2, }
         slot: 0, conn_id: 55099392, crypto-map: outside_map
      *** ESP SA deleted ***
    *** Tunnel rekeyed or deleted ***
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Show me the access-list that defines interesting traffic&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# sh run access-l yeehaw-cryptomap
access-list yeehaw-cryptomap extended permit ip 10.0.0.0 255.255.0.0 10.10.0.0 255.255.0.0 log 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Show me my transform sets to make sure they are sane&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# sh run cry
crypto ipsec transform-set ESP-3DES-SHA esp-3des esp-sha-hmac 
crypto ipsec transform-set ESP-3DES-MD5 esp-3des esp-md5-hmac 
crypto ipsec transform-set ESP-AES-128-SHA esp-aes esp-sha-hmac 
crypto ipsec transform-set ESP-AES-128-MD5 esp-aes esp-md5-hmac 
crypto ipsec transform-set ESP-AES-192-SHA esp-aes-192 esp-sha-hmac 
crypto ipsec transform-set ESP-AES-192-MD5 esp-aes-192 esp-md5-hmac 
crypto ipsec transform-set ESP-AES-256-SHA esp-aes-256 esp-sha-hmac 
crypto ipsec transform-set ESP-AES-256-MD5 esp-aes-256 esp-md5-hmac 
crypto ipsec transform-set ESP-AES-128-SHA-TRANS esp-aes esp-sha-hmac 
crypto ipsec transform-set ESP-AES-128-SHA-TRANS mode transport
crypto ipsec transform-set ESP-AES-128-MD5-TRANS esp-aes esp-md5-hmac 
crypto ipsec transform-set ESP-AES-128-MD5-TRANS mode transport
crypto ipsec transform-set ESP-AES-192-SHA-TRANS esp-aes-192 esp-sha-hmac 
crypto ipsec transform-set ESP-AES-192-SHA-TRANS mode transport
crypto ipsec transform-set ESP-AES-192-MD5-TRANS esp-aes-192 esp-md5-hmac 
crypto ipsec transform-set ESP-AES-192-MD5-TRANS mode transport
crypto ipsec transform-set ESP-AES-256-SHA-TRANS esp-aes-256 esp-sha-hmac 
crypto ipsec transform-set ESP-AES-256-SHA-TRANS mode transport
crypto ipsec transform-set ESP-AES-256-MD5-TRANS esp-aes-256 esp-md5-hmac 
crypto ipsec transform-set ESP-AES-256-MD5-TRANS mode transport
crypto ipsec transform-set ESP-3DES-SHA-TRANS esp-3des esp-sha-hmac 
crypto ipsec transform-set ESP-3DES-SHA-TRANS mode transport
crypto ipsec transform-set ESP-3DES-MD5-TRANS esp-3des esp-md5-hmac 
crypto ipsec transform-set ESP-3DES-MD5-TRANS mode transport
crypto ipsec transform-set ESP-DES-SHA esp-des esp-sha-hmac
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Nat-T status&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# cry isa nat-traversal
FW1(config)#
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This configuration should work.  The tunnel is establishing.&lt;/p&gt;
&lt;h3&gt;What happens when I ping from Host2?&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
me@HOST2# ping 10.0.0.230
PING 10.0.0.230 (10.0.0.230) 56(84) bytes of data.
^C
--- 10.0.0.230 ping statistics ---
210 packets transmitted, 0 received, 100% packet loss, time 209248ms
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Stalls out big time.  No response.&lt;/p&gt;

&lt;p&gt;So I start a continuous ping from Host2 to Host1.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@HOST2# ping 10.0.0.230
PING 10.0.0.230 (10.0.0.230) 56(84) bytes of data.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;What do I see with debug enabled for ICMP on FW1 &amp;ndash; the opposing end of the VPN from Host2.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# debug ICMP trace 
debug ICMP trace enabled at level 1

ICMP echo request from Outside:8.8.8.8 to Inside:9.9.9.9 ID=0 seq=0 len=0
ICMP echo request untranslating Outside:9.9.9.9 to Inside:10.0.0.216
ICMP echo reply from Inside:10.0.0.216 to Outside:8.8.8.8 ID=0 seq=0 len=0
ICMP echo reply translating Inside:10.0.0.216 to Outside:9.9.9.9
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lots of ICMP but none for my source.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
    FW1(config)# un all
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Maybe NAT is to blame?&lt;/h3&gt;
&lt;p&gt;I know I don&amp;#39;t want to NAT these packets and I also know NAT is enabled.  For the ASA&lt;br&gt;
that means we need exclusions.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# sh ru nat
nat (Inside,Outside) source static INSIDE_HOSTS-10.0.0.0 INSIDE_HOSTS-10.0.0.0 \
                      destination static FW2_HOSTS_10.10.0.0_24 FW2_HOSTS_10.10.0.0_24
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This looks right for =&amp;lt;8.3 versions of ASA.  Although I find the syntax is lacking in clarify &lt;br&gt;
compared to the old Nat-0 configuration.&lt;/p&gt;
&lt;h3&gt;Show me that peer session again&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
FW1(config)# sh cry ipse sa peer 1.1.1.1
peer address: 1.1.1.1
    Crypto map tag: outside_map, seq num: 120, local addr: 2.2.2.2

      access-list yeehaw-cryptomap extended permit ip 10.0.0.0 255.255.0.0 10.10.0.0 255.255.0.0 log 
      local ident (addr/mask/prot/port): (10.0.0.0/255.255.255.0/0/0)
      remote ident (addr/mask/prot/port): (10.10.0.0/255.255.255.0/0/0)
      current_peer: 1.1.1.1

      #pkts encaps: 0, #pkts encrypt: 0, #pkts digest: 0
      #pkts decaps: 391, #pkts decrypt: 391, #pkts verify: 391
      #pkts compressed: 0, #pkts decompressed: 0
      #pkts not compressed: 0, #pkts comp failed: 0, #pkts decomp failed: 0
      #pre-frag successes: 0, #pre-frag failures: 0, #fragments created: 0
      #PMTUs sent: 0, #PMTUs rcvd: 0, #decapsulated frgs needing reassembly: 0
      #send errors: 0, #recv errors: 0

      local crypto endpt.: 2.2.2.2/0, remote crypto endpt.: 1.1.1.1/0
      path mtu 1500, ipsec overhead 74, media mtu 1500
      current outbound spi: 2B643D23
      current inbound spi : EDC8A714

    inbound esp sas:
      spi: 0xEDC8A714 (3989350164)
         transform: esp-aes-256 esp-sha-hmac no compression 
         in use settings ={L2L, Tunnel, PFS Group 2, }
&lt;/code&gt;&lt;/pre&gt;
 

&lt;p&gt;This now stands out to me:&lt;/p&gt;

&lt;p&gt;&amp;ndash;&amp;gt; pkts encaps: 0, #pkts encrypt: 0, #pkts digest: 0&lt;br&gt;
&amp;ndash;&amp;gt; pkts decaps: 391, #pkts decrypt: 391, #pkts verify: 391&lt;/p&gt;

&lt;p&gt;As far as I know that means we are receiving encrypted traffic but we are not &lt;br&gt;
responding.  We have decrypted but not encrypted traffic.  It seems like the &amp;#39;black box&amp;#39;&lt;br&gt;
is not to blame&amp;hellip;FW1 is not doing its job.  &lt;/p&gt;
&lt;h3&gt;Checking my sysopt parameters&lt;/h3&gt;
&lt;p&gt;These are global options similar to sysctl.conf in linux&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# sh run all sysopt
no sysopt connection timewait
sysopt connection tcpmss 1380
sysopt connection tcpmss minimum 0
sysopt connection permit-vpn
sysopt connection reclassify-vpn
sysopt connection preserve-vpn-flows
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This looks good.  &lt;/p&gt;
&lt;h3&gt;Taking stock&lt;/h3&gt;
&lt;p&gt;A few points I considered:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt; My tunnel comes up so all Phasev1 and Phasev2 stuff is solid.&lt;/li&gt;
&lt;li&gt; I have seen protocol 50 blocking in the middle of a VPN cause
this type of issue but &lt;em&gt;neither&lt;/em&gt; side could transmit encrypted traffic.&lt;/li&gt;
&lt;li&gt; I have seen unidirectional crypto traffic on endpoint crypto-map
mismatches, but I would expect FW1 to be the successful party.&lt;/li&gt;
&lt;li&gt;All raw connectivity works.&lt;/li&gt;
&lt;li&gt;I didn&amp;#39;t show it but I know my Inside ACL is not blocking traffic.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;At this point I&amp;#39;m frustrated.&lt;/p&gt;

&lt;p&gt;Fortunately, the ASA has a genius troubleshooting tool called packet-tracer.&lt;/p&gt;
&lt;h3&gt;Packet Tracer&lt;/h3&gt;
&lt;p&gt;Simulate an ICMP packet from HOST1 to HOST2&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# packet-tracer input inside ICMP 10.0.0.230 8 0 10.10.0.4 de

Phase: 1
Type: ACCESS-LIST
Subtype: 
Result: ALLOW
Config:
Implicit Rule
Additional Information:
 Forward Flow based lookup yields rule:
 in  id=0xaccf5600, priority=1, domain=permit, deny=false
    hits=2684148409, user_data=0x0, cs_id=0x0, l3_type=0x8
    src mac=0000.0000.0000, mask=0000.0000.0000
    dst mac=0000.0000.0000, mask=0100.0000.0000
    input_ifc=Inside, output_ifc=any

Phase: 2
Type: ROUTE-LOOKUP
Subtype: input
Result: ALLOW
Config:
Additional Information:
in   0.0.0.0         0.0.0.0         Outside

Phase: 3
Type: IP-OPTIONS
Subtype:      
Result: ALLOW
Config:
Additional Information:
 Forward Flow based lookup yields rule:
 in  id=0xaccf8470, priority=0, domain=inspect-ip-options, deny=true
    hits=7676990, user_data=0x0, cs_id=0x0, reverse, flags=0x0, protocol=0
    src ip/id=0.0.0.0, mask=0.0.0.0, port=0
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=0, dscp=0x0
    input_ifc=Inside, output_ifc=any

Phase: 4
Type: INSPECT
Subtype: np-inspect
Result: ALLOW
Config:
Additional Information:
 Forward Flow based lookup yields rule:
 in  id=0xaccf80d8, priority=66, domain=inspect-ICMP-error, deny=false
    hits=408286, user_data=0xaccf7fc0, cs_id=0x0, use_real_addr, flags=0x0, protocol=1
    src ip/id=0.0.0.0, mask=0.0.0.0, port=0
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=0, dscp=0x0
    input_ifc=Inside, output_ifc=any

Phase: 5      
Type: DEBUG-ICMP
Subtype: 
Result: ALLOW
Config:
Additional Information:
 Forward Flow based lookup yields rule:
 in  id=0xadc415a0, priority=13, domain=debug-ICMP-trace, deny=false
    hits=8, user_data=0x0, cs_id=0x0, reverse, flags=0x0, protocol=1
    src ip/id=0.0.0.0, mask=0.0.0.0, port=0
    dst ip/id=0.0.0.0, mask=0.0.0.0, port=0, dscp=0x0
    input_ifc=Inside, output_ifc=any

Phase: 6
Type: NAT
Subtype: 
Result: ALLOW
Config:
nat (Inside,Outside) source static INSIDE_HOSTS-10.0.0.0 INSIDE_HOSTS-10.0.0.0 \
                destination static FW2_HOSTS_10.10.0.0_24 FW2_HOSTS_10.10.0.0_24
Additional Information:
Static translate banacek/0 to banacek/0
 Forward Flow based lookup yields rule:
 in  id=0xadb88110, priority=6, domain=nat, deny=false
    hits=1942, user_data=0xad629e20, cs_id=0x0, use_real_addr, flags=0x0, protocol=0
        src ip/id=10.0.0.0, mask=255.255.255.0, port=0
    dst ip/id=10.10.0.0, mask=255.255.255.0, port=0, dscp=0x0
    input_ifc=Inside, output_ifc=Outside

Phase: 7
Type: ACCESS-LIST
Subtype: vpn-user
Result: DROP
Config:
Additional Information:
 Forward Flow based lookup yields rule:
 out id=0xac7a22d0, priority=12, domain=vpn-user, deny=true
    hits=1978, user_data=0xa90e0a00, filter_id=0x0(-implicit deny-), protocol=0
    src ip=0.0.0.0, mask=0.0.0.0, port=0
    dst ip=0.0.0.0, mask=0.0.0.0, port=0

Result:
input-interface: Inside
input-status: up
input-line-status: up
output-interface: Outside
output-status: up
output-line-status: up
Action: drop
Drop-reason: (acl-drop) Flow is denied by configured rule


It seems like there is an ACL configured that is dropping traffic.

Phase: 7
Type: ACCESS-LIST
Subtype: vpn-user
Result: DROP
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&amp;ndash;&amp;gt; Drop-reason: (acl-drop) Flow is denied by configured rule&lt;/p&gt;
&lt;h3&gt;The Problem&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
FW1(config)# sh run tun
&lt;output omitted&gt;
tunnel-group 1.1.1.1 type ipsec-l2l
tunnel-group 1.1.1.1 general-attributes
 default-group-policy mygrpplcy
tunnel-group 1.1.1.1 ipsec-attributes
 pre-shared-key *****
&lt;output omitted&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Someone applied a group policy to my L2L VPN.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)#    sh run group-p mygrpplcy
group-policy mygrpplcy internal
group-policy mygrpplcy attributes
 vpn-filter value Outside_cryptomap_120
 vpn-tunnel-protocol IPSec l2tp-ipsec 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That group policy has a vpn-filter.  Basically, an ACL.  &lt;/p&gt;

&lt;p&gt;That ACL only allows traffic one way since it is the crypto ACL for our&lt;br&gt;
side of the tunnel.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
access-list Outside_cryptomap_120 extended permit ip 10.0.0.0 255.255.255.0 10.10.0.0 255.255.255.0 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now I know why my ping from Host2 doesn&amp;#39;t do anything.&lt;/p&gt;
&lt;h3&gt;The Fix&lt;/h3&gt;
&lt;p&gt;I talked to the relevant people and it turns out this group-policy is erroneous.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
FW1(config)# group-policy mygrpplcy attributes
FW1(config-group-policy)# no vpn-filter value Outside_cryptomap_120
FW1(config)# clear crypto ipsec sa peer 1.1.1.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Just like that everything worked.&lt;/p&gt;
&lt;h3&gt;Lessons Learned&lt;/h3&gt;
&lt;ol&gt;
&lt;li&gt; group-policy can be applied to L2L tunnels.  It makes sense, but I
wasn&amp;#39;t looking for it initially.&lt;/li&gt;
&lt;li&gt; vpn-filter dropped traffic does not show up in ASDM logs by default.&lt;/li&gt;
&lt;li&gt; packet-tracer is awesome.&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://supportforums.cisco.com/docs/DOC-5796&#34;&gt;packet tracer&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>python snippets</title>
                <link rel="alternate" href="/2013/08/13/python-snippets/" type="text/html" />
                <id>/2013/08/13/python-snippets/</id>
                <updated>2013-08-13T21:43:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I recently found these snippets to be useful.&lt;/p&gt;
&lt;h4&gt;Invoke garbage collection manually&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;import gc
gc.collect()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;http://effbot.org/pyfaq/how-does-python-manage-memory.htm&#34;&gt;How does python manage memory?&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://pymotw.com/2/gc/&#34;&gt;MOTW&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Less style output from python&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;import pydoc
pydoc.pager(&amp;#39;string&amp;#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;http://docs.python.org/2/library/pydoc.html&#34;&gt;docs&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.onlamp.com/pub/a/python/2001/04/18/pydoc.html&#34;&gt;oreilly info&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Basic use of multiprocessing pool.map&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
import time
from multiprocessing import Pool

def f(x):
    print time.time()
    time.sleep(1)
    print time.time()

def main():
    #four simultaneious workers
    pool = Pool(processes=4)
    print pool.map(f, range(10))

if __name__ == &#39;__main__&#39;:
    main()
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Demonstrates 4 concurrent subprocesses happening, each with their own GIL&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
377232079.27
1377232079.27
1377232079.27
1377232079.27
1377232080.27
1377232080.27
1377232080.27
1377232080.27
1377232080.27
1377232080.27
1377232080.27
1377232080.27
1377232081.27
1377232081.27
1377232081.28
1377232081.28
1377232081.28
1377232081.28
1377232082.28
1377232082.28
[None, None, None, None, None, None, None, None, None, None]
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>using a golang library</title>
                <link rel="alternate" href="/2013/08/11/using-a-golang-library/" type="text/html" />
                <id>/2013/08/11/using-a-golang-library/</id>
                <updated>2013-08-11T21:43:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://golang.org/&#34;&gt;Go&lt;/a&gt; is rather strict and has a &amp;#39;one right way&amp;#39; methodology.  I am going to demonstrate using a Golang tool that mimicks tcpdump.&lt;/p&gt;
&lt;h4&gt;Installing&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install golang libpcap0.8-dev 
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
The following NEW packages will be installed:
  golang golang-doc{a} golang-go{a} golang-src{a} 
0 packages upgraded, 4 newly installed, 0 to remove and 0 not upgraded.
Need to get 24.8 MB of archives. After unpacking 88.9 MB will be used.
Do you want to continue? [Y/n/?] Y
Get: 1 http://ftp.us.debian.org/debian/ wheezy/main golang-src amd64 2:1.0.2-1.1 [2,989 kB]
Get: 2 http://ftp.us.debian.org/debian/ wheezy/main golang-go amd64 2:1.0.2-1.1 [17.3 MB]
Get: 3 http://ftp.us.debian.org/debian/ wheezy/main golang-doc all 2:1.0.2-1.1 [4,523 kB]                    
Get: 4 http://ftp.us.debian.org/debian/ wheezy/main golang all 2:1.0.2-1.1 [24.9 kB]                         
Fetched 24.8 MB in 38s (651 kB/s)                                                                            
Preconfiguring packages ...
Selecting previously unselected package golang-src.
(Reading database ... 35651 files and directories currently installed.)
Unpacking golang-src (from .../golang-src_2%3a1.0.2-1.1_amd64.deb) ...
Selecting previously unselected package golang-go.
Unpacking golang-go (from .../golang-go_2%3a1.0.2-1.1_amd64.deb) ...
Selecting previously unselected package golang-doc.
Unpacking golang-doc (from .../golang-doc_2%3a1.0.2-1.1_all.deb) ...
Selecting previously unselected package golang.
Unpacking golang (from .../golang_2%3a1.0.2-1.1_all.deb) ...
Processing triggers for man-db ...
Setting up golang-src (2:1.0.2-1.1) ...
Setting up golang-go (2:1.0.2-1.1) ...
Setting up golang-doc (2:1.0.2-1.1) ...
Setting up golang (2:1.0.2-1.1) ...
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Setting up our environment&lt;/h4&gt;
&lt;p&gt;We need to setup our environment so Go knows where to find our library for building.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#can be anywhere the convention is $HOME
mkdir -p $HOME&amp;#47;go&amp;#47;src
#Goland looks for env GOPATH
export GOPATH=$HOME&amp;#47;go
#including &amp;#39;go install&amp;#39; binaries in our normal $PATH
export PATH=$PATH:$GOPATH&amp;#47;bin

cd ~&amp;#47;go&amp;#47;src&amp;#47;
git clone https:&amp;#47;&amp;#47;github.com&amp;#47;akrennmair&amp;#47;gopcap.git
cd gopcap&amp;#47;
#compile
go build
#place in our bin directory
go install
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The ~/go/pkg directory is created with the gopcap lib&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:~/go# tree
.
├── pkg
│   └── linux_amd64
│       └── gopcap.a
└── src
    └── gopcap
        ├── decode.go
        ├── decode_test.go
        ├── io.go
        ├── LICENSE
        ├── pcap.go
        ├── README.mkd
        └── tools
            ├── benchmark
            │   └── benchmark.go
            ├── pass
            │   └── pass.go
            ├── pcaptest
            │   └── pcaptest.go
            └── tcpdump
                └── tcpdump.go

&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Build tcpdump written in Go&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;cd ~&amp;#47;go&amp;#47;src&amp;#47;gopcap&amp;#47;tools&amp;#47;tcpdump
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;-&amp;gt; Change the &amp;ldquo;github.com/akrennmair/gopcap&amp;rdquo; to &amp;#39;gopcp&amp;#39; as we are using our local lib.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;go build
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now there is a binary in our directory&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;me@vm:~&amp;#47;go&amp;#47;src&amp;#47;gopcap&amp;#47;tools&amp;#47;tcpdump# ls
tcpdump  tcpdump.go
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We can run it like any program&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:~/go/src/gopcap/tools/tcpdump# ./tcpdump 
2013-08-10 03:43:37.399656 -0500 CDT 2013-08-10 03:43:37.399656 -0500 \
CDT TCP 172.16.104.1:54048 &gt; 172.16.104.131:22 [ack psh] SEQ=3090816858 ACK=2666230607 LEN=100
2013-08-10 03:43:37.400096 -0500 CDT 2013-08-10 03:43:37.400096 -0500 \
CDT TCP 172.16.104.131:22 &gt; 172.16.104.1:54048 [ack psh] SEQ=2666230607 ACK=3090816906 LEN=260
2013-08-10 03:43:37.400268 -0500 CDT 2013-08-10 03:43:37.400268 -0500 \
CDT TCP 172.16.104.1:54048 &gt; 172.16.104.131:22 [ack] SEQ=3090816906 ACK=2666230815 LEN=52
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Place this in our Go path&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@vm:~&amp;#47;go&amp;#47;src&amp;#47;gopcap&amp;#47;tools&amp;#47;tcpdump# go install
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now our Go path tree looks like&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:~/go/src/gopcap/tools/tcpdump# tree ~/go/
/me/go/
├── bin
│   └── tcpdump
├── pkg
│   └── linux_amd64
│       └── gopcap.a
└── src
    └── gopcap
        ├── decode.go
        ├── decode_test.go
        ├── io.go
        ├── LICENSE
        ├── pcap.go
        ├── README.mkd
        └── tools
            ├── benchmark
            │   └── benchmark.go
            ├── pass
            │   └── pass.go
            ├── pcaptest
            │   └── pcaptest.go
            └── tcpdump
                ├── hexify.py
                ├── tcpdump
                └── tcpdump.go
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Go and Paths&lt;/h4&gt;
&lt;p&gt;So tcpdump is obviously already a *nix tool.  Right now if I issue the command I am getting the Go version.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;which tcpdump
&amp;#47;root&amp;#47;go&amp;#47;bin&amp;#47;tcpdump

&amp;gt;file ~&amp;#47;go&amp;#47;bin&amp;#47;tcpdump 
&amp;#47;root&amp;#47;go&amp;#47;bin&amp;#47;tcpdump: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), \
dynamically linked (uses shared libs), not stripped
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Useful&lt;/h4&gt;
&lt;p&gt;Clean up our build&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;go clean
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Clean up our build and remove installed binaries&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;go clean -i 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Build verbosely&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;go build -x
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
WORK=/tmp/go-build730443136
mkdir -p $WORK/gopcap/tools/tcpdump/_obj/
cd /root/go/src/gopcap/tools/tcpdump
/usr/lib/go/pkg/tool/linux_amd64/6g -o $WORK/gopcap/tools/tcpdump/_obj/_go_.6 \
    -p gopcap/tools/tcpdump -D _/root/go/src/gopcap/tools/tcpdump -I $WORK \
    -I /root/go/pkg/linux_amd64 ./godump.go

/usr/lib/go/pkg/tool/linux_amd64/pack grc $WORK/gopcap/tools/tcpdump.a \
    $WORK/gopcap/tools/tcpdump/_obj/_go_.6
cd .
/usr/lib/go/pkg/tool/linux_amd64/6l -o $WORK/gopcap/tools/tcpdump/_obj/a.out \
    -L $WORK -L /root/go/pkg/linux_amd64 $WORK/gopcap/tools/tcpdump.a
cp $WORK/gopcap/tools/tcpdump/_obj/a.out tcpdump
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Install verbosely&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;go install -x
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
WORK=/tmp/go-build061121702
mkdir -p $WORK/gopcap/tools/tcpdump/_obj/
cd /root/go/src/gopcap/tools/tcpdump
/usr/lib/go/pkg/tool/linux_amd64/6g -o $WORK/gopcap/tools/tcpdump/_obj/_go_.6 \
    -p gopcap/tools/tcpdump -D _/root/go/src/gopcap/tools/tcpdump -I $WORK \
    -I /root/go/pkg/linux_amd64 ./godump.go

/usr/lib/go/pkg/tool/linux_amd64/pack grc $WORK/gopcap/tools/tcpdump.a \
    $WORK/gopcap/tools/tcpdump/_obj/_go_.6
cd .

/usr/lib/go/pkg/tool/linux_amd64/6l -o $WORK/gopcap/tools/tcpdump/_obj/a.out \
    -L $WORK -L /root/go/pkg/linux_amd64 $WORK/gopcap/tools/tcpdump.a

mkdir -p /root/go/bin/
cp $WORK/gopcap/tools/tcpdump/_obj/a.out /root/go/bin/tcpdump
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://golang.org/doc/install&#34;&gt;go lang install&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://golang.org/doc/code.html&#34;&gt;howto begin&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/akrennmair/gopcap&#34;&gt;golang pcap&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>VPN encryption mismatch</title>
                <link rel="alternate" href="/2013/08/09/VPN-encryption-mismatch/" type="text/html" />
                <id>/2013/08/09/VPN-encryption-mismatch/</id>
                <updated>2013-08-09T22:14:00Z</updated>
                
                
                <content type="html">&lt;h3&gt;Preamble&lt;/h3&gt;
&lt;p&gt;A site-to-site VPN between vCloud Director and a Cisco ASA.&lt;/p&gt;
&lt;h4&gt;The Go-To Example&lt;/h4&gt;
&lt;p&gt;Everyone seems to reference:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.datastore365.co.uk/news/configuring-a-vmware-vcloud-director-external-ipsec-site-to-site-vpn-connection-to-a-cisco-asa-firewall/&#34;&gt;vpn instructions&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Following this the tunnel is not establishing so I need to debug&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;debug crypto isakmp 127
debug crypto ipsec 127
term mon
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;IPSEC isn&amp;#39;t establishing a security association properly&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Aug 07 15:05:51 [IKEv1 DEBUG]: Group = 192.168.1.1, IP = 192.168.1.1, processing IPSec SA payload
Aug 07 15:05:51 [IKEv1]: Group = 192.168.1.1, IP = 192.168.1.1, All IPSec SA proposals found unacceptable!
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Followed by the SA in progress being discarded&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Aug 07 15:05:51 [IKEv1]: Ignoring msg to mark SA with dsID 52281344 dead because SA deleted
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I know this isn&amp;#39;t an isakmp negotation issue as Phase 1 is completing&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Aug 07 15:05:50 [IKEv1 DEBUG]: IP = 192.168.1.1, IKE SA Proposal # 1, Transform # 0 \
acceptable  Matches global IKE entry # 8
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The IPSEC proposals do not match in the tutorial.&lt;/p&gt;

&lt;p&gt;For demonstrations sake fixing it on the ASA side looks like&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;crypto ipsec transform-set ESP-3DES-SHA esp-3des esp-sha-hmac 
crypto map outside_map 10 set transform-set ESP-3DES-SHA
un all
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This means the IPSEC tunnel will establish with 3DES as the encryption mechanism.  In &lt;br&gt;
practice I will change both sides to use AES256.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;crypto ipsec transform-set ESP-AES-256-MD5-TRANS esp-aes-256 esp-md5-hmac
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.datastore365.co.uk/news/configuring-a-vmware-vcloud-director-external-ipsec-site-to-site-vpn-connection-to-a-cisco-asa-firewall/&#34;&gt;instructions&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/products/ps6120/products_configuration_example09186a0080950890.shtml&#34;&gt;cisco asa vpn example&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/docs/ios/12_2/debug/command/reference/dbfippim.html&#34;&gt;debug info&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>trust me i am engineer</title>
                <link rel="alternate" href="/2013/08/09/trust-me-i-am-engineer/" type="text/html" />
                <id>/2013/08/09/trust-me-i-am-engineer/</id>
                <updated>2013-08-09T05:15:00Z</updated>
                
                <summary type="html">Genius.</summary>
                <content type="html">&lt;p&gt;Genius.&lt;/p&gt;

&lt;p&gt;&lt;object width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;param name=&#34;movie&#34; value=&#34;https://youtube.googleapis.com/v/rp8hvyjZWHs&amp;amp;hl=en_US&amp;amp;fs=1&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowFullScreen&#34; value=&#34;true&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowscriptaccess&#34; value=&#34;always&#34;&gt;&lt;/param&gt;&lt;embed src=&#34;https://youtube.googleapis.com/v/rp8hvyjZWHs&amp;amp;hl=en_US&amp;amp;fs=1&#34; type=&#34;application/x-shockwave-flash&#34; allowscriptaccess=&#34;always&#34; allowfullscreen=&#34;true&#34; width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;/embed&gt;&lt;/object&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>submerging an asr 1002</title>
                <link rel="alternate" href="/2013/08/08/submerging-an-asr-1002/" type="text/html" />
                <id>/2013/08/08/submerging-an-asr-1002/</id>
                <updated>2013-08-08T04:41:00Z</updated>
                
                <summary type="html">A colleague of mine captured this.  Cisco ASR routers are not water resistent.</summary>
                <content type="html">&lt;p&gt;A colleague of mine captured this.  Cisco ASR routers are not water resistent.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
00:02:39.652: %ASR1000_PEM-3-PEMFAIL: \
    The PEM in slot 0 is switched off or encountering a failure condition.
00:02:40.075: %ASR1000_OIR-6-OFFLINECARD: Card (fp) offline in slot F0
00:02:51.829: %ASR1000_PEM-3-FANFAIL: \
    The fan in slot 0/1 is encountering a failure condition
00:03:32.843: %ASR1000_PEM-6-FANOK: The fan in slot 0/1 is functioning properly
00:03:40.852: %ASR1000_PEM-3-FANFAIL: \
    The fan in slot 0/1 is encountering a failure condition
00:03:45.993: GigabitEthernet0/0/3 taken out of port-channel1
00:03:47.855: %ASR1000_PEM-6-FANOK: The fan in slot 0/1 is functioning properly
00:03:50.857: %ASR1000_PEM-3-FANFAIL: \
    The fan in slot 0/1 is encountering a failure condition
00:03:51.855: %ASR1000_PEM-6-FANOK: The fan in slot 0/1 is functioning properly
.00:09:34.530: %SSH-3-RSA_SIGN_FAIL: Signature connection failed, status 3
.00:09:34.530: %SSH-3-RSA_SIGN_FAIL: Signature creation failed, status -1
.00:10:58.692: %ASR1000_PEM-6-PEMOK: The PEM in slot 0 is functioning properly
.00:11:00.370: %ASR1000_PEM-3-PEMFAIL: \
    The PEM in slot 0 is switched off or encountering a failure condition.
.00:11:00.957: %ASR1000_PEM-6-PEMOK: The PEM in slot 0 is functioning properly
.00:11:02.971: %ASR1000_PEM-3-PEMFAIL: \
    The PEM in slot 0 is switched off or encountering a failure condition.
.00:11:03.474: %ASR1000_PEM-6-PEMOK: The PEM in slot 0 is functioning properly
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>debian rpaf fools mod_access</title>
                <link rel="alternate" href="/2013/08/06/debian-rpaf-fools-mod_access/" type="text/html" />
                <id>/2013/08/06/debian-rpaf-fools-mod_access/</id>
                <updated>2013-08-06T21:41:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;If you have a reverse proxy in front of apache you need a way to persist the original host IP for logging, etc.  &lt;a href=&#34;http://stderr.net/apache/rpaf/&#34;&gt;rpaf&lt;/a&gt; does this.  Essentially handles letting apache see the proxy provided field of &lt;a href=&#34;http://en.wikipedia.org/wiki/X-Forwarded-For&#34;&gt;x-forward-for&lt;/a&gt; so things are handled in a sane manner.&lt;/p&gt;

&lt;p&gt;Unfortunately this seems to have problems working with  &lt;a href=&#34;http://httpd.apache.org/docs/2.0/mod/mod_access.html&#34;&gt;mod_access&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Debian &lt;a href=&#34;http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=697644&#34;&gt;report&lt;/a&gt;&lt;br&gt;
Debian &lt;a href=&#34;http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=653330&#34;&gt;report&lt;/a&gt;&lt;br&gt;
ubuntu &lt;a href=&#34;https://bugs.launchpad.net/ubuntu/+source/libapache2-mod-rpaf/+bug/1029003&#34;&gt;report&lt;/a&gt;&lt;br&gt;
poundlist &lt;a href=&#34;http://www.apsis.ch/pound/pound_list/archive/2007/2007-01/1169244573000/index_html?fullMode=1#1169947453000&#34;&gt;report&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Everyone needs to authenticate&lt;/h4&gt;
&lt;p&gt;Deny from all, but if it is a valid user then it will trigger Satisfy Any.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
    Order deny,allow
    Deny from all
    AuthType Basic
    AuthName &#34;Authentication Required&#34;
    AuthUserFile &#34;/etc/htpasswd/.htpasswd&#34;
    Satisfy Any
    Require valid-user
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Everyone needs to authenticate except for internal hosts&lt;/h4&gt;
&lt;p&gt;Deny from all but Satisfy Any is triggered by a &amp;#39;192.&amp;#39; host or valid auth.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
    Order deny,allow
    Deny from all
    Allow from 192
    AuthType Basic
    AuthName &#34;Authentication Required&#34;
    AuthUserFile &#34;/etc/htpasswd/.htpasswd&#34;
    Satisfy Any
    Require valid-user
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Looking-At-X-Foward-For&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;ngrep port 80
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
##
T 192.168.0.101:53639 -&gt; 192.168.1.27:80 [AP]
  GET /favicon.ico HTTP/1.1..User-Agent: Mozilla/5.0 
  (Macintosh; Intel Mac OS X 10_7_5) AppleWebKit/537.36 (KHT
  ML, like Gecko) Chrome/28.0.1500.71 Safari/537.36..
  X-Forwarded-For: 99.9.236.147..Accept: */*..SSLClientCertS
  tatus: NoClientCert..Accept-Language: en-US,en;q=0.8..
  Authorization: Basic cnVzaDpYcDlndzNsMSEl..SSLClientCip
  her: SSL_RSA_WITH_RC4_128_SHA, version=TLSv1.1, bits=128..
  Host: graphite.deviantart.net..SSLSessionID: 71C838
  5EF2B8A9FC5705BF7EBC8C15B10627835642A1D7157DB996C1FBE96F5B..
   X-Cluster-Client-Ip: 99.9.236.147..
##
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&amp;ndash;&amp;gt; &lt;code&gt;X-Forwarded-For: 99.9.236.147&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;In Apache my host shows up as: 99.9.236.147.&lt;/p&gt;
&lt;h4&gt;Hmmmm&amp;hellip;.Access Granted&lt;/h4&gt;
&lt;p&gt;Apache&amp;#39;s ACL system is still treating my requests as if they were sourced from 192.168.0.101.&lt;/p&gt;

&lt;p&gt;The configuration from &amp;#39;Everyone needs to authenticate except for internal&amp;#39; should allow&lt;br&gt;
only internal hosts to bypass auth.  In this case it is allowing everyone because&lt;br&gt;
Apache is not using the post-rpaf x-forward-for IP in its ACL lookup.  It is using the&lt;br&gt;
IP of the reverse proxy.  This means everyone is allowed.&lt;/p&gt;
&lt;h4&gt;Workaround: Getting more specific with our allowances&lt;/h4&gt;
&lt;p&gt;Only allow specific internal ranges that do not include the reverse proxy referrer.  &lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
    Order deny,allow
    Deny from all
    Allow from 192.168.1.
    AuthType Basic
    AuthName &#34;Authentication Required&#34;
    AuthUserFile &#34;/etc/htpasswd/.htpasswd&#34;
    Require valid-user
    Satisfy Any
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is not a great fix as it allows for a future re-IP to cause chaos.&lt;/p&gt;
&lt;h4&gt;Possible Solution&lt;/h4&gt;
&lt;p&gt;Use &lt;a href=&#34;https://github.com/ttkzw/mod_remoteip-httpd22&#34;&gt;mode_remoteip&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://httpd.apache.org/docs/2.0/mod/mod_access.html&#34;&gt;mod_access docs&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.askapache.com/htaccess/apache-authentication-in-htaccess.html&#34;&gt;ask apache doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://chrismorris.org/passing-ip-from-nginx-to-apache/&#34;&gt;nginx x-forward-for&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/ttkzw/mod_remoteip-httpd22&#34;&gt;mode_remoteip gh&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://us.generation-nt.com/answer/bug-697644-apache2-mod-rpaf-failure-work-authz-allow-deny-should-be-documented-help-210345472.html&#34;&gt;use mod_remoteip&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://serverfault.com/questions/235648/apache-use-x-forwarded-for-for-allow&#34;&gt;use setevn&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>configserver firewall and config script</title>
                <link rel="alternate" href="/2013/08/05/configserver-firewall-and-config-script/" type="text/html" />
                <id>/2013/08/05/configserver-firewall-and-config-script/</id>
                <updated>2013-08-05T21:41:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I have seen an all-in-one configure script for linux security mentioned several times on &lt;a href=&#34;http://reddit.com/r/linuxadmin&#34;&gt;/r/linuxadmin&lt;/a&gt; and I am giving it a quick runthrough to explore.&lt;/p&gt;
&lt;h4&gt;Install&lt;/h4&gt;
&lt;p&gt;Linux wheezytester 3.2.0-4-amd64 #1 SMP Debian 3.2.46-1 x86_64 GNU/Linux&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget http:&amp;#47;&amp;#47;configserver.com&amp;#47;free&amp;#47;csf.tgz
tar zxfv csf.tgz
cd csf&amp;#47;
sh install.sh
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;hideme&#39;);&#34;&gt;Show Install Output&lt;/a&gt;&lt;/p&gt;

&lt;div id=&#34;hideme&#34; style=&#34;display:none;&#34;&gt;
&lt;pre&gt;&lt;code&gt;
Configuring for OS

Running csf generic installer

Installing generic csf and lfd

Check we&#39;re running as root

Checking Perl modules...mode of `os.pl&#39; changed from 0755 (rwxr-xr-x) to 0700 (rwx------)
Configuration modified for Debian/Ubuntu/Gentoo settings /etc/csf/csf.conf
ok

mkdir: created directory `/etc/csf&#39;
mkdir: created directory `/var/lib/csf&#39;
mkdir: created directory `/usr/local/csf&#39;
mkdir: created directory `/var/lib/csf/Geo&#39;
mkdir: created directory `/var/lib/csf/ui&#39;
mkdir: created directory `/var/lib/csf/stats&#39;
mkdir: created directory `/var/lib/csf/lock&#39;
mkdir: created directory `/var/lib/csf/webmin&#39;
mkdir: created directory `/var/lib/csf/zone&#39;
mkdir: created directory `/usr/local/csf/bin&#39;
mkdir: created directory `/usr/local/csf/lib&#39;
mkdir: created directory `/usr/local/csf/tpl&#39;
`csf.generic.conf&#39; -&gt; `/etc/csf/csf.conf&#39;
`csf.allow&#39; -&gt; `/etc/csf/./csf.allow&#39;
`csf.deny&#39; -&gt; `/etc/csf/./csf.deny&#39;
`csf.redirect&#39; -&gt; `/etc/csf/./csf.redirect&#39;
`csf.resellers&#39; -&gt; `/etc/csf/./csf.resellers&#39;
`csf.dirwatch&#39; -&gt; `/etc/csf/./csf.dirwatch&#39;
`csf.logfiles&#39; -&gt; `/etc/csf/./csf.logfiles&#39;
`csf.logignore&#39; -&gt; `/etc/csf/./csf.logignore&#39;
`csf.blocklists&#39; -&gt; `/etc/csf/./csf.blocklists&#39;
`csf.ignore&#39; -&gt; `/etc/csf/./csf.ignore&#39;
`csf.generic.pignore&#39; -&gt; `/etc/csf/csf.pignore&#39;
`csf.rignore&#39; -&gt; `/etc/csf/./csf.rignore&#39;
`csf.fignore&#39; -&gt; `/etc/csf/./csf.fignore&#39;
`csf.signore&#39; -&gt; `/etc/csf/./csf.signore&#39;
`csf.suignore&#39; -&gt; `/etc/csf/./csf.suignore&#39;
`csf.uidignore&#39; -&gt; `/etc/csf/./csf.uidignore&#39;
`csf.mignore&#39; -&gt; `/etc/csf/./csf.mignore&#39;
`csf.sips&#39; -&gt; `/etc/csf/./csf.sips&#39;
`csf.dyndns&#39; -&gt; `/etc/csf/./csf.dyndns&#39;
`alert.txt&#39; -&gt; `/usr/local/csf/tpl/./alert.txt&#39;
`reselleralert.txt&#39; -&gt; `/usr/local/csf/tpl/./reselleralert.txt&#39;
`logalert.txt&#39; -&gt; `/usr/local/csf/tpl/./logalert.txt&#39;
`logfloodalert.txt&#39; -&gt; `/usr/local/csf/tpl/./logfloodalert.txt&#39;
`syslogalert.txt&#39; -&gt; `/usr/local/csf/tpl/./syslogalert.txt&#39;
`integrityalert.txt&#39; -&gt; `/usr/local/csf/tpl/./integrityalert.txt&#39;
`exploitalert.txt&#39; -&gt; `/usr/local/csf/tpl/./exploitalert.txt&#39;
`queuealert.txt&#39; -&gt; `/usr/local/csf/tpl/./queuealert.txt&#39;
`tracking.txt&#39; -&gt; `/usr/local/csf/tpl/./tracking.txt&#39;
`connectiontracking.txt&#39; -&gt; `/usr/local/csf/tpl/./connectiontracking.txt&#39;
`processtracking.txt&#39; -&gt; `/usr/local/csf/tpl/./processtracking.txt&#39;
`accounttracking.txt&#39; -&gt; `/usr/local/csf/tpl/./accounttracking.txt&#39;
`usertracking.txt&#39; -&gt; `/usr/local/csf/tpl/./usertracking.txt&#39;
`sshalert.txt&#39; -&gt; `/usr/local/csf/tpl/./sshalert.txt&#39;
`webminalert.txt&#39; -&gt; `/usr/local/csf/tpl/./webminalert.txt&#39;
`sualert.txt&#39; -&gt; `/usr/local/csf/tpl/./sualert.txt&#39;
`consolealert.txt&#39; -&gt; `/usr/local/csf/tpl/./consolealert.txt&#39;
`uialert.txt&#39; -&gt; `/usr/local/csf/tpl/./uialert.txt&#39;
`cpanelalert.txt&#39; -&gt; `/usr/local/csf/tpl/./cpanelalert.txt&#39;
`scriptalert.txt&#39; -&gt; `/usr/local/csf/tpl/./scriptalert.txt&#39;
`relayalert.txt&#39; -&gt; `/usr/local/csf/tpl/./relayalert.txt&#39;
`filealert.txt&#39; -&gt; `/usr/local/csf/tpl/./filealert.txt&#39;
`watchalert.txt&#39; -&gt; `/usr/local/csf/tpl/./watchalert.txt&#39;
`loadalert.txt&#39; -&gt; `/usr/local/csf/tpl/./loadalert.txt&#39;
`resalert.txt&#39; -&gt; `/usr/local/csf/tpl/./resalert.txt&#39;
`portscan.txt&#39; -&gt; `/usr/local/csf/tpl/./portscan.txt&#39;
`uidscan.txt&#39; -&gt; `/usr/local/csf/tpl/./uidscan.txt&#39;
`permblock.txt&#39; -&gt; `/usr/local/csf/tpl/./permblock.txt&#39;
`netblock.txt&#39; -&gt; `/usr/local/csf/tpl/./netblock.txt&#39;
`portknocking.txt&#39; -&gt; `/usr/local/csf/tpl/./portknocking.txt&#39;
`forkbombalert.txt&#39; -&gt; `/usr/local/csf/tpl/./forkbombalert.txt&#39;
`x-arf.txt&#39; -&gt; `/usr/local/csf/tpl/./x-arf.txt&#39;
`regex.custom.pm&#39; -&gt; `/usr/local/csf/bin/./regex.custom.pm&#39;
`pt_deleted_action.pl&#39; -&gt; `/usr/local/csf/bin/./pt_deleted_action.pl&#39;
`messenger&#39; -&gt; `/etc/csf/./messenger&#39;
`messenger/index.html&#39; -&gt; `/etc/csf/./messenger/index.html&#39;
`messenger/csf_small.png&#39; -&gt; `/etc/csf/./messenger/csf_small.png&#39;
`messenger/index.text&#39; -&gt; `/etc/csf/./messenger/index.text&#39;
`ui&#39; -&gt; `/etc/csf/./ui&#39;
`ui/server.key&#39; -&gt; `/etc/csf/./ui/server.key&#39;
`ui/images&#39; -&gt; `/etc/csf/./ui/images&#39;
`ui/images/deliver.png&#39; -&gt; `/etc/csf/./ui/images/deliver.png&#39;
`ui/images/plus.png&#39; -&gt; `/etc/csf/./ui/images/plus.png&#39;
`ui/images/minus.png&#39; -&gt; `/etc/csf/./ui/images/minus.png&#39;
`ui/images/ip.png&#39; -&gt; `/etc/csf/./ui/images/ip.png&#39;
`ui/images/LICENSE.txt&#39; -&gt; `/etc/csf/./ui/images/LICENSE.txt&#39;
`ui/images/cse_small.png&#39; -&gt; `/etc/csf/./ui/images/cse_small.png&#39;
`ui/images/icon.gif&#39; -&gt; `/etc/csf/./ui/images/icon.gif&#39;
`ui/images/viewdelivery.png&#39; -&gt; `/etc/csf/./ui/images/viewdelivery.png&#39;
`ui/images/cxs.png&#39; -&gt; `/etc/csf/./ui/images/cxs.png&#39;
`ui/images/delete.png&#39; -&gt; `/etc/csf/./ui/images/delete.png&#39;
`ui/images/cxs_small.png&#39; -&gt; `/etc/csf/./ui/images/cxs_small.png&#39;
`ui/images/csf_small.png&#39; -&gt; `/etc/csf/./ui/images/csf_small.png&#39;
`ui/images/cxs-loader.gif&#39; -&gt; `/etc/csf/./ui/images/cxs-loader.gif&#39;
`ui/images/perm.png&#39; -&gt; `/etc/csf/./ui/images/perm.png&#39;
`ui/ui.allow&#39; -&gt; `/etc/csf/./ui/ui.allow&#39;
`ui/ui.ban&#39; -&gt; `/etc/csf/./ui/ui.ban&#39;
`ui/server.crt&#39; -&gt; `/etc/csf/./ui/server.crt&#39;
`lfd.logrotate&#39; -&gt; `/etc/logrotate.d/lfd&#39;
`csfcron.sh&#39; -&gt; `/etc/cron.d/csfcron.sh&#39;
`csf.pl&#39; -&gt; `/usr/sbin/csf&#39;
`lfd.pl&#39; -&gt; `/usr/sbin/lfd&#39;
`/etc/csf/csf.pl&#39; -&gt; `/usr/sbin/csf&#39;
`/etc/csf/lfd.pl&#39; -&gt; `/usr/sbin/lfd&#39;
`/etc/csf/csfui.pl&#39; -&gt; `/usr/local/csf/bin/csfui.pl&#39;
`/etc/csf/csftest.pl&#39; -&gt; `/usr/local/csf/bin/csftest.pl&#39;
`/etc/csf/pt_deleted_action.pl&#39; -&gt; `/usr/local/csf/bin/pt_deleted_action.pl&#39;
`/etc/csf/remove_apf_bfd.sh&#39; -&gt; `/usr/local/csf/bin/remove_apf_bfd.sh&#39;
`/etc/csf/uninstall.sh&#39; -&gt; `/usr/local/csf/bin/uninstall.sh&#39;
`/etc/csf/regex.custom.pm&#39; -&gt; `/usr/local/csf/bin/regex.custom.pm&#39;
`/etc/csf/webmin&#39; -&gt; `/usr/local/csf/lib/webmin&#39;
`/etc/csf/alerts&#39; -&gt; `/usr/local/csf/tpl&#39;
`uninstall.generic.sh&#39; -&gt; `/usr/local/csf/bin/uninstall.sh&#39;
`csfui.pl&#39; -&gt; `/usr/local/csf/bin/csfui.pl&#39;
`csfuir.pl&#39; -&gt; `/usr/local/csf/bin/csfuir.pl&#39;
`cseui.pl&#39; -&gt; `/usr/local/csf/bin/cseui.pl&#39;
`csftest.pl&#39; -&gt; `/usr/local/csf/bin/csftest.pl&#39;
`regex.pm&#39; -&gt; `/usr/local/csf/bin/regex.pm&#39;
`servercheck.pm&#39; -&gt; `/usr/local/csf/bin/servercheck.pm&#39;
`remove_apf_bfd.sh&#39; -&gt; `/usr/local/csf/bin/remove_apf_bfd.sh&#39;
`readme.txt&#39; -&gt; `/etc/csf/readme.txt&#39;
`sanity.txt&#39; -&gt; `/usr/local/csf/lib/sanity.txt&#39;
`restricted.txt&#39; -&gt; `/usr/local/csf/lib/restricted.txt&#39;
`changelog.txt&#39; -&gt; `/etc/csf/changelog.txt&#39;
`install.txt&#39; -&gt; `/etc/csf/install.txt&#39;
`version.txt&#39; -&gt; `/etc/csf/version.txt&#39;
`license.txt&#39; -&gt; `/etc/csf/license.txt&#39;
`lfd.sh&#39; -&gt; `/etc/init.d/lfd&#39;
`csf.sh&#39; -&gt; `/etc/init.d/csf&#39;
`webmin&#39; -&gt; `/usr/local/csf/lib/webmin&#39;
`webmin/csf&#39; -&gt; `/usr/local/csf/lib/webmin/csf&#39;
`webmin/csf/module.info&#39; -&gt; `/usr/local/csf/lib/webmin/csf/module.info&#39;
`webmin/csf/images&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images&#39;
`webmin/csf/images/plus.png&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images/plus.png&#39;
`webmin/csf/images/minus.png&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images/minus.png&#39;
`webmin/csf/images/ip.png&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images/ip.png&#39;
`webmin/csf/images/LICENSE.txt&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images/LICENSE.txt&#39;
`webmin/csf/images/icon.gif&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images/icon.gif&#39;
`webmin/csf/images/delete.png&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images/delete.png&#39;
`webmin/csf/images/csf_small.png&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images/csf_small.png&#39;
`webmin/csf/images/perm.png&#39; -&gt; `/usr/local/csf/lib/webmin/csf/images/perm.png&#39;
`webmin/csf/index.cgi&#39; -&gt; `/usr/local/csf/lib/webmin/csf/index.cgi&#39;
`Net&#39; -&gt; `/usr/local/csf/lib/Net&#39;
`Net/CIDR&#39; -&gt; `/usr/local/csf/lib/Net/CIDR&#39;
`Net/CIDR/Lite.pm&#39; -&gt; `/usr/local/csf/lib/Net/CIDR/Lite.pm&#39;
`Geo&#39; -&gt; `/usr/local/csf/lib/Geo&#39;
`Geo/IP&#39; -&gt; `/usr/local/csf/lib/Geo/IP&#39;
`Geo/IP/Record.pod&#39; -&gt; `/usr/local/csf/lib/Geo/IP/Record.pod&#39;
`Geo/IP/Record.pm&#39; -&gt; `/usr/local/csf/lib/Geo/IP/Record.pm&#39;
`Geo/Mirror.pm&#39; -&gt; `/usr/local/csf/lib/Geo/Mirror.pm&#39;
`Geo/IP.pm&#39; -&gt; `/usr/local/csf/lib/Geo/IP.pm&#39;
`Crypt&#39; -&gt; `/usr/local/csf/lib/Crypt&#39;
`Crypt/Blowfish_PP.pm&#39; -&gt; `/usr/local/csf/lib/Crypt/Blowfish_PP.pm&#39;
`Crypt/CBC.pm&#39; -&gt; `/usr/local/csf/lib/Crypt/CBC.pm&#39;
`HTTP&#39; -&gt; `/usr/local/csf/lib/HTTP&#39;
`HTTP/Tiny.pm&#39; -&gt; `/usr/local/csf/lib/HTTP/Tiny.pm&#39;
`csf.div&#39; -&gt; `/usr/local/csf/lib/csf.div&#39;
`ui/images/deliver.png&#39; -&gt; `/etc/csf/ui/./images/deliver.png&#39;
`ui/images/plus.png&#39; -&gt; `/etc/csf/ui/./images/plus.png&#39;
`ui/images/minus.png&#39; -&gt; `/etc/csf/ui/./images/minus.png&#39;
`ui/images/ip.png&#39; -&gt; `/etc/csf/ui/./images/ip.png&#39;
`ui/images/LICENSE.txt&#39; -&gt; `/etc/csf/ui/./images/LICENSE.txt&#39;
`ui/images/cse_small.png&#39; -&gt; `/etc/csf/ui/./images/cse_small.png&#39;
`ui/images/icon.gif&#39; -&gt; `/etc/csf/ui/./images/icon.gif&#39;
`ui/images/viewdelivery.png&#39; -&gt; `/etc/csf/ui/./images/viewdelivery.png&#39;
`ui/images/cxs.png&#39; -&gt; `/etc/csf/ui/./images/cxs.png&#39;
`ui/images/delete.png&#39; -&gt; `/etc/csf/ui/./images/delete.png&#39;
`ui/images/cxs_small.png&#39; -&gt; `/etc/csf/ui/./images/cxs_small.png&#39;
`ui/images/csf_small.png&#39; -&gt; `/etc/csf/ui/./images/csf_small.png&#39;
`ui/images/cxs-loader.gif&#39; -&gt; `/etc/csf/ui/./images/cxs-loader.gif&#39;
`ui/images/perm.png&#39; -&gt; `/etc/csf/ui/./images/perm.png&#39;
`lfdcron.sh&#39; -&gt; `/etc/cron.d/lfdcron.sh&#39;
`csf.1.txt&#39; -&gt; `/usr/local/man/man1/csf.1&#39;
`csf.help&#39; -&gt; `/usr/local/csf/lib/csf.help&#39;
chmod: cannot access `/var/log/lfd.log*&#39;: No such file or directory
mode of `/usr/local/csf/bin/cseui.pl&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/csftest.pl&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/csfui.pl&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/csfuir.pl&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/pt_deleted_action.pl&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/remove_apf_bfd.sh&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/uninstall.sh&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/regex.custom.pm&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/regex.pm&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/usr/local/csf/bin/servercheck.pm&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/etc/csf/webmin/csf/index.cgi&#39; changed from 0600 (rw-------) to 0700 (rwx------)
mode of `/etc/init.d/lfd&#39; retained as 0755 (rwxr-xr-x)
mode of `/etc/init.d/csf&#39; retained as 0755 (rwxr-xr-x)
mode of `/etc/cron.d/lfdcron.sh&#39; changed from 0755 (rwxr-xr-x) to 0644 (rw-r--r--)
mode of `/etc/cron.d/csfcron.sh&#39; changed from 0755 (rwxr-xr-x) to 0644 (rw-r--r--)
mode of `auto.generic.pl&#39; changed from 0755 (rwxr-xr-x) to 0700 (rwx------)

*** FASTSTART Enabled


*** IPV6 Enabled


*** IPV6_SPI set to 1


TCP ports currently listening for incoming connections:
22,111,60787

UDP ports currently listening for incoming connections:
68,111,904,39545,54776

Note: The port details above are for information only, csf hasn&#39;t been auto-configured.

Don&#39;t forget to:
1. Configure the following options in the csf configuration to suite your server: TCP_*, UDP_*
2. Restart csf and lfd
3. Set TESTING to 0 once you&#39;re happy with the firewall, lfd will not run until you do so

Adding current SSH session IP address to the csf whitelist in csf.allow:
Adding 172.16.104.1 to csf.allow only while in TESTING mode (not iptables ACCEPT)
*WARNING* TESTING mode is enabled - do not forget to disable it in the configuration
update-rc.d: using dependency based boot sequencing
update-rc.d: using dependency based boot sequencing
update-rc.d: using dependency based boot sequencing
update-rc.d: using dependency based boot sequencing
`/etc/csf/csfwebmin.tgz&#39; -&gt; `/usr/local/csf/csfwebmin.tgz&#39;

Installation Completed
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h4&gt;Checking out default status&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;#47;etc&amp;#47;init.d&amp;#47;csf status
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Status of csf:Chain INPUT (policy ACCEPT 1622 packets, 145K bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 771 packets, 260K bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain PREROUTING (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         

Chain POSTROUTING (policy ACCEPT 0 packets, 0 bytes)
num   pkts bytes target     prot opt in     out     source               destination         
*WARNING* TESTING mode is enabled - do not forget to disable it in the configuration
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Notice &amp;mdash; Testing Mode is the install default so it doesn&amp;#39;t mess up your system.&lt;/p&gt;

&lt;p&gt;That is cool.&lt;/p&gt;
&lt;h4&gt;Configuring&lt;/h4&gt;
&lt;p&gt;This configuration file is verbose and long winded.  Which it has to be with all of&lt;br&gt;
the features packed in.  Here is a partial configuration I created to play with.  I&lt;br&gt;
have shortened the default descriptions to my own line notes.&lt;/p&gt;

&lt;p&gt;Configured Sections:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Initial Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;IPv4 Port Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;IPv6 Port Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;General Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;SMTP Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Port Flood Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Logging Settings&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Unconfigured sections:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Reporting Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Country Code Lists and Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Login Failure Blocking and Alerts&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Directory Watching &amp;amp; Integrity&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Distributed Attacks&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Login Tracking&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Connection Tracking&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Process Tracking&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Port Scan Tracking&lt;/em&gt;&lt;br&gt;
&lt;em&gt;User ID Tracking&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Account Tracking&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Integrated User Interface&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Messenger service&lt;/em&gt;&lt;br&gt;
&lt;em&gt;lfd Clustering&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Port Knocking&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Log Scanner&lt;/em&gt;&lt;br&gt;
&lt;em&gt;Statistics Settings&lt;/em&gt;&lt;br&gt;
&lt;em&gt;OS Specific Settings&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nano &amp;#47;etc&amp;#47;csf&amp;#47;csf.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
#for real
TESTING = &#34;0&#34;
TESTING_INTERVAL = &#34;5&#34;
# 2 = Disabled UI
RESTRICT_UI = &#34;2&#34;
# You should check for new version announcements at http://blog.configserver.com
AUTO_UPDATES = &#34;0&#34;
# Allow incoming TCP ports
TCP_IN = &#34;2280&#34;
# Allow outgoing TCP ports
TCP_OUT = &#34;20,21,22,25,53,80,110,113,443&#34;
# Allow incoming UDP ports
UDP_IN = &#34;53&#34;
# Allow outgoing UDP ports
# To allow outgoing traceroute add 33434:33523 to this list 
UDP_OUT = &#34;20,21,53,113,123&#34;
# Allow incoming PING
ICMP_IN = &#34;1&#34;
# Set the per IP address incoming ICMP packet rate
# To disable rate limiting set to &#34;0&#34;
ICMP_IN_RATE = &#34;5/s&#34;
# Allow outgoing PING
ICMP_OUT = &#34;1&#34;
ICMP_OUT_RATE = &#34;0&#34;
#no ipv6
IPV6 = &#34;0&#34;
#do all nics but lo
ETH_DEVICE = &#34;&#34;
ETH6_DEVICE = &#34;&#34;
#no skips
ETH_DEVICE_SKIP = &#34;&#34;
USE_CONNTRACK = &#34;1&#34;
#verify syslog
SYSLOG_CHECK = &#34;1&#34;
IGNORE_ALLOW = &#34;0&#34;
DNS_STRICT = &#34;0&#34;
DNS_STRICT_NS = &#34;0&#34;
#set according to box resources
DENY_IP_LIMIT = &#34;500&#34;
DENY_TEMP_IP_LIMIT = &#34;250&#34;
# Enable login failure detection daemon (lfd)
LF_DAEMON = &#34;1&#34;
LF_CSF = &#34;1&#34;
# This option uses IPTABLES_SAVE, IPTABLES_RESTORE and IP6TABLES_SAVE
FASTSTART = &#34;1&#34;
LFDSTART = &#34;0&#34;
VERBOSE = &#34;1&#34;
# This will drop packets that iptables has deemed INVALID
PACKET_FILTER = &#34;1&#34;
LF_LOOKUPS = &#34;0&#34;
SMTP_BLOCK = &#34;0&#34;
SMTP_ALLOWLOCAL = &#34;1&#34;
SMTP_PORTS = &#34;25,465,587&#34;
SMTP_ALLOWUSER = &#34;&#34;
SMTP_ALLOWGROUP = &#34;mail,mailman&#34;
#this is dealers choice
#if tripped you see latency
SYNFLOOD = &#34;1&#34;
SYNFLOOD_RATE = &#34;10000/s&#34;
SYNFLOOD_BURST = &#34;1500&#34;
CONNLIMIT = &#34;&#34;
PORTFLOOD = &#34;&#34;
UDPFLOOD = &#34;0&#34;
UDPFLOOD_LIMIT = &#34;100/s&#34;
UDPFLOOD_BURST = &#34;500&#34;
#add yourself
UDPFLOOD_ALLOWUSER = &#34;named&#34;
SYSLOG = &#34;0&#34;
# Drop target for iptables rules. This can be set to either DROP ot REJECT.
DROP = &#34;DROP&#34;
DROP_LOGGING = &#34;1&#34;
# Enable logging of dropped incoming connections from blocked IP addresses
DROP_IP_LOGGING = &#34;0&#34;
DROP_OUT_LOGGING = &#34;0&#34;
DROP_ONLYRES = &#34;0&#34;
DROP_NOLOG = &#34;67,68,111,113,135:139,445,500,513,520&#34;
DROP_PF_LOGGING = &#34;0&#34;
CONNLIMIT_LOGGING = &#34;0&#34;
UDPFLOOD_LOGGING = &#34;1&#34;
LOGFLOOD_ALERT = &#34;1&#34;
WATCH_MODE = &#34;0&#34;
#Reporting section and on down left as default
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Resetting Configuration&lt;/h4&gt;
&lt;p&gt;If you try to restart the service you see&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#47;etc&amp;#47;init.d&amp;#47;csf restart
WARNING: This script should ONLY be used by the init process. To restart csf use the CLI command &amp;#39;csf -r&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;csf -r
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Loads and reloads iptables configuration from main config file.&lt;/p&gt;
&lt;h4&gt;What do we end up with&lt;/h4&gt;
&lt;p&gt;IPTables Configuration Generated&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;iptables -L -n
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;iptablesoutput&#39;);&#34;&gt;Show IPtables Output&lt;/a&gt;&lt;/p&gt;

&lt;div id=&#34;iptablesoutput&#34; style=&#34;display:none;&#34;&gt;
&lt;pre&gt;&lt;code&gt;
Chain INPUT (policy DROP)
target     prot opt source               destination         
ACCEPT     tcp  --  172.16.104.2         0.0.0.0/0            tcp dpt:53
ACCEPT     udp  --  172.16.104.2         0.0.0.0/0            udp dpt:53
ACCEPT     tcp  --  172.16.104.2         0.0.0.0/0            tcp spt:53
ACCEPT     udp  --  172.16.104.2         0.0.0.0/0            udp spt:53
LOCALINPUT  all  --  0.0.0.0/0            0.0.0.0/0           
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           
SYNFLOOD   tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x17/0x02
INVALID    tcp  --  0.0.0.0/0            0.0.0.0/0           
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:2280
ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW udp dpt:53
ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0            icmptype 8 limit: avg 5/sec burst 5
ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0            icmptype 0 limit: avg 5/sec burst 5
ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0            icmptype 11
ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0            icmptype 3
LOGDROPIN  all  --  0.0.0.0/0            0.0.0.0/0           

Chain FORWARD (policy DROP)
target     prot opt source               destination         

Chain OUTPUT (policy DROP)
target     prot opt source               destination         
ACCEPT     tcp  --  0.0.0.0/0            172.16.104.2         tcp dpt:53
ACCEPT     udp  --  0.0.0.0/0            172.16.104.2         udp dpt:53
ACCEPT     tcp  --  0.0.0.0/0            172.16.104.2         tcp spt:53
ACCEPT     udp  --  0.0.0.0/0            172.16.104.2         udp spt:53
LOCALOUTPUT  all  --  0.0.0.0/0            0.0.0.0/0           
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:53
ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:53
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            tcp spt:53
ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            udp spt:53
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0           
INVALID    tcp  --  0.0.0.0/0            0.0.0.0/0           
ACCEPT     all  --  0.0.0.0/0            0.0.0.0/0            ctstate RELATED,ESTABLISHED
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:20
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:21
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:22
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:25
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:53
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:80
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:110
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:113
ACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW tcp dpt:443
ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW udp dpt:20
ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW udp dpt:21
ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW udp dpt:53
ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW udp dpt:113
ACCEPT     udp  --  0.0.0.0/0            0.0.0.0/0            ctstate NEW udp dpt:123
ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0            icmptype 0
ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0            icmptype 8
ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0            icmptype 11
ACCEPT     icmp --  0.0.0.0/0            0.0.0.0/0            icmptype 3
LOGDROPOUT  all  --  0.0.0.0/0            0.0.0.0/0           

Chain ALLOWIN (1 references)
target     prot opt source               destination         
ACCEPT     all  --  172.16.104.1         0.0.0.0/0           

Chain ALLOWOUT (1 references)
target     prot opt source               destination         
ACCEPT     all  --  0.0.0.0/0            172.16.104.1        

Chain DENYIN (1 references)
target     prot opt source               destination         

Chain DENYOUT (1 references)
target     prot opt source               destination         

Chain INVALID (2 references)
target     prot opt source               destination         
INVDROP    all  --  0.0.0.0/0            0.0.0.0/0            ctstate INVALID
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x3F/0x00
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x3F/0x3F
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x03/0x03
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x06/0x06
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x05/0x05
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x11/0x01
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x18/0x08
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags: 0x30/0x20
INVDROP    tcp  --  0.0.0.0/0            0.0.0.0/0            tcpflags:! 0x17/0x02 ctstate NEW

Chain INVDROP (10 references)
target     prot opt source               destination         
DROP       all  --  0.0.0.0/0            0.0.0.0/0           

Chain LOCALINPUT (1 references)
target     prot opt source               destination         
ALLOWIN    all  --  0.0.0.0/0            0.0.0.0/0           
DENYIN     all  --  0.0.0.0/0            0.0.0.0/0           

Chain LOCALOUTPUT (1 references)
target     prot opt source               destination         
ALLOWOUT   all  --  0.0.0.0/0            0.0.0.0/0           
DENYOUT    all  --  0.0.0.0/0            0.0.0.0/0           

Chain LOGDROPIN (1 references)
target     prot opt source               destination         
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:67
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:67
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:68
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:68
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:111
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:111
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:113
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:113
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpts:135:139
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpts:135:139
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:445
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:445
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:500
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:500
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:513
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:513
DROP       tcp  --  0.0.0.0/0            0.0.0.0/0            tcp dpt:520
DROP       udp  --  0.0.0.0/0            0.0.0.0/0            udp dpt:520
LOG        tcp  --  0.0.0.0/0            0.0.0.0/0            limit: avg 30/min \
                  burst 5 LOG flags 0 level 4 prefix &#34;Firewall: *TCP_IN Blocked* &#34;
LOG        udp  --  0.0.0.0/0            0.0.0.0/0            limit: avg 30/min \
                  burst 5 LOG flags 0 level 4 prefix &#34;Firewall: *UDP_IN Blocked* &#34;
LOG        icmp --  0.0.0.0/0            0.0.0.0/0            limit: avg 30/min \
                  burst 5 LOG flags 0 level 4 prefix &#34;Firewall: *ICMP_IN Blocked* &#34;
DROP       all  --  0.0.0.0/0            0.0.0.0/0           

Chain LOGDROPOUT (1 references)
target     prot opt source               destination         
LOG        tcp  --  0.0.0.0/0            0.0.0.0/0            \
                  tcpflags: 0x17/0x02 limit: avg 30/min burst 5 LOG flags 8 level \
                  4 prefix &#34;Firewall: *TCP_OUT Blocked* &#34;
LOG        udp  --  0.0.0.0/0            0.0.0.0/0            \
                  limit: avg 30/min burst 5 LOG flags 8 level 4 prefix \
                  &#34;Firewall: *UDP_OUT Blocked* &#34;
LOG        icmp --  0.0.0.0/0            0.0.0.0/0            \
                  limit: avg 30/min burst 5 LOG flags 8 level 4 prefix \
                  &#34;Firewall: *ICMP_OUT Blocked* &#34;
DROP       all  --  0.0.0.0/0            0.0.0.0/0           

Chain SYNFLOOD (1 references)
target     prot opt source               destination         
RETURN     all  --  0.0.0.0/0            0.0.0.0/0            limit: avg 10000/sec burst 1500
LOG        all  --  0.0.0.0/0            0.0.0.0/0            limit: avg 30/min burst \
                   5 LOG flags 0 level 4 prefix &#34;Firewall: *SYNFLOOD Blocked* &#34;
DROP       all  --  0.0.0.0/0            0.0.0.0/0           
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;Scan of the server&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;nmap -A 172.16.104.131
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Starting Nmap 6.25 ( http://nmap.org ) at 2013-08-05 15:48 CDT
Nmap scan report for 172.16.104.131
Host is up (0.0011s latency).
Not shown: 998 closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 6.0p1 Debian 4 (protocol 2.0)
| ssh-hostkey: 1024 70:6f:5e:ff:20:46:59:89:e2:3c:b2:02:83:f2:5a:d9 (DSA)
| 2048 dc:01:80:6e:3f:d3:e4:31:de:06:ec:81:b3:5d:96:d7 (RSA)
|_256 87:8f:c4:30:5c:51:f5:26:78:bc:46:7f:ce:f2:11:f9 (ECDSA)
111/tcp open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          44942/tcp  status
|_  100024  1          54275/udp  status
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.21 seconds
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Firewall denials logged&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Aug  5 15:48:13 wheezytester kernel: [ 7378.577396] \
Firewall: *UDP_OUT Blocked* IN= OUT=eth0 SRC=172.16.104.131 DST=172.16.104.254 \
LEN=328 TOS=0x00 PREC=0x00 TTL=64 ID=0 DF PROTO=UDP SPT=68 DPT=67 LEN=308 UID=0 GID=0 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Syslog analyzer&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Aug  5 15:48:20 wheezytester lfd[2394]: SYSLOG check [zRX2uBS2T5C3gm33v9BCJDVK5]
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Removal&lt;/h4&gt;
&lt;p&gt;Uninstalling csf and lfd&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Flushing chain `INPUT&#39;

&lt;redacted for brevity&gt;

removed directory: `/var/lib/csf&#39;

...Done
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Thoughts&lt;/h4&gt;
&lt;p&gt;The CSF pack if pretty powerfull and I have a general idea of the usage experience.  I have&lt;br&gt;
not tested this with Webmin or cPanel or any other wrapper.  I wouldn&amp;#39;t use them if I had&lt;br&gt;
the choice anyways.  I think this exists in a weird space as anyone who does operations &lt;br&gt;
probably would feel limited by it, and anyone who has no experience in linux&lt;br&gt;
administration would do well to side step it and learn the underlying tools directly.  I&lt;br&gt;
appreciate what they have going here and I can tell a lot of thought went into it.&lt;br&gt;
However, if I  were talking to myself as I was starting out with a personal Debian server&lt;br&gt;
I would still not recommend going this route.  &lt;/p&gt;

&lt;p&gt;Instead I might recommend:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;disable root account remote access&lt;/li&gt;
&lt;li&gt;lock SSH down to key based auth&lt;/li&gt;
&lt;li&gt;whitelist your IP&lt;/li&gt;
&lt;li&gt;basic ip tables &lt;a href=&#34;http://chasemp.github.io/2013/04/19/simple-iptables-uses/&#34;&gt;setup&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;avoid running sendmail, instead try &lt;a href=&#34;http://untroubled.org/nullmailer/&#34;&gt;nullmailer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;avoid running BIND &lt;/li&gt;
&lt;li&gt;use &lt;a href=&#34;http://www.fail2ban.org/wiki/index.php/Main_Page&#34;&gt;fail2ban&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Don&amp;#39;t worry about portscanning, it&amp;#39;s inevitable&lt;/li&gt;
&lt;li&gt;Try something like &lt;a href=&#34;https://www.cloudflare.com/&#34;&gt;CloudFlare&amp;#39;s&lt;/a&gt; free service&lt;/li&gt;
&lt;li&gt;Use Puppet and Git for deploying even small setups&lt;/li&gt;
&lt;li&gt;Backup up stuff outside of your server&lt;/li&gt;
&lt;li&gt;Use static site generators if feasible: &lt;a href=&#34;http://jekyllrb.com/&#34;&gt;jekyll&lt;/a&gt; or &lt;a href=&#34;https://github.com/Anomareh/mynt&#34;&gt;mynt&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This is the basic approach that I prefer, but kudos to the CSF guys for putting&lt;br&gt;
something out there to help people.  I can see using this in a lab to quickly reconfigure&lt;br&gt;
a dummy host for attacking or tutorials.&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://configserver.com/cp/csf.html&#34;&gt;CSF&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://forum.configserver.com/&#34;&gt;CSF Forum&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.reddit.com/r/linuxadmin&#34;&gt;/r/linuxadmin&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>PEP8 Guide Updates</title>
                <link rel="alternate" href="/2013/08/01/PEP8-Guide-Updates/" type="text/html" />
                <id>/2013/08/01/PEP8-Guide-Updates/</id>
                <updated>2013-08-01T21:41:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.python.org/dev/peps/pep-0008/&#34;&gt;PEP8&lt;/a&gt; is the &amp;#39;official&amp;#39; style guide for Python.  The idea being if the Python community can rally around a set of standards it makes the overall quality of code in the community better.  At least that&amp;#39;s my idea.&lt;/p&gt;

&lt;p&gt;The guide has now been updated.  Here are some things I found notable.&lt;/p&gt;
&lt;h4&gt;Style Guide Exclusions&lt;/h4&gt;
&lt;p&gt;Then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-Two good reasons to break a particular rule:

-1. When applying the rule would make the code less readable, even for
-   someone who is used to reading code that follows the rules.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;+In particular: do not break backwards compatibility just to comply with
+this PEP!

+Some other good reasons to ignore a particular guideline:
+
+1. When applying the guideline would make the code less readable, even
+   for someone who is used to reading code that follows this PEP.

+3. Because the code in question predates the introduction of the
+   guideline and there is no other reason to be modifying that code.
+
+4. When the code needs to remain compatible with older versions of
+   Python that don&amp;#39;t support the feature recommended by the style guide.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Line Characters&lt;/h4&gt;
&lt;p&gt;Then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;-Limit all lines to a maximum of 79 characters.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;+Aim to limit all lines to a maximum of 79 characters, but up to 99
+characters is acceptable when it improves readability.

+For flowing long blocks of text with fewer structural restrictions
+(docstrings or comments), limiting the line length to 72 characters
+is recommended.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;UTF-8 Is The Future&lt;/h4&gt;
&lt;p&gt;Then:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
   -Code in the core Python distribution should always use the ASCII or
   -Latin-1 encoding (a.k.a. ISO-8859-1).  For Python 3.0 and beyond,
   -UTF-8 is preferred over Latin-1, see PEP 3120.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
   +Code in the core Python distribution should always use UTF-8 (or ASCII
   +in Python 2).

   +  Note that in Python 3, ``unicode`` and ``basestring`` no longer exist
   +  (there is only ``str``) and a bytes object is no longer a kind of
   +  string (it is a sequence of integers instead)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Relative vs. Absolute Imports&lt;/h4&gt;
&lt;p&gt;Then:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
   - Relative imports for intra-package imports are highly discouraged.
   -  Always use the absolute package path for all imports.  Even now that
   -  PEP 328 is fully implemented in Python 2.5, its style of explicit
   -  relative imports is actively discouraged; absolute imports are more
   -  portable and usually more readable.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
   + Absolute imports are recommended, as they are usually more readable
   +  and tend to be better behaved (or at least give better error
   +  messages) if the import system is incorrectly configured (such as
   +  when a directory inside a package ends up on ``sys.path``)::
   +
   +    import mypkg.sibling
   +    from mypkg import sibling
   +    from mypkg.sibling import example
   +
   +  However, explicit relative imports are an acceptable alternative to
   +  absolute imports, especially when dealing with complex package layouts
   +  where using absolute imports would be unecessarily verbose::
   +
   +    from . import sibling
   +    from .sibling import example
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Other Lessons Learned&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Use &amp;#39;def&amp;#39; and not named lambda&amp;#39;s&lt;/li&gt;
&lt;li&gt;Backwards compability is only expected for public interfaces&lt;/li&gt;
&lt;li&gt;Use &amp;#39;&amp;#39;.Join() over concatenation with performance and portablity in mind&lt;/li&gt;
&lt;li&gt;Use &amp;#39;with&amp;#39; statements with local resources.  try/finally is still ok.&lt;/li&gt;
&lt;li&gt;Don&amp;#39;t break old code just to apply the style guide on principle.&lt;/li&gt;
&lt;li&gt;Python3.x does not allow mixing tabs and spaces&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;References&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://hg.python.org/peps/rev/fb24c80e9afb&#34;&gt;PEP8 Revision&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://hg.python.org/peps/file/fb24c80e9afb/pep-0008.txt&#34;&gt;PEP8 Full&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>OSX DNS Cache Clearing</title>
                <link rel="alternate" href="/2013/07/29/OSX-DNS-Cache-Clearing/" type="text/html" />
                <id>/2013/07/29/OSX-DNS-Cache-Clearing/</id>
                <updated>2013-07-29T21:41:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;OSX &amp;lt;10.6 caches DNS.  Which is very helpful unless you move servers between VLAN&amp;#39;s a lot.  Then you have to clear your cache often.&lt;/p&gt;
&lt;h4&gt;details on the mDNSResponder&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;man mDNSResponder
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
     mDNSResponder (also known as mdnsd on some systems) is a daemon invoked at boot time to
     implement Multicast DNS and DNS Service Discovery. On Mac OS X 10.6 (Snow Leopard),
     mDNSResponder is also the system-wide Unicast DNS Resolver.
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Clear Cache&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo killall -HUP mDNSResponder
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Alias&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;alias cdns=&amp;#39;sudo killall -HUP mDNSResponder&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://support.apple.com/kb/ht5343&#34;&gt;apple KB&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>getting to know python import</title>
                <link rel="alternate" href="/2013/07/26/getting-to-know-python-import/" type="text/html" />
                <id>/2013/07/26/getting-to-know-python-import/</id>
                <updated>2013-07-26T21:41:00Z</updated>
                
                
                <content type="html">&lt;h3&gt;Preamble&lt;/h3&gt;
&lt;p&gt;Python&amp;#39;s &lt;a href=&#34;https://phrac.deviantart.net/D3628&#34;&gt;import&lt;/a&gt; system is one of the things that I enjoy about the language. Exploring it is time well spent.  This is somewhat of a practical walk through.  The import system goes pretty deep. There are finders and loaders and all o kinds of awesome details I&amp;#39;m not getting into.  This is not exhaustive but hopefully is useful enough to be worthwhile.&lt;/p&gt;

&lt;p&gt;For the full details on import watch the pycon video &lt;a href=&#34;http://pyvideo.org/video/1707/how-import-works&#34;&gt;here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Seriously, awesome talk.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;edit 01/02/14&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;this was meant to be part 1 of a series.  the series has not happened yet so it seems terse.  the talk is still worth watching.&lt;/p&gt;
&lt;h4&gt;The Terrain&lt;/h4&gt;
&lt;p&gt;I am using the interactive &lt;a href=&#34;http://docs.python.org/2/tutorial/interpreter.html&#34;&gt;interpreter&lt;/a&gt; and making basic modules are demonstrated.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import sys
sys.version
&#39;2.7.1 (r271:86832, Aug  5 2011, 03:30:24) \n[GCC 4.2.1]&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Easter Eggs&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; from __future__ import braces
  File &#34;&lt;stdin&gt;&#34;, line 1
SyntaxError: not a chance
&gt;&gt;&gt; 
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; import this
The Zen of Python, by Tim Peters

Beautiful is better than ugly.
Explicit is better than implicit.
Simple is better than complex.
Complex is better than complicated.
Flat is better than nested.
Sparse is better than dense.
Readability counts.
Special cases aren&#39;t special enough to break the rules.
Although practicality beats purity.
Errors should never pass silently.
Unless explicitly silenced.
In the face of ambiguity, refuse the temptation to guess.
There should be one-- and preferably only one --obvious way to do it.
Although that way may not be obvious at first unless you&#39;re Dutch.
Now is better than never.
Although never is often better than *right* now.
If the implementation is hard to explain, it&#39;s a bad idea.
If the implementation is easy to explain, it may be a good idea.
Namespaces are one honking great idea -- let&#39;s do more of those!
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; import antigravity
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can see it &lt;a href=&#34;http://xkcd.com/353/&#34;&gt;here&lt;/a&gt; but here is the code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
import webbrowser
webbrowser.open(&#34;http://xkcd.com/353/&#34;)
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; import __hello__
Hello world...
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Importing a module&lt;/h3&gt;
&lt;p&gt;&amp;#39;import&amp;#39; is a python keyword.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; import keyword
&gt;&gt;&gt; keyword.iskeyword(&#39;import&#39;)
True
&gt;&gt;&gt; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When you say:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;import urllib
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Python does:&lt;/p&gt;

&lt;p&gt;sys.modules: looks for a cached module&lt;/p&gt;

&lt;p&gt;sys meta_path and name lookup magic here&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Quote:

&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;
This allows meta hooks to override sys.path processing,
frozen modules, or even built-in modules
&amp;lt;&amp;#47;code&amp;gt;&amp;lt;&amp;#47;pre&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;sys.path: Looks for module by name&lt;/p&gt;

&lt;p&gt;&amp;ndash;&amp;gt; &lt;a href=&#34;http://docs.python.org/dev/reference/import.html#loaders&#34;&gt;Loads&lt;/a&gt; the module or raises an &lt;a href=&#34;http://docs.python.org/dev/library/exceptions.html#ImportError&#34;&gt;ImportError&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
The importlib implementation avoids using the return value directly.
Instead, it gets the module object by looking the module name up in sys.modules.
The indirect effect of this is that an imported module may replace itself in sys.modules.
This is implementation-specific behavior that is not guaranteed to work in other Python implementations.
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; if &#39;urllib&#39; in sys.modules:
...    print &#39;yes!&#39;
... 
yes!
&gt;&gt;&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&amp;#39;urllib&amp;#39; is now part of the namespace of my program and references the stdlib module.&lt;/p&gt;
&lt;h4&gt;Where did I find the module using sys.path?&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; print urllib.__file__
/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/urllib.pyc
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Import and Namespace&lt;/h3&gt;&lt;h4&gt;Top level imports are global variables&lt;/h4&gt;
&lt;p&gt;Before importing os:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; print globals()
{&#39;__builtins__&#39;: &lt;module &#39;__builtin__&#39; (built-in)&gt;, &#39;__name__&#39;: &#39;__main__&#39;, &#39;__file__&#39;: &#39;test.py&#39;, &#39;__doc__&#39;: None, &#39;__package__&#39;: None}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After importing os:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; import os
&gt;&gt;&gt; print globals()

{&#39;__builtins__&#39;: &lt;module &#39;__builtin__&#39; (built-in)&gt;, &#39;__file__&#39;: &#39;test.py&#39;, &#39;__package__&#39;: None, &#39;__name__&#39;: &#39;__main__&#39;, &#39;os&#39;: &lt;module &#39;os&#39; from &#39;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/os.pyc&#39;&gt;, &#39;__doc__&#39;: None}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;imports inside a function are local&lt;/h4&gt;
&lt;p&gt;json does not show up in my global dict even though I have imported it. Because&lt;br&gt;
it is contained in the local namespace of my foo() function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; def foo():
...     import json
... 
&gt;&gt;&gt; foo()
&gt;&gt;&gt; print globals()

{&#39;__builtins__&#39;: &lt;module &#39;__builtin__&#39; (built-in)&gt;, &#39;__name__&#39;: &#39;__main__&#39;, &#39;foo&#39;: &lt;function foo at 0x106b0f9b0&gt;, &#39;__doc__&#39;: None, &#39;__package__&#39;: None}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here json is shown in the local dictionary within foo(), but does not show up in globals.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; def foo():
...     import json
...     print locals()
... 
&gt;&gt;&gt; foo()
{&#39;json&#39;: &lt;module &#39;json&#39; from &#39;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/json/__init__.pyc&#39;&gt;}
&gt;&gt;&gt; print globals()
{&#39;__builtins__&#39;: &lt;module &#39;__builtin__&#39; (built-in)&gt;, &#39;__name__&#39;: &#39;__main__&#39;, &#39;foo&#39;: &lt;function foo at 0x10a5fd9b0&gt;, &#39;__doc__&#39;: None, &#39;__package__&#39;: None}
&gt;&gt;&gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;modules are objects&lt;/h3&gt;
&lt;p&gt;Exploring via &lt;a href=&#34;http://docs.python.org/2/library/functions.html#dir&#34;&gt;dir&lt;/a&gt; and &lt;a href=&#34;http://docs.python.org/2/library/functions.html#type&#34;&gt;type&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; import re
&gt;&gt;&gt; dir(re)
[&#39;DEBUG&#39;, &#39;DOTALL&#39;, &#39;I&#39;, &#39;IGNORECASE&#39;, &#39;L&#39;, &#39;LOCALE&#39;, &#39;M&#39;, &#39;MULTILINE&#39;, &#39;S&#39;, &#39;Scanner&#39;, 
&#39;T&#39;, &#39;TEMPLATE&#39;, &#39;U&#39;, &#39;UNICODE&#39;, &#39;VERBOSE&#39;, &#39;X&#39;, &#39;_MAXCACHE&#39;, &#39;__all__&#39;, &#39;__builtins__&#39;, 
&#39;__doc__&#39;, &#39;__file__&#39;, &#39;__name__&#39;, &#39;__package__&#39;, &#39;__version__&#39;, &#39;_alphanum&#39;, &#39;_cache&#39;,
&#39;_cache_repl&#39;, &#39;_compile&#39;, &#39;_compile_repl&#39;, &#39;_expand&#39;, &#39;_pattern_type&#39;, &#39;_pickle&#39;, &#39;_subx&#39;,
&#39;compile&#39;, &#39;copy_reg&#39;, &#39;error&#39;, &#39;escape&#39;, &#39;findall&#39;, &#39;finditer&#39;, &#39;match&#39;, &#39;purge&#39;, &#39;search&#39;,
&#39;split&#39;, &#39;sre_compile&#39;, &#39;sre_parse&#39;, &#39;sub&#39;, &#39;subn&#39;, &#39;sys&#39;, &#39;template&#39;]
&gt;&gt;&gt; 
&gt;&gt;&gt; type(re)
&lt;type &#39;module&#39;&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can access their attributes.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; import re
&gt;&gt;&gt; print re.__doc__
Support for regular expressions (RE).

This module provides regular expression matching operations similar to
those found in Perl.  It supports both 8-bit and Unicode strings; both
the pattern and the strings being processed can contain null bytes and
characters outside the US ASCII range.

Regular expressions can contain both special and ordinary characters.
Most ordinary characters, like &#34;A&#34;, &#34;a&#34;, or &#34;0&#34;, are the simplest
regular expressions; they simply match themselves.  You can
concatenate ordinary characters, so last matches the string &#39;last&#39;.

--- excluded for brevity ---
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;&lt;strong&gt;future&lt;/strong&gt; allows use of future features&lt;/h3&gt;&lt;h4&gt;&lt;a href=&#34;http://docs.python.org/2/reference/simple_stmts.html#future-statements&#34;&gt;&lt;strong&gt;future&lt;/strong&gt;&lt;/a&gt; is not at its heart a module import&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
A future statement is a directive to the compiler that a particular module
should be compiled using syntax or semantics that will be available in a
specified future release of Python. The future statement is intended to ease
migration to future versions of Python that introduce incompatible changes to
the language. It allows use of the new features on a per-module basis before
the release in which the feature becomes standard.
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;future statements need to be at the top of the file&lt;/li&gt;
&lt;li&gt;future statements change how your module is parsed&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;That&amp;#39;s why this namespace import seems funky.  It&amp;#39;s not a standard import&amp;#39;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; from __future__ import print_function
#is still &#39;print&#39; and not &#39;print_function&#39; call
print(&#39;wtf&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://ericsnowcurrently.blogspot.com/p/python-imports.html&#34;&gt;imports one&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://utcc.utoronto.ca/%7Ecks/space/blog/python/ImportTricks&#34;&gt;imports two&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.python.org/2/library/imp.html&#34;&gt;imp docs&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://pymotw.com/2/imp/&#34;&gt;imp module motw&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.slideshare.net/audreyr/python-tricks-that-you-cant-live-without&#34;&gt;python-tricks-that-you-cant-live-without&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://blog.dowski.com/2008/07/31/customizing-the-python-import-system/&#34;&gt;customizing-the-python-import-system&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.python.org/2/library/__future__.html&#34;&gt;future statements&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.python.org/2/reference/simple_stmts.html#future-statements&#34;&gt;future statements summary&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://stackoverflow.com/questions/7075082/what-is-future-in-python-used-for-and-how-when-to-use-it-and-how-it-works&#34;&gt;so future staments&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.python.org/dev/peps/pep-0420/&#34;&gt;PEP 420 &amp;ndash; Implicit Namespace Packages&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>happy sysadmin day</title>
                <link rel="alternate" href="/2013/07/26/happy-sysadmin-day/" type="text/html" />
                <id>/2013/07/26/happy-sysadmin-day/</id>
                <updated>2013-07-26T16:43:00Z</updated>
                
                <summary type="html">&lt;center&gt;&lt;object width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;param name=&#34;movie&#34; value=&#34;http://www.youtube.com/v/HU92ryHp_Fg&amp;amp;hl=en_US&amp;amp;fs=1&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowFullScreen&#34; value=&#34;true&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowscriptaccess&#34; value=&#34;always&#34;&gt;&lt;/param&gt;&lt;embed src=&#34;http://www.youtube.com/v/HU92ryHp_Fg&amp;amp;hl=en_US&amp;amp;fs=1&#34; type=&#34;application/x-shockwave-flash&#34; allowscriptaccess=&#34;always&#34; allowfullscreen=&#34;true&#34; width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;/embed&gt;&lt;/object&gt;&lt;/center&gt;</summary>
                <content type="html">&lt;p&gt;&lt;center&gt;&lt;object width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;param name=&#34;movie&#34; value=&#34;http://www.youtube.com/v/HU92ryHp_Fg&amp;amp;hl=en_US&amp;amp;fs=1&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowFullScreen&#34; value=&#34;true&#34;&gt;&lt;/param&gt;&lt;param name=&#34;allowscriptaccess&#34; value=&#34;always&#34;&gt;&lt;/param&gt;&lt;embed src=&#34;http://www.youtube.com/v/HU92ryHp_Fg&amp;amp;hl=en_US&amp;amp;fs=1&#34; type=&#34;application/x-shockwave-flash&#34; allowscriptaccess=&#34;always&#34; allowfullscreen=&#34;true&#34; width=&#34;480&#34; height=&#34;385&#34;&gt;&lt;/embed&gt;&lt;/object&gt;&lt;/center&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>ubuntu edge</title>
                <link rel="alternate" href="/2013/07/25/ubuntu-edge/" type="text/html" />
                <id>/2013/07/25/ubuntu-edge/</id>
                <updated>2013-07-25T21:39:00Z</updated>
                
                <summary type="html">&lt;center&gt;&lt;img src=&#34;/assets/images/edge/edgeshow.png&#34; alt=&#34;edge&#34; title=&#34;edge promo&#34;&gt;&lt;/center&gt;</summary>
                <content type="html">&lt;p&gt;&lt;center&gt;&lt;img src=&#34;/assets/images/edge/edgeshow.png&#34; alt=&#34;edge&#34; title=&#34;edge promo&#34;&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;I started using Ubuntu around early 2006, and even though Debian is still my first love as a server OS at this point.  I have great respect for the canonical folks and use it as my primary desktop OS.&lt;/p&gt;

&lt;p&gt;I hate carrier lockin for phones, I bought a &lt;a href=&#34;http://www.google.com/nexus/4/&#34;&gt;nexus&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I use my phone increasingly to replace my laptop.&lt;/p&gt;

&lt;p&gt;Pentesting will never be the same.&lt;/p&gt;
&lt;h4&gt;Contributing&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.indiegogo.com/projects/ubuntu-edge&#34;&gt;Donate Here&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/edge/edgeperk.png&#34; alt=&#34;edgeperk&#34; title=&#34;perk&#34;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/edge/edgethanks.png&#34; alt=&#34;edgethanks&#34; title=&#34;thanks&#34;&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/edge/edgeraised.png&#34; alt=&#34;edgeraised&#34; title=&#34;raised&#34;&gt;&lt;/p&gt;
&lt;h4&gt;Refernence&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.reddit.com/r/IAmA/comments/1j166z/hi_im_mark_shuttleworth_founder_of_ubuntu/&#34;&gt;reddit ama&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.indiegogo.com/projects/ubuntu-edge&#34;&gt;indiegogo&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://techcrunch.com/2013/07/25/if-the-ubuntu-edge-crowdfunding-experiment-works-backers-may-get-to-vote-on-the-next-models-specs/&#34;&gt;techcrunch&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>iproute2 usage</title>
                <link rel="alternate" href="/2013/07/25/iproute2-usage/" type="text/html" />
                <id>/2013/07/25/iproute2-usage/</id>
                <updated>2013-07-25T03:29:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;remove all addresses&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;ip addr flush dev eth0
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.linuxfoundation.org/collaborate/workgroups/networking/iproute2&#34;&gt;iproute2 docs&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>su directive logrotate</title>
                <link rel="alternate" href="/2013/07/24/su-directive-logrotate/" type="text/html" />
                <id>/2013/07/24/su-directive-logrotate/</id>
                <updated>2013-07-24T16:44:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;If the parent directory for logging is world writable and not owned by root logrotate needs to know what user should be used to rotate.&lt;/p&gt;
&lt;h4&gt;Log Dir&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
me@vm#ls -al /var/log/myapp/
total 1728
drwxrwxrwx  2 appuser appuser   4096 Jul 24 13:45 .
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;My logrotate:&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
/var/log/myapp/*.log {

    weekly
    rotate 4
    compress

    delaycompress
    missingok
    create 644 appuser appuser
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Manual logrotate&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;#47;usr&amp;#47;sbin&amp;#47;logrotate --verbose &amp;#47;etc&amp;#47;logrotate.conf
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Looks Like&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
rotating pattern: /var/log/myapp/*.log  weekly (4 rotations)
empty log files are rotated, old logs are removed
considering log /var/log/myapp/default.log

error: skipping &#34;/var/log/myapp/default.log&#34; because parent directory has insecure permissions
(It&#39;s world writable or writable by group which is not &#34;root&#34;) Set &#34;su&#34; directive in 
config file to tell logrotate which user/group should be used for rotation
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Telling logrotate to do the &amp;#39;right thing&amp;#39;&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
/var/log/myapp/*.log {
    su appuser appuser #&lt;--NEW
    weekly
    rotate 4
    compress

    delaycompress
    missingok
    create 644 appuser appuser
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Manually running logrotate post fix&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
rotating pattern: /var/log/myapp/*.log  weekly (4 rotations)
empty log files are rotated, old logs are removed
switching euid to 108 and egid to 108
considering log /var/log/myapp/default.log
  log needs rotating
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Other solution&lt;/h4&gt;
&lt;p&gt;Depending on why you need the above permissions on your log directory.  This&lt;br&gt;
may not be the way to go.  But if you can less permissive is always better.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;chmod 0640 &amp;#47;var&amp;#47;log&amp;#47;myapp&amp;#47;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://linux.die.net/man/8/logrotate&#34;&gt;logrotate man&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>ubuntuforums.org hacked bummer</title>
                <link rel="alternate" href="/2013/07/22/ubuntuforums.org-hacked-bummer/" type="text/html" />
                <id>/2013/07/22/ubuntuforums.org-hacked-bummer/</id>
                <updated>2013-07-22T03:29:00Z</updated>
                
                <summary type="html">I got this email today:</summary>
                <content type="html">&lt;p&gt;I got this email today:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/ubuntuforumshacked.png&#34; alt=&#34;ubuntu hacked&#34; title=&#34;Ubuntu Forums Hacked&#34;&gt;&lt;/p&gt;

&lt;p&gt;Over the weekend the forums looked like:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/ubuntuforumshacked2.png&#34; alt=&#34;ubuntu hacked penguin&#34; title=&#34;Ubuntu Forums Hacked Penguin&#34;&gt;&lt;/p&gt;

&lt;p&gt;Now the forums looks like:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/ubuntuforumshacked3.png&#34; alt=&#34;ubuntu notice&#34; title=&#34;Ubuntu Forums Hack Message&#34;&gt;&lt;/p&gt;

&lt;p&gt;This is the second time credentials associated with me have been released from a security&lt;br&gt;
breach.  The first was &lt;a href=&#34;http://chasemp.github.io/2013/05/09/name.com-bummer/&#34;&gt;name.com hacked&lt;/a&gt;.&lt;/p&gt;
&lt;h4&gt;Update&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://blog.canonical.com/2013/07/30/ubuntu-forums-are-back-up-and-a-post-mortem/&#34;&gt;Post Mortem&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.infosecurity-magazine.com/view/33556/ubuntu-forum-hacked-18-million-accounts-compromised/&#34;&gt;infosec mag article&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://nakedsecurity.sophos.com/2013/07/21/gun-wielding-penguin-takes-over-ubuntu-forums-waves-ak-47-at-linux-users-everywhere/&#34;&gt;blog post info&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.dailydot.com/technology/password-sputn1k-hack-ubuntu-forums/&#34;&gt;daily dot report&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>mcollective bugs debian wheezy</title>
                <link rel="alternate" href="/2013/07/16/mcollective-bugs-debian-wheezy/" type="text/html" />
                <id>/2013/07/16/mcollective-bugs-debian-wheezy/</id>
                <updated>2013-07-16T21:39:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Debian Wheezy is on mcollective 2.0.  There are several agents that require at least 2.2.  You can download from the official PuppetLabs repository version but for Wheezy there are several bugs.  &lt;/p&gt;
&lt;h4&gt;Dowloading official Package&lt;/h4&gt;
&lt;p&gt;Do this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://docs.puppetlabs.com/guides/puppetlabs_package_repositories.html&#34;&gt;http://docs.puppetlabs.com/guides/puppetlabs_package_repositories.html&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget http:&amp;#47;&amp;#47;apt-enterprise.puppetlabs.com&amp;#47;puppetlabs-enterprise-release-extras_1.0-2_all.deb
sudo dpkg -i puppetlabs-enterprise-release-extras_1.0-2_all.deb
sudo apt-get update
aptitude install mcollective
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You will notice it doesn&amp;#39;t work.  Suck.  Ok let&amp;#39;s build our own.&lt;/p&gt;
&lt;h4&gt;Bug #1 &lt;a href=&#34;http://projects.puppetlabs.com/issues/16572&#34;&gt;fails to run on debian/ubuntu with ruby 1.9&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;The system default for ruby is 1.9.  Mcollective has ruby 1.8 paths hardcoded in several places, but&lt;br&gt;
the main binary uses the environment settings.  This mismatch causes issues.&lt;/p&gt;
&lt;h4&gt;Bug demonstration&lt;/h4&gt;
&lt;p&gt;/etc/init.d/mcollective restart&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
/usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require&#39;: cannot load such file -- mcollective (LoadError)
        from /usr/lib/ruby/1.9.1/rubygems/custom_require.rb:36:in `require&#39;
    from /usr/sbin/mcollectived:3:in `&lt;main&gt;&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;mcollective puts files under ruby 1.8&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;dpkg -L mcollective-common
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
/usr/lib/ruby/1.8/mcollective
/usr/lib/ruby/1.8/mcollective/logger
/usr/lib/ruby/1.8/mcollective/logger/syslog_logger.rb
/usr/lib/ruby/1.8/mcollective/logger/base.rb
/usr/lib/ruby/1.8/mcollective/logger/console_logger.rb
/usr/lib/ruby/1.8/mcollective/logger/file_logger.rb
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;But Wheezy uses 1.9&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Simple Fix&lt;/h4&gt;
&lt;p&gt;vi bin/mcollectived&lt;/p&gt;

&lt;p&gt;This:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!&amp;#47;usr&amp;#47;bin&amp;#47;env ruby 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Becomes:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!&amp;#47;usr&amp;#47;bin&amp;#47;ruby1.8
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Bug 2: &lt;a href=&#34;http://projects.puppetlabs.com/issues/17804&#34;&gt;ubuntu/debian mcollective missing package dependencies&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;Depencies are not complete for Debian.&lt;/p&gt;
&lt;h4&gt;Looks Like&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;#47;usr&amp;#47;lib&amp;#47;ruby&amp;#47;vendor_ruby&amp;#47;1.8&amp;#47;rubygems&amp;#47;custom_require.rb:36:in
`gem_original_require&amp;#39;: no such file to load - -- stomp
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Simple Fix&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo apt-get install ruby-stomp
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Stomp Connector Not Included&lt;/h4&gt;
&lt;p&gt;This is not my code, it is from somewhere in the mcollective world.  Including here&lt;br&gt;
for completeness.&lt;/p&gt;

&lt;p&gt;mcollective/connectors/stomp.rb&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://raw.github.com/chasemp/bin/master/mcollective/stomp.rb&#34;&gt;stomp.rb&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://askubuntu.com/questions/15211/saving-deb-files-from-repositories-to-a-custom-location-for-installing-offline&#34;&gt;download debs&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://projects.puppetlabs.com/issues/17804&#34;&gt;puppet bug&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://groups.google.com/forum/#!topic/mcollective-users/5o8QT_myk0M&#34;&gt;google groups info&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://serverfault.com/questions/386646/mcollective-cannot-load-the-stomp-library&#34;&gt;sf mc info&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/puppetlabs/marionette-collective/tree/master/spec&#34;&gt;mc on gh&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://groups.google.com/forum/#!msg/puppet-users/oYLo9VuZtTk/OCwyAWz-xc4J&#34;&gt;google groups info two&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>making debs with rake</title>
                <link rel="alternate" href="/2013/07/12/making-debs-with-rake/" type="text/html" />
                <id>/2013/07/12/making-debs-with-rake/</id>
                <updated>2013-07-12T03:27:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Some Rake files have built in logic to make a debian binary. &lt;/p&gt;
&lt;h4&gt;Mcollective&lt;/h4&gt;
&lt;p&gt;A good example:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git clone https:&amp;#47;&amp;#47;github.com&amp;#47;puppetlabs&amp;#47;marionette-collective
cd marionette-collective&amp;#47;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Getting Packages&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install rake \
build-essential 
rubygem \
pdebuild-cross \
devscripts \
fakeroot \
dpatch
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Making Debian Package&lt;/h4&gt;
&lt;p&gt;rake deb&lt;/p&gt;
&lt;h4&gt;Looks Like&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
rm -r build
rm -r doc
Parsing sources...

&lt;omitted&gt;

dpkg-deb: building package `mcollective&#39; in `../mcollective_2.3.2-1_all.deb&#39;.
dh_gencontrol -pmcollective-client  
dpkg-gencontrol: warning: File::FcntlLock not available; using flock which is not NFS-safe
dh_md5sums -pmcollective-client 
dh_builddeb -pmcollective-client 
dpkg-deb: building package `mcollective-client&#39; in `../mcollective-client_2.3.2-1_all.deb&#39;.
dh_gencontrol -pmcollective-common  
dpkg-gencontrol: warning: File::FcntlLock not available; using flock which is not NFS-safe
dh_md5sums -pmcollective-common 
dh_builddeb -pmcollective-common 
dpkg-deb: building package `mcollective-common&#39; in `../mcollective-common_2.3.2-1_all.deb&#39;.
dh_gencontrol -pmcollective-doc  
dpkg-gencontrol: warning: File::FcntlLock not available; using flock which is not NFS-safe
dh_md5sums -pmcollective-doc 
dh_builddeb -pmcollective-doc 
dpkg-deb: building package `mcollective-doc&#39; in `../mcollective-doc_2.3.2-1_all.deb&#39;.
 dpkg-genchanges  &gt;../mcollective_2.3.2-1_amd64.changes
dpkg-genchanges: including full source code in upload
 dpkg-source -i --after-build mcollective-2.3.2
dpkg-buildpackage: full upload (original source is included)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Normal install&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;dpkg -i mcollective_2.3.2-1_all.deb
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>memcollective tricks</title>
                <link rel="alternate" href="/2013/07/10/memcollective-tricks/" type="text/html" />
                <id>/2013/07/10/memcollective-tricks/</id>
                <updated>2013-07-10T05:38:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;mcollective-isms.  &lt;/p&gt;
&lt;h4&gt;Find all hosts&lt;/h4&gt;
&lt;p&gt;Create an shortcut&lt;/p&gt;

&lt;p&gt;/usr/local/bin/mc-find-hosts&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#!/bin/bash
if [ &#34;$1&#34; == &#34;&#34; ]; then
    /usr/bin/mco find --wc mcollective
else
    /usr/bin/mco find $@

&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;mc-find-hosts
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Find host by name matching&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mc-find-hosts --with-id &amp;#47;foo&amp;#47;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Find hosts by puppet class&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;#47;usr&amp;#47;sbin&amp;#47;mc-find-hosts --with-class &amp;lt;class_name&amp;gt; | sort
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Query service status by class&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mco service --with-class &amp;#47;apache&amp;#47; apache2 status
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Getting stats about the service itself&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mco rpc rpcutil daemon_stats
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Restarting a service&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mco service --with-identity &amp;lt;host&amp;gt; &amp;lt;service&amp;gt; restart
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Find agents directory&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo find &amp;#47; -name rpcutil.ddl -exec dirname {} \;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Query a fact&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mco facts &amp;lt;fact_name&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Query Puppet Status and get JSON in return&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mco rpc puppet status -j
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>when search tells the story</title>
                <link rel="alternate" href="/2013/07/08/when-search-tells-the-story/" type="text/html" />
                <id>/2013/07/08/when-search-tells-the-story/</id>
                <updated>2013-07-08T21:38:00Z</updated>
                
                <summary type="html">The first and second results for &amp;#39;linux emoji font&amp;#39; are from the same person, and in total opposition.  I don&amp;#39;t know this person at all; I just found the rankings humorous.</summary>
                <content type="html">&lt;p&gt;The first and second results for &amp;#39;linux emoji font&amp;#39; are from the same person, and in total opposition.  I don&amp;#39;t know this person at all; I just found the rankings humorous.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/emojinope.png&#34; alt=&#34;enabling emoji&#34; title=&#34;Emoji&#34;&gt;&lt;/p&gt;

&lt;p&gt;Emoji is basically japanese emoticons.&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/Emoji&#34;&gt;emoji wiki&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>puppetmaster_3 on debian</title>
                <link rel="alternate" href="/2013/06/27/puppetmaster3-on-debian/" type="text/html" />
                <id>/2013/06/27/puppetmaster3-on-debian/</id>
                <updated>2013-06-27T03:27:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Getting puppetmaster 3.0 on Debian (still squeeze)&lt;/p&gt;

&lt;p&gt;I am trying to test and I keep seeing:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Syntax error at &amp;#39;(&amp;#39;; expected &amp;#39;)&amp;#39; at &amp;#47;repo&amp;#47;modules&amp;#47;apache&amp;#47;manifests&amp;#47;module.pp:34 on node test
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I have seen this before and I know it is a result of manifests written for &amp;gt;3.0, at least for this&lt;/p&gt;

&lt;p&gt;specific issue.  That error is rather generic in general.&lt;/p&gt;
&lt;h4&gt;Can I use backports?&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude update
aptitude -t squeeze-backports install puppetmaster

--&amp;gt; puppet: Depends: puppet-common (= 2.6.2-5+squeeze6) but 2.6.2-5+squeeze8 is to be installed.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;No, backports is still pretty old.&lt;/p&gt;
&lt;h4&gt;Using the Official Repo&lt;/h4&gt;
&lt;p&gt;Luckily, PuppetEnterprises publishes a deb for adding their repo.  Similar to what rpmforge does for any&lt;br&gt;
CentOS folks.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;wget http:&amp;#47;&amp;#47;apt.puppetlabs.com&amp;#47;puppetlabs-release-sqeeze.deb
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;ndash;&amp;gt; 2013-06-27 16:11:21 (159 MB/s) - “puppetlabs-release-squeeze.deb” saved [3440/3440]&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dpkg -i puppetlabs-release-squeeze.deb 
cat &amp;#47;etc&amp;#47;apt&amp;#47;sources.list.d&amp;#47;puppetlabs.list
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
# Puppetlabs products
deb http://apt.puppetlabs.com squeeze main
deb-src http://apt.puppetlabs.com squeeze main

# Puppetlabs dependencies
deb http://apt.puppetlabs.com squeeze dependencies
deb-src http://apt.puppetlabs.com squeeze dependencies

# Puppetlabs devel (uncomment to activate)
# deb http://apt.puppetlabs.com squeeze devel
# deb-src http://apt.puppetlabs.com squeeze devel
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;sudo aptitude update
apt-cache show puppetmaster

--&amp;gt; Package: puppetmaster
--&amp;gt; Version: 2.6.2-5+squeeze6


aptitude install puppetmaster

--&amp;gt; Package: puppetmaster
--&amp;gt; ...
--&amp;gt; Version: 3.2.2-1puppetlabs1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Reference:&lt;br&gt;
&lt;a href=&#34;http://unix.stackexchange.com/questions/39261/how-to-see-package-version-without-install&#34;&gt;view available packages&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.puppetlabs.com/guides/puppetlabs####%20package####%20repositories.html&#34;&gt;puppet repo&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://packages.debian.org/search?keywords=puppetmaster&amp;amp;searchon=names&amp;amp;section=all&amp;amp;suite=squeeze-backports&#34;&gt;backports search&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://backports.debian.org/Instructions/&#34;&gt;backports howto&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>simple site loadtesting</title>
                <link rel="alternate" href="/2013/06/25/simple-site-loadtesting/" type="text/html" />
                <id>/2013/06/25/simple-site-loadtesting/</id>
                <updated>2013-06-25T17:23:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Throwing some load at your setup and seeing how it reacts.&lt;/p&gt;

&lt;p&gt;There is a difference between problem solving, and solving problems &lt;em&gt;at scale&lt;/em&gt;.&lt;/p&gt;
&lt;h4&gt;Get some tools&lt;/h4&gt;
&lt;p&gt;On your user host:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aptitude install httping seige apache2 bc
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;On your webserver:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aptitude install htop
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Seige is a lowkey load test tool, httping is nice for measuring response times in a consistent way while load testing, and apache is because we want the apache benchmark tool or &amp;#39;ab&amp;#39;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;root@&amp;lt;lhost&amp;gt;:~# which ab
&amp;#47;usr&amp;#47;bin&amp;#47;ab
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Launching a test with seige: 3 concurrent users with 3 connections&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;~# siege -b -c 3 -r 3 &amp;lt;webserver&amp;gt;:80
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
** SIEGE 2.70
** Preparing 3 concurrent users for battle.
The server is now under siege...
HTTP/1.1 200   0.01 secs:     146 bytes ==&gt; /
HTTP/1.1 200   0.01 secs:     146 bytes ==&gt; /
HTTP/1.1 200   0.01 secs:     146 bytes ==&gt; /
HTTP/1.1 200   0.00 secs:     146 bytes ==&gt; /
HTTP/1.1 200   0.00 secs:     146 bytes ==&gt; /
HTTP/1.1 200   0.00 secs:     146 bytes ==&gt; /
HTTP/1.1 200   0.00 secs:     146 bytes ==&gt; /
HTTP/1.1 200   0.00 secs:     146 bytes ==&gt; /
HTTP/1.1 200   0.00 secs:     146 bytes ==&gt; /
done.
Transactions:                  9 hits
Availability:             100.00 %
Elapsed time:               0.01 secs
Data transferred:           0.00 MB
Response time:              0.00 secs
Transaction rate:         900.00 trans/sec
Throughput:             0.13 MB/sec
Concurrency:                3.00
Successful transactions:           9
Failed transactions:               0
Longest transaction:            0.01
Shortest transaction:           0.00
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is not a great indicator of performance under load.&lt;/p&gt;

&lt;p&gt;When I raise it to 3000 users at 10 requests I start seeing:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;descriptor table full sock.c:108: Too many open files
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So I raise the descriptor limit.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;#47;proc&amp;#47;sys&amp;#47;fs&amp;#47;file-max
1645928
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can see your limits using:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ulimit -Sn
ulimit -Hn
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now I see too much of:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;socket: connection timed out
[error] socket: unable to connect sock.c:222: Operation already in progress
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So I&amp;#39;m not too happy with seige.  For some tests it seems ok.  For large test pools it hasn&amp;#39;t won me over.  Then again the launching host isn&amp;#39;t that great so maybe it&amp;#39;s on my side.&lt;/p&gt;

&lt;p&gt;A good compromise I found was:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;siege -b -c 1000 -r 3 &amp;lt;webserver&amp;gt;:80
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Trying ab&amp;hellip;&lt;/h4&gt;
&lt;p&gt;A thousand concurrent threads with a thousand requests.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ab -n 1000 -c 1000 http:&amp;#47;&amp;#47;&amp;lt;webserver&amp;gt;&amp;#47;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
This is ApacheBench, Version 2.3 &lt;$Revision: 655654 $&gt;
Copyright 1996 Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking &lt;webserver&gt; (be patient)
Completed 100 requests
Completed 200 requests
Completed 300 requests
Completed 400 requests
Completed 500 requests
Completed 600 requests
Completed 700 requests
Completed 800 requests
Completed 900 requests
Completed 1000 requests
Finished 1000 requests


Server Software:        Apache/2.2.16
Server Hostname:        &lt;webserver&gt;
Server Port:            80

Document Path:          /
Document Length:        177 bytes

Concurrency Level:      1000
Time taken for tests:   0.656 seconds
Complete requests:      1000
Failed requests:        0
Write errors:           0
Total transferred:      453000 bytes
HTML transferred:       177000 bytes
Requests per second:    1523.82 [#/sec] (mean)
Time per request:       656.246 [ms] (mean)
Time per request:       0.656 [ms] (mean, across all concurrent requests)
Transfer rate:          674.11 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:       11   15   2.9     15      21
Processing:     6  158 209.8     32     631
Waiting:        5  158 209.9     32     631
Total:         20  174 210.7     53     646

Percentage of the requests served within a certain time (ms)
  50%     53
  66%    234
  75%    237
  80%    238
  90%    642
  95%    645
  98%    646
  99%    646
 100%    646 (longest request)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;ab gives great data, and can generate a lot of load with minimal impact on&lt;br&gt;
the launching system.&lt;/p&gt;

&lt;p&gt;I eventually settled on:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ab -k -n 2000000 -c 50 http:&amp;#47;&amp;#47;&amp;lt;webserver&amp;gt;&amp;#47;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Use http-keepalive (for consistency with production) at 2 million requests making 50 simultaneously.  These numbers were hitting a load of 8+ on my test server.  Anything averaging over 3.5 in production would be flagged to look at, but load testing is all about pushing limits.  &lt;/p&gt;

&lt;p&gt;Getting macro numbers from ab.  Run your tests a lot and look at overall numbers.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;for i in {1..3}; do ab -n 1000 -c 1000 http:&amp;#47;&amp;#47;&amp;lt;webserver&amp;gt;&amp;#47; &amp;gt;&amp;gt; test.txt; done
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;What is the average response time for request in the 95th percentile?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;grep 95% test.txt | awk &amp;#39;{total = total + $2}END{print total}&amp;#39; 

4556 #&amp;lt;-- total number
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I know I made 3 passes so my average 95th percentile response is:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;echo &amp;quot;4556 &amp;#47; 3&amp;quot; | bc

1518 (ms)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This number is of limited value but adding your 95% through 100% and figuring out what your response times are for 95th perctile and above can be useful.&lt;/p&gt;

&lt;p&gt;Something like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;grep -A 3 95% test.txt | awk &amp;#39;{total = total + $2}END{print total}&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;httping&lt;/h4&gt;
&lt;p&gt;I like using httping in the background or on another host as a consistent measure of my response times.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;httping -c 10 &amp;lt;webserver&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This makes 10 requests that look like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;connected to &amp;lt;webserver&amp;gt;:80, seq=0 time=0.97 ms 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I like to flood the host with requests:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;httping &amp;lt;webserver&amp;gt;  -f
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://linuxaria.com/article/put-your-site-under-siege?lang=en&#34;&gt;using seige&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cyberciti.biz/faq/linux-increase-the-maximum-number-of-open-files/&#34;&gt;increase file desc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.serverwatch.com/tutorials/article.php/3936526/Load-Testing-and-Benchmarking-With-Siege.htm&#34;&gt;using seige 2&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://httpd.apache.org/docs/2.2/programs/ab.html&#34;&gt;using ab&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.joedog.org/siege-home/&#34;&gt;seige home&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://linux.die.net/man/1/siege&#34;&gt;seige man&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>carna internet map</title>
                <link rel="alternate" href="/2013/06/17/carna-internet-map/" type="text/html" />
                <id>/2013/06/17/carna-internet-map/</id>
                <updated>2013-06-17T03:25:00Z</updated>
                
                <summary type="html">&lt;img src=&#34;/assets/images/carna.gif&#34; alt=&#34;carna&#34; title=&#34;botnet map&#34;&gt;</summary>
                <content type="html">&lt;p&gt;&lt;img src=&#34;/assets/images/carna.gif&#34; alt=&#34;carna&#34; title=&#34;botnet map&#34;&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.tripwire.com/state-of-security/it-security-data-protection/cyber-security/state-of-security-carna-botnet-ipv4-census-nsa-offensive-cyber-powers-2013-threat-report&#34;&gt;tripwire doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://threatpost.com/carna-botnet-analysis-renders-scary-numbers-on-vulnerable-devices/&#34;&gt;threatpost doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://blog.caida.org/best_available_data/2013/05/13/carna-botnet-scans/&#34;&gt;blog post&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://seclists.org/fulldisclosure/2013/May/160&#34;&gt;sec list info&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://en.wikipedia.org/wiki/Carna_Botnet&#34;&gt;wikipedia&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>debian graphite install</title>
                <link rel="alternate" href="/2013/06/15/debian-graphite-install/" type="text/html" />
                <id>/2013/06/15/debian-graphite-install/</id>
                <updated>2013-06-15T05:05:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Basic graphite install.&lt;/p&gt;
&lt;h4&gt;Installs&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
aptitude update
apt-get install -y python2.6 \
                   python-pip \
                   python-cairo \
                   python-django \
                   python-django-tagging \
                   libapache2-mod-wsgi \
                   python-twisted \
                   python-memcache \
                   python-pysqlite2 \
                   python-simplejson \
                   apache2 \
                   libapache2-mod-wsgi
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
pip install whisper
pip install carbon
pip install graphite-web
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
wget https://raw.github.com/tmm1/graphite/master/examples/example-graphite-vhost.conf \
     -O /etc/apache2/sites-available/graphite
nano /etc/apache2/sites-available/graphite
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Example:&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
WSGISocketPrefix /var/run/apache2/wsgi

ServerName &lt;your_server_url&gt;
DocumentRoot &#34;/opt/graphite/webapp&#34;

#Allow our external dashboards, etc queries
Header set Access-Control-Allow-Origin &#34;*&#34;
Header set Access-Control-Allow-Methods &#34;GET, OPTIONS&#34;
Header set Access-Control-Allow-Headers &#34;origin, authorization, accept&#34;

# I&#39;ve found that an equal number of processes &amp; threads tends
# to show the best performance for Graphite (ymmv).
WSGIDaemonProcess graphite processes=5 threads=5 display-name=&#39;%{GROUP}&#39; inactivity-timeout=120
WSGIProcessGroup graphite
WSGIApplicationGroup %{GLOBAL}
WSGIImportScript /opt/graphite/conf/graphite.wsgi process-group=graphite application-group=%{GLOBAL}

WSGIScriptAlias / /opt/graphite/conf/graphite.wsgi 

#require radius for any access
&lt;Location /&gt;
    AuthType Basic
    AuthName &#34;Graphite auth&#34;
    #SETUP YOUR AUTH HERE
&lt;/Location&gt;

Alias /content/ /opt/graphite/webapp/content/
&lt;Location &#34;/content/&#34;&gt;
    SetHandler None
&lt;/Location&gt;

# XXX In order for the django admin site media to work you
# must change @DJANGO_ROOT@ to be the path to your django
# installation, which is probably something like:
# /usr/lib/python2.6/site-packages/django
Alias /media/ &#34;@DJANGO_ROOT@/contrib/admin/media/&#34;
&lt;Location &#34;/media/&#34;&gt;
    SetHandler None
&lt;/Location&gt;

# The graphite.wsgi file has to be accessible by apache. It won&#39;t
# be visible to clients because of the DocumentRoot though.
&lt;Directory /opt/graphite/conf/&gt;
    Order deny,allow
    Allow from all
&lt;/Directory&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;pre&gt;&lt;code&gt;
cd /opt/graphite/conf/
cp graphite.wsgi.example graphite.wsgi
cp carbon.conf.example carbon.conf
cp storage-schemas.conf.example storage-schemas.conf
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Setup django db&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;cd &amp;#47;opt&amp;#47;graphite&amp;#47;webapp&amp;#47;graphite
python manage.py syncdb
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Looks Like&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;hideme&#39;);&#34;&gt;Show Output&lt;/a&gt;&lt;/p&gt;

&lt;div id=&#34;hideme&#34; style=&#34;display:none;&#34;&gt;
&lt;pre&gt;&lt;code&gt;
Could not import graphite.local_settings, using defaults!
Could not import graphite.local_settings, using defaults!
Creating table account_profile
Creating table account_variable
Creating table account_view
Creating table account_window
Creating table account_mygraph
Creating table dashboard_dashboard_owners
Creating table dashboard_dashboard
Creating table events_event
Creating table auth_permission
Creating table auth_group_permissions
Creating table auth_group
Creating table auth_user_user_permissions
Creating table auth_user_groups
Creating table auth_user
Creating table auth_message
Creating table django_session
Creating table django_admin_log
Creating table django_content_type
Creating table tagging_tag
Creating table tagging_taggeditem

You just installed Django&#39;s auth system, which means you don&#39;t have any superusers defined.
Would you like to create one now? (yes/no): yes
Username (Leave blank to use &#39;root&#39;): 
E-mail address: 
Error: That e-mail address is invalid.
E-mail address: root@localhost.com
Password: 
Password (again): 
Superuser created successfully.
Installing index for account.Variable model
Installing index for account.View model
Installing index for account.Window model
Installing index for account.MyGraph model
Installing index for dashboard.Dashboard_owners model
Installing index for auth.Permission model
Installing index for auth.Group_permissions model
Installing index for auth.User_user_permissions model
Installing index for auth.User_groups model
Installing index for auth.Message model
Installing index for admin.LogEntry model
Installing index for tagging.TaggedItem model
No fixtures found.
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;
&lt;h4&gt;Enable site in Apache&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;a2dissite default
a2ensite graphite
sudo chmod -R a+w &amp;#47;opt&amp;#47;graphite&amp;#47;storage
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Start things&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;#47;opt&amp;#47;graphite&amp;#47;bin&amp;#47;carbon-cache.py start
&amp;#47;etc&amp;#47;init.d&amp;#47;apache2 restart
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;
&lt;p&gt;Logs are located here: /opt/graphite/storage/log/webapp/&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://greenlegos.wordpress.com/2012/09/09/graphite-installation/&#34;&gt;graphite install doc&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>code test beginnings</title>
                <link rel="alternate" href="/2013/06/07/unit-test-beginnings/" type="text/html" />
                <id>/2013/06/07/unit-test-beginnings/</id>
                <updated>2013-06-07T21:37:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Testing your code as you go.  Writing &amp;#39;production&amp;#39; code is really as much a set practices as it is a  specific coding ability.  Everyone breaks things.  When something breaks we will all fix it.  The trick is to always know when something breaks.&lt;/p&gt;

&lt;p&gt;How I currently see the world:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt; Write code&lt;/li&gt;
&lt;li&gt; Run unit tests&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;It continues on &amp;hellip;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt; Run integration tests&lt;/li&gt;
&lt;li&gt; Run QA/Functionality testing (this could be one and the same with previous)&lt;/li&gt;
&lt;li&gt; Test monitoring&lt;/li&gt;
&lt;li&gt; Test security&lt;/li&gt;
&lt;li&gt; Test at scale&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There are a lot of ways to break down this basic idea.  Some much better than this.  But I feel like if you can visualize these 7 you are going in the right direction.&lt;/p&gt;
&lt;h4&gt;Write Code&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;def what():
    return &amp;#39;123&amp;#39;

if __name__ == &amp;#39;__main__&amp;#39;:
    print what()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is my big application.  When I run it I see.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
   123
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Unit Testing - Testing Small Things&lt;/h4&gt;
&lt;p&gt;My idea of unittesting is if every function and class takes care of itself the entire codebase is better off.&lt;/p&gt;

&lt;p&gt;Doctest is a way to write small tests into the docstring.  Some people do not consider this to be valid unittesting.  I think it&amp;#39;s a good start.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;def what():
    &amp;quot;&amp;quot;&amp;quot;
    &amp;gt;&amp;gt;&amp;gt; what()
    &amp;#39;123&amp;#39;
    &amp;quot;&amp;quot;&amp;quot;
    return &amp;#39;123&amp;#39;

if __name__ == &amp;#39;__main__&amp;#39;:
    what()
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&amp;#39;python -m doctest t.py&amp;#39; returns nothing.&lt;/p&gt;
&lt;h4&gt;But:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;#39;python -m doctest t.py  -v&amp;#39; returns useful output:

Trying:
    what()
Expecting:
    &amp;#39;123&amp;#39;
ok
1 items had no tests:
    t
1items passed all tests:
   1 tests in t.what
1 tests in 2 items.
1 passed and 0 failed.
Test passed.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Everything passed.  In the most basic sense the code in the doctstring returned expected results.&lt;/p&gt;

&lt;p&gt;What if my function code changes and the doctest becomes invalid?&lt;/p&gt;

&lt;p&gt;Change it to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;def what():
    &amp;quot;&amp;quot;&amp;quot;
    &amp;gt;&amp;gt;&amp;gt; what()
    &amp;#39;1234&amp;#39;
    &amp;quot;&amp;quot;&amp;quot;
    return &amp;#39;123&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now we see:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&lt;me&gt;:~$ python -m doctest t.py -v
Trying:
    what()
Expecting:
    &#39;1234&#39;
**********************************************************************
File &#34;t.py&#34;, line 3, in t.what
Failed example:
    what()
Expected:
    &#39;1234&#39;
Got:
    &#39;123&#39;
1 items had no tests:
    t
**********************************************************************
1 items had failures:
   1 of   1 in t.what
1 tests in 2 items.
0 passed and 1 failed.
***Test Failed*** 1 failures.
&lt;me&gt;:~$ 
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;You can run this as a pre-commit hook and you will never break this function without knowing.&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mkdir repo
cd repo
git init
nano pre-commit
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Contents:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
python -m doctest *

cd .git&amp;#47;hooks&amp;#47;
ln -s ..&amp;#47;..&amp;#47;pre-commit pre-commit
cd ..&amp;#47;..
git add -A
git commit -m &amp;#39;test&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We see our failure message:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
**********************************************************************
File &#34;t.py&#34;, line 5, in t.what
Failed example:
    what()
Expected:
    &#39;1234&#39;
Got:
    &#39;123&#39;
**********************************************************************
1 items had failures:
   1 of   1 in t.what
***Test Failed*** 1 failures.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We can fix it and make good.&lt;/p&gt;
&lt;h4&gt;One step up from &amp;#39;-m doctest&amp;#39;&lt;/h4&gt;
&lt;p&gt;I like to use nose to run my tests.  It can handle tests written in multiple styles and most code review tools integrate with it.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aptitude install python-nose

nano pre-commit
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Contents:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
nosetests --all-modules --traverse-namespace --with-doctest --exe
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This output is more readable as your tests grow:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
&lt;me&gt;:~/no$ git commit -m &#39;nose&#39;
F
======================================================================
FAIL: Doctest: t.what
----------------------------------------------------------------------
Traceback (most recent call last):
  File &#34;/System/Library/Frameworks/Python.framework/Versions/2.7/lib/python2.7/doctest.py&#34;, line 2166, in runTest
    raise self.failureException(self.format_failure(new.getvalue()))
AssertionError: Failed doctest test for t.what
  File &#34;/Users/&lt;me&gt;/no/t.py&#34;, line 3, in what

----------------------------------------------------------------------
File &#34;/Users/&lt;me&gt;/no/t.py&#34;, line 5, in t.what
Failed example:
    what()
Expected:
    &#39;1234&#39;
Got:
    &#39;123&#39;


----------------------------------------------------------------------
Ran 1 test in 0.006s

FAILED (failures=1)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Separating your test from your function&lt;/h4&gt;
&lt;p&gt;Ok up until now we have been validating our docstring and that is valuable.  But it is also cluttered and can be unwieldy.  Writing a basic test function.  I also added &amp;#39;-v&amp;#39; to the nosetest hook.&lt;/p&gt;

&lt;p&gt;This function should literally start with &amp;#39;test&amp;#39;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
def test_what():
    assert what() == &#39;123&#39;

def what():
    return &#39;123&#39;

if __name__ == &#39;__main__&#39;:
    print what()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Looks like&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
t.test_what ... ok

----------------------------------------------------------------------
Ran 1 test in 0.002s

OK
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Thus the groundlevel for self testing code.&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://git-scm.com/book/en/Customizing-Git-Git-Hooks&#34;&gt;git hooks doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://nose.readthedocs.org/en/latest/&#34;&gt;nosetest&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>IOS DDOS detection</title>
                <link rel="alternate" href="/2013/06/05/cisco-ios-ddos-detection/" type="text/html" />
                <id>/2013/06/05/cisco-ios-ddos-detection/</id>
                <updated>2013-06-05T03:24:00Z</updated>
                
                
                <content type="html">&lt;h3&gt;Preamble&lt;/h3&gt;
&lt;p&gt;Basic DDOS detection and defense on IOS FW&lt;/p&gt;
&lt;h4&gt;Aliases&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;alias exec fstats show policy-firewall stats global
alias exec zstats show policy-firewall stats zone
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;IOS Zone Based FW Config&lt;/h4&gt;
&lt;p&gt;Per Zone&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;conf t
parameter-map type inspect-zone ddos-detection
 !this is per _your_ hosts not source hosts
 tcp syn-flood rate per-destination &amp;lt;global_syn_flood_rate_limit_per_host&amp;gt;&amp;gt;
 alert on
 threat-detection basic-threat
 !these alert limits should be changed to something reasonable for your environment
 threat-detection rate syn-attack average-time-frame 600 average-threshold 100 burst-threshold 100
 threat-detection rate inspect-drop average-time-frame 600 average-threshold 100 burst-threshold 100
 threat-detection rate fw-drop average-time-frame 600 average-threshold 100 burst-threshold 100

 !apply pmap to a zone
 zone security ZONE_INTERNET
  protection ddos-detection
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Global&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;parameter-map type inspect global
 !if you want a global sessions threshold
 session total 3000000
 !syn flood limit before going to syn cookies globally
 per-box tcp syn-flood limit 10000
 alert on
 !aging out sessions aggressively to help prevent table blocking
 per-box aggressive-aging high percent 85 low percent 65
 per-box max-incomplete 100000 aggressive-aging high percent 85 low percent 60
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Show Zone Stats&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;asr01#zstats
Zone: ZONE_INTERNET
Parameter-map: ddos-detection
TCP SYN packet conform limit: 0
TCP SYN packet exceed limit: 0
Threat Detection Statistics:
                        Average(eps)    Current(eps)    Threats Total Events
10-min SYN attack:      0               0               0               0
10-min FW inspect:      0               0               0               0
10-min FW policy:       0               0               0               0
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Show Global Stats&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;Global (Per-Box) statistics
Total Session Aggressive Aging Period Off, Event Count: 0

         Half Open  
Protocol Session Cnt     Exceed
-------- -----------     ------
All      0               0
UDP      0               0
ICMP     0               0
TCP      0               0
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Logging Shows&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;6052: Jun 6 01:41:28.864: %IOSXE-4-PLATFORM: F0:
cpp_cp: QFP:00 Thread:007 TS:00000106170032787836
%THREAT_DEFENSE-4-TD_ERM_AVERAGE_THREAT:
Event Rate Monitoring: Average threat identified.
Interface [&amp;lt;your_interface&amp;gt;], event type [firewall inspection drops],
average [101] configured threshold [100]
TCP Syn Flood Half Open Count: 1, Exceed: 0
Half Open Aggressive Aging Period Off, Event Count: 0
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>using snort on pcap</title>
                <link rel="alternate" href="/2013/06/03/using-snort-on-pcap/" type="text/html" />
                <id>/2013/06/03/using-snort-on-pcap/</id>
                <updated>2013-06-03T21:37:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Grabbing tcpdump output during a crisis can be hard to remember.  Ideally, snort is running as as service inline or at least continually.  Sometimes things happen outside of Snort&amp;#39;s purview or you are testing what Snort picks ups.&lt;/p&gt;
&lt;h4&gt;Install tools&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install snort snort-rules
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Capture your traffic&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;sudo tcpdump -w test
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Generate snort report&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;snort -r test -c &amp;#47;etc&amp;#47;snort&amp;#47;snort.conf -l .
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;View Alerts&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;less alert 

[**] [1:485:4] ICMP Destination Unreachable Communication Administratively Prohibited [**]
[Classification: Misc activity] [Priority: 3] 
05&amp;#47;19-01:23:00.201765 74.76.148.114 -&amp;gt; &amp;lt;my_ext_ip&amp;gt;
ICMP TTL:241 TOS:0x0 ID:32480 IpLen:20 DgmLen:56
Type:3  Code:13  DESTINATION UNREACHABLE: ADMINISTRATIVELY PROHIBITED,
PACKET FILTERED
** ORIGINAL DATAGRAM DUMP:
&amp;lt;my_ext_ip&amp;gt;:80 -&amp;gt; 74.76.148.114:25657
TCP TTL:47 TOS:0x0 ID:22893 IpLen:20 DgmLen:44
Seq: 0x654B5258
** END OF DUMP
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can edit your snort.conf for what kinds of signatures to look for.  ICMP can be a good indicator of shenanigans but is also very noisy.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>bash boiler plate troubleshooting</title>
                <link rel="alternate" href="/2013/05/30/bash-boiler-plate-troubleshooting/" type="text/html" />
                <id>/2013/05/30/bash-boiler-plate-troubleshooting/</id>
                <updated>2013-05-30T03:24:00Z</updated>
                
                
                <content type="html">&lt;h3&gt;Preamble&lt;/h3&gt;
&lt;p&gt;I have a bash script that is being called multiple times instead of once.&lt;br&gt;
I need to track down where it is being called from.&lt;/p&gt;

&lt;p&gt;Boiler plate that is nice for troubleshooting&lt;/p&gt;
&lt;h4&gt;Snippet&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
function trouble {
    echo &#34;--------------------&#34;
    date
    echo &#34;whoami: $(whoami)&#34;
    echo &#34;userid: $(id -u)&#34;
    echo &#34;My pid is $$&#34;
    echo &#34;working dir: $(pwd)&#34;
    echo &#34;Called as: $0&#34;
    echo &#34;Arguments: $@&#34;
    echo &#34;user_pstree_begin&#34;
    pstree $(whoami) -l
    echo &#34;user_pstree_end&#34;
    echo &#34;pid_pstree_begin&#34;
    pstree -np $$
    echo &#34;pid_pstree_end&#34;
    echo &#34;--------------------&#34;
}

set -x
epochtime=$(date +%s)
file=&#34;/tmp/debug-$epochtime.log&#34;
logger &#34;Creating: $file&#34;
trouble &gt; $file
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Looks like&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
&lt;me&gt;@&lt;host&gt;:~# cat /tmp/debug-1369940847.log 
--------------------
Thu May 30 12:07:27 PDT 2013
whoami: &lt;me&gt;
userid: 0
My pid is 19891
ps_tree_begin
test.sh(19891)---pstree(19896)
ps_tree_end
working dir: /home/&lt;me&gt;
Called as: ./test.sh
Arguments: 
--------------------
&lt;me&gt;@&lt;host&gt;:~# 

&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Syslog shows:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;host&amp;gt; &amp;lt;me&amp;gt;: Creating: &amp;#47;tmp&amp;#47;debug-1369940847.log
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is especially helpful for cron jobs or background scripts.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>cisco lights out failsafe</title>
                <link rel="alternate" href="/2013/05/29/cisco-lights-out-failsafe/" type="text/html" />
                <id>/2013/05/29/cisco-lights-out-failsafe/</id>
                <updated>2013-05-29T21:36:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;If you are remote and are at risk of locking yourself out.  For Cisco or IOS based devices your best bet is to schedule a reload at the beginning of your maintenance.  This mitigates the possible outage.  Better 30 minutes than 30 hours, if you are using JunOS they have some nice &amp;ldquo;fail back to my previous config&amp;rdquo;, and Cisco now in some cases provides the archive rollback feature.  Which is awesome.  But it may not be available or if for any reason the more straightfoward and heavy-handed approached is necessary it is there.  Yes, this will obviously cause an outage, but in a true &amp;#39;lights out&amp;#39; remote scenario this may be the best you can do.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;EDIT&lt;/strong&gt; &lt;/p&gt;

&lt;p&gt;Updated preamble to reference rollback option.&lt;/p&gt;

&lt;p&gt;So&amp;hellip;if it suits your needs use &lt;a href=&#34;http://packetpushers.net/cisco-configuration-archive-rollback-using-revert-instead-of-reload/&#34;&gt;archive&lt;/a&gt; &lt;a href=&#34;http://packetpushers.net/cisco-configuration-archive-rollback-using-revert-instead-of-reload/&#34;&gt;rollback&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Walk through:&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;It&amp;#39;s 2 AM and I&amp;#39;m up for maintenace&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;myrtr#reload in 30
System configuration has been modified. Save? [yes&amp;#47;no]: no
Reload scheduled for 13:20:23 PDT Wed May 29 2013 (in 30 minutes) by &amp;lt;me&amp;gt; on vty0 (&amp;lt;vty_ip&amp;gt;)
Reload reason: Reload Command
Proceed with reload? [confirm]
myrtr#
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;*** Making changes *** &lt;/p&gt;

&lt;p&gt;*** How long until a reset? ***&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;myrtr#show reload
Reload scheduled for 13:20:24 PDT Wed May 29 2013 (in 12 minutes) by &amp;lt;me&amp;gt; on vty0 (&amp;lt;vty_ip&amp;gt;)
Reload reason: Reload Command
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;*** test everything is good &amp;ndash; ok clear scheduled reload ***&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;myrtr#reload cancel
***
*** --- SHUTDOWN ABORTED ---
***
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cisco.com/en/US/docs/ios/fundamentals/configuration/guide/cf_config-rollback.html&#34;&gt;replace and rollback&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/docs/ios-xml/ios/config-mgmt/configuration/xe-3s/asr1000/cm-config-rollback.html&#34;&gt;ios-xe replace and rollback&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.techrepublic.com/blog/data-center/use-the-cisco-ios-archive-command-to-archive-your-routers-configuration/&#34;&gt;archive intro&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://packetpushers.net/cisco-configuration-archive-rollback-using-revert-instead-of-reload/&#34;&gt;rollback example&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>launching a syn flood test</title>
                <link rel="alternate" href="/2013/05/29/launching-a-syn-flood-test/" type="text/html" />
                <id>/2013/05/29/launching-a-syn-flood-test/</id>
                <updated>2013-05-29T21:36:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Launching a SYN flood.&lt;/p&gt;

&lt;p&gt;Everyone know DDOS attacks happen and of these SYN floods may be the simplest to organize for attackers.  As a defender you don&amp;#39;t want the first time you see this kind of traffic to be when you are under attack.&lt;/p&gt;
&lt;h4&gt;Launching a SYN attack against yourself.&lt;/h4&gt;
&lt;ol&gt;
&lt;li&gt;You can learn some tools of the trade&lt;/li&gt;
&lt;li&gt;You can test the weakness of your services&lt;/li&gt;
&lt;li&gt;You can mitigate those weaknesses&lt;/li&gt;
&lt;/ol&gt;
&lt;h4&gt;Picking a tool&lt;/h4&gt;
&lt;p&gt;A tool that is simple to use is &lt;a href=&#34;https://github.com/merces/t50&#34;&gt;t50&lt;/a&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;git clone https:&amp;#47;&amp;#47;github.com&amp;#47;merces&amp;#47;t50.git
cd t50&amp;#47;
make
.&amp;#47;t50 --help
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now you have a compiled attack tool and the help is pretty large.  &lt;/p&gt;
&lt;h4&gt;Launching a SYN Flood&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;.&amp;#47;t50 &amp;lt;DEST_IP&amp;gt; --flood -S --turbo
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Looks like&lt;/h4&gt;
&lt;p&gt;Start:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;entering in flood mode...
activating turbo...
hit CTRL+C to break.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finish:    &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;T50 5.4.1 successfully launched on May 28th 2013 13:09:24
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;n the destination host:&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Traffic:&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;
    tx eth0: 1168 b/s rx eth0: 528 b/s
    tx eth0: 1056 b/s rx eth0: 9160 b/s
    tx eth0: 8616 b/s rx eth0: 528 b/s
    tx eth0: 4944 b/s rx eth0: 528 b/s

        *syn flood starts**

    tx eth0: 10 Mb/s rx eth0: 12 Mb/s
    tx eth0: 36 Mb/s rx eth0: 43 Mb/s
    tx eth0: 38 Mb/s rx eth0: 46 Mb/s
    tx eth0: 39 Mb/s rx eth0: 47 Mb/s
    tx eth0: 39 Mb/s rx eth0: 47 Mb/s
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Logging (NOTE: SYN Cookies are enabled)&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;
    possible SYN flooding on port 5666. Sending cookies.
    possible SYN flooding on port 5666. Sending cookies.
&lt;/code&gt;&lt;/pre&gt;

&lt;ul&gt;
&lt;li&gt;Connection Table&lt;/li&gt;
&lt;/ul&gt;

&lt;pre&gt;&lt;code&gt;
    while true; do netstat -n -p TCP tcp | grep  SYN_RECV | wc -l &gt;&gt; /tmp/syn.log; sleep 2; done

    0
    5
    6
    3
    2
    ...
    **syn flood**
    ...
    142
    140
    144
    143
    142
    142
    143
    142
    141
    141
    140
    137
    138
    140
    142
    142
    142
    145
    144
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Effect:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Massive lag in responsiveness for CLI commands&lt;/li&gt;
&lt;li&gt;Simple web server with (python -m SimpleHTTPServer) crashed&lt;/li&gt;
&lt;li&gt;Top shows ksoftirqd/0 pegging CPU&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Guidance on size of flood:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;.&amp;#47;t50 &amp;lt;target&amp;gt; --threshold 10000 -S #4Mbps
.&amp;#47;t50 &amp;lt;target&amp;gt; --threshold 20000 -S #8Mbps
.&amp;#47;t50 &amp;lt;target&amp;gt; --threshold 40000 -S #16Mbps

#more or less consisten 4Mbps flood
for i in {1..100}; do .&amp;#47;t50 &amp;lt;target&amp;gt; --threshold 10000 -S; sleep 3; done
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://antmeetspenguin.blogspot.com/2011/01/detecting-and-preventing-syn-flood.html&#34;&gt;dealing with syn flood blog post&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.sans.org/security-resources/idfaq/syn_flood.php&#34;&gt;sans on syn flood&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cs.wm.edu/%7Ehnw/paper/attack.pdf&#34;&gt;syn flood attack paper&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://serverfault.com/questions/294209/possible-syn-flooding-in-log-despite-low-number-of-syn-recv-connections&#34;&gt;sf syn flood info&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://pc-freak.net/blog/how-to-check-if-your-linux-webserver-is-under-a-dos-attack/&#34;&gt;am I under ddos?&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/merces/t50&#34;&gt;t50 gh&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.gossamer-threads.com/lists/fulldisc/full-disclosure/77770?do=post_view_threaded&#34;&gt;fulldisclosure info&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_9-4/syn_flooding_attacks.html&#34;&gt;cisco on syn floods&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://h4xors.wordpress.com/tag/t50/&#34;&gt;t50 info&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>syn cookies</title>
                <link rel="alternate" href="/2013/05/23/syn-cookies/" type="text/html" />
                <id>/2013/05/23/syn-cookies/</id>
                <updated>2013-05-23T21:35:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;When you&amp;#39;re being hit with DDOS of any flavor it sucks mightily.  Some of the old school attacks like syn floods have been around so long there are decent defenses.  One of the (seemingly) lesser known defenses is syn cookies.&lt;/p&gt;
&lt;h4&gt;Who doesn&amp;#39;t like cookies?&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;SYN cookies are particular choices of initial TCP sequence numbers by TCP servers.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Linux&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@&amp;lt;server&amp;gt;:~# cat &amp;#47;proc&amp;#47;sys&amp;#47;net&amp;#47;ipv4&amp;#47;tcp_syncookies
0

root@&amp;lt;server&amp;gt;:~# cat &amp;#47;proc&amp;#47;sys&amp;#47;net&amp;#47;ipv4&amp;#47;tcp_syncookies
1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now syn cookies are enabled.  This not a foolproof defense but can help.  Remember this method of  enabling does not persist through a reboot.&lt;/p&gt;
&lt;h4&gt;Cisco IOS Zone Based FW Syn Cookies&lt;/h4&gt;
&lt;p&gt;Global:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;parameter-map type inspect global
    tcp syn-flood limit 20000
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Zone Specific:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;parameter-map type inspect-zone ddos-detection
   tcp syn-flood rate per-destination 20000
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;NOTES:&lt;/h4&gt;
&lt;p&gt;SYN cookies are not without problems.  They can cause latency, sometimes very noticeable latency.&lt;/p&gt;
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://cr.yp.to/syncookies.html&#34;&gt;syncookies readme&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.faqs.org/docs/securing/chap5sec56.html&#34;&gt;linux syncookies enable&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/docs/ios-xml/ios/sec_data_zbf/configuration/xe-3s/asr1000/conf-fw-tcp-syn-cookie.html&#34;&gt;cisco doc one&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://etherealmind.com/tcp-syn-cookies-ddos-defence/&#34;&gt;syn cookies blog post&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_9-4/syn_flooding_attacks.html&#34;&gt;cisco on syn floods&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://ckdake.com/content/2007/disadvantages-of-tcp-syn-cookies.html&#34;&gt;downside of syn cookies&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://serverfault.com/questions/353411/syn-cookies-on-internal-machines&#34;&gt;sf syn cookies one&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://serverfault.com/questions/294209/possible-syn-flooding-in-log-despite-low-number-of-syn-recv-connections&#34;&gt;sf syn cookies two&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>postfix ssl weak ciphers</title>
                <link rel="alternate" href="/2013/05/21/postfix-ssl-weak-ciphers/" type="text/html" />
                <id>/2013/05/21/postfix-ssl-weak-ciphers/</id>
                <updated>2013-05-21T21:35:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Vuln&lt;/h4&gt;
&lt;p&gt;Weak ciphers are detected as a level 4 vuln for most scanners.  If you have to deal with PCI you know all level 4 and 5 vulns must be resolved.&lt;/p&gt;
&lt;h4&gt;Resolution&lt;/h4&gt;
&lt;p&gt;/etc/postfix/main.cf&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;# TLS parameters
smtpd_use_tls=yes
smtpd_tls_mandatory_ciphers = high
smtpd_tls_mandatory_exclude_ciphers = aNULL, MD5, DES
smtpd_tls_security_level = encrypt
#Ensure TLSv1
# Preferred form with Postfix ≥ 2.5:
smtpd_tls_mandatory_protocols = !SSLv2, !SSLv3
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;
&lt;p&gt;Pre and post scans confirm all is well but&amp;hellip;&lt;/p&gt;

&lt;p&gt;Postfix is strange when it comes to SSL, and &lt;/p&gt;
&lt;pre&gt;&lt;code&gt;smtpd_tls_security_level = encrypt
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;implies&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ssl_only_use_tls = true.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;So if you have need for non-tls capable clients use caution.&lt;/p&gt;
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://community.qualys.com/docs/DOC-1141&#34;&gt;QID 38140&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.postfix.org/TLS_README.html#server_enable&#34;&gt;postfix server enable&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>using graphite events</title>
                <link rel="alternate" href="/2013/05/17/using-graphite-events/" type="text/html" />
                <id>/2013/05/17/using-graphite-events/</id>
                <updated>2013-05-17T21:34:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Graphite events allow you to overlay vertical bars on graphs for correlation of events and trending data.  I know the &lt;a href=&#34;http://codeascraft.com/2010/12/08/track-every-release/&#34; title=&#34;etsy events&#34;&gt;etsy&lt;/a&gt; guys use normal whisper files; presumabley with a 0.0xFacter and sum rollup instead of average.  That is a nice and reliable way to do it, but if you are looking for more flexbility using the  native (&amp;#39;experimental&amp;#39;) events feature may be useful.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/events.png&#34; alt=&#34;diagram&#34; title=&#34;events&#34;&gt;&lt;/p&gt;
&lt;h4&gt;Posting an event:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
curl -X POST http:&amp;#47;&amp;#47;graphite&amp;#47;events&amp;#47; -d &amp;#39;{&amp;quot;what&amp;quot;: &amp;quot;did_stuff&amp;quot;, &amp;quot;tags&amp;quot; : &amp;quot;fun,times&amp;quot;}&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;OR&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#!/usr/bin/env python
import json
import urllib2

one = {&#39;what&#39;: &#39;did_stuff&#39;, &#39;tags&#39; : &#39;fun,times&#39;}
req = urllib2.Request(&#39;http://graphite.da/events/&#39;,
                      data=json.dumps(one),
                      headers={&#39;Content-type&#39;: &#39;text/plain&#39;})
r = urllib2.urlopen(req)

print r.read()
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Retrieving events:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;curl -X GET http:&amp;#47;&amp;#47;graphite&amp;#47;events&amp;#47;

curl -X GET http:&amp;#47;&amp;#47;graphite&amp;#47;events&amp;#47;?tags=fun
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Show me only stuff starting at an epoch time:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;curl -X GET http:&amp;#47;&amp;#47;graphite&amp;#47;events&amp;#47;?from=1368778407
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Getting lines on graphs&lt;/h4&gt;
&lt;p&gt;Now you have an event that shows up on http://graphite/events and is retrievable by curl.&lt;/p&gt;
&lt;h4&gt;Place it over your graph:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;https:&amp;#47;&amp;#47;graphite&amp;#47;render?target=my.metic.path&amp;amp;target=drawAsInfinite(events(&amp;#39;fun&amp;#39;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can also go two tags deep which is similar in logic to a SQL join.  So the previous example&lt;br&gt;
retrieves all &amp;#39;fun&amp;#39; tagged events.  Now we want to get &amp;#39;fun&amp;#39; and correlate with &amp;#39;times&amp;#39;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;https:&amp;#47;&amp;#47;graphite&amp;#47;render?target=my.metic.path&amp;amp;target=drawAsInfinite(events(&amp;#39;fun&amp;#39;, &amp;#39;times&amp;#39;))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This returns all &amp;#39;fun&amp;#39; tagged events that also have &amp;#39;times&amp;#39; tags.&lt;/p&gt;
&lt;h4&gt;Where this is useful in real world:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#all syncs
https:&amp;#47;&amp;#47;graphite&amp;#47;render?target=my.metic.path&amp;amp;target=drawAsInfinite(events(&amp;#39;code_sync&amp;#39;))

#Now code syncs from a specific user:
https:&amp;#47;&amp;#47;graphite&amp;#47;render?target=my.metic.path&amp;amp;target=drawAsInfinite(events(&amp;#39;code_sync&amp;#39;, &amp;#39;user&amp;#39;))
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://graphite.readthedocs.org/en/1.0/functions.html&#34;&gt;graphite docs&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://code.launchpad.net/%7Elucio.torre/graphite/add-events/+merge/69142&#34;&gt;garphite events&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>ops guy says timemachine</title>
                <link rel="alternate" href="/2013/05/16/ops-guy-says-timemachine/" type="text/html" />
                <id>/2013/05/16/ops-guy-says-timemachine/</id>
                <updated>2013-05-16T21:34:00Z</updated>
                
                <summary type="html">OPS: &amp;ldquo;When does it need to be done?&amp;rdquo;&lt;br&gt;
PM: &amp;ldquo;Next week at the latest.&amp;rdquo;&lt;br&gt;
OPS: &amp;ldquo;OK, we spend from now to next week working on a time machine.  If we had a time machine it would &lt;em&gt;already&lt;/em&gt; be done.&amp;rdquo;&lt;br&gt;
PM: &amp;ldquo;How so?&amp;rdquo;</summary>
                <content type="html">&lt;p&gt;OPS: &amp;ldquo;When does it need to be done?&amp;rdquo;&lt;br&gt;
PM: &amp;ldquo;Next week at the latest.&amp;rdquo;&lt;br&gt;
OPS: &amp;ldquo;OK, we spend from now to next week working on a time machine.  If we had a time machine it would &lt;em&gt;already&lt;/em&gt; be done.&amp;rdquo;&lt;br&gt;
PM: &amp;ldquo;How so?&amp;rdquo;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>name.com bummer</title>
                <link rel="alternate" href="/2013/05/09/name.com-bummer/" type="text/html" />
                <id>/2013/05/09/name.com-bummer/</id>
                <updated>2013-05-09T18:11:00Z</updated>
                
                <summary type="html">So name.com was hacked and deviantart.com was one of the credentials dumped from their DB.</summary>
                <content type="html">&lt;p&gt;So name.com was hacked and deviantart.com was one of the credentials dumped from their DB.&lt;/p&gt;

&lt;p&gt;How do I know? &lt;a href=&#34;https://news.ycombinator.com/item?id=5676311&#34;&gt;https://news.ycombinator.com/item?id=5676311&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;What&amp;#39;s interesting is that we know our password and we know their hash of it now.&lt;br&gt;&lt;br&gt;
Even though the site where it was posted has been taken down at this time.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://news.ycombinator.com/item?id=5677739&#34;&gt;https://news.ycombinator.com/item?id=5677739&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And now we know they were/are(?) storing our password using MySQL PASSWORD()&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://news.ycombinator.com/item?id=5679307&#34;&gt;https://news.ycombinator.com/item?id=5679307&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://dev.mysql.com/doc/refman/4.1/en/encryption-functions.html#function_password&#34;&gt;https://dev.mysql.com/doc/refman/4.1/en/encryption-functions.html#function_password&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;No actual damage was done for &lt;em&gt;us&lt;/em&gt; as this point.  Damn, though, that sucks all around.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>simple iptables uses</title>
                <link rel="alternate" href="/2013/04/19/simple-iptables-uses/" type="text/html" />
                <id>/2013/04/19/simple-iptables-uses/</id>
                <updated>2013-04-19T03:20:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Allow ssh from only 192 network (presumably your internal)&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;iptables -A INPUT -i eth0 -p tcp -s 192.168.0.0&amp;#47;16 --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Allow SCCP (VOIP Protocol)&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;iptables -A INPUT -i eth0 -p tcp --dport 1720 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 1720 -m state --state ESTABLISHED -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Allow h.323 (VOIP)&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;iptables -A INPUT -i eth0 -p tcp --dport 2000 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 2000 -m state --state ESTABLISHED -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Allow ICMP&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;iptables -A OUTPUT -p icmp --icmp-type echo-request -j ACCEPT
iptables -A INPUT -p icmp --icmp-type echo-reply -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Allow DNS queries, etc&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;iptables -A OUTPUT -p udp -o eth0 --dport 53 -j ACCEPT
iptables -A INPUT -p udp -i eth0 --sport 53 -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Allow mail sending&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;iptables -A INPUT -i eth0 -p tcp --dport 25 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 25 -m state --state ESTABLISHED -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Allowing SSH and HTTP and self sourced traffic&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;iptables -A INPUT -i eth0 -p tcp --dport 22 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 22 -m state --state ESTABLISHED -j ACCEPT
iptables -A INPUT -i eth0 -p tcp --dport 80 -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o eth0 -p tcp --sport 80 -m state --state ESTABLISHED -j ACCEPT
iptables -A INPUT -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -P INPUT DROP
iptables -P FORWARD DROP
iptables -P OUTPUT ACCEPT
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>beginning bgp</title>
                <link rel="alternate" href="/2013/04/18/beginning-bgp/" type="text/html" />
                <id>/2013/04/18/beginning-bgp/</id>
                <updated>2013-04-18T16:48:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I remember hearing a lot of conflicting information about BGP when I first started doing network admin stuff.  A lot of time BGP is part of an HA strategy and there are people making business decisions surrounding the protocol itself.  This breakdown strives to be accurate and laymen without being misleading.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Specific misconceptions:&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;You need a full time admin doing only BGP stuff.

You can accidentally take down the Internet if you mess up.

BGP is hard.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You do not need a &amp;#39;full time&amp;#39; guy thinking about BGP around the clock, although you do need designated contacts for just-in-case scenarios.  If your providers are handling their own business you don&amp;#39;t have to worry about taking down the Internet.  (Although some small version of this happened to YouTube &lt;a href=&#34;http://www.macworld.com/article/1132256/networking.html&#34;&gt;http://www.macworld.com/article/1132256/networking.html&lt;/a&gt;).  BGP is no harder or easier than anything else.  I have seen configurations that boggle the mind work for years.  Correctly administered BGP does involves some savy.&lt;/p&gt;
&lt;h4&gt;What is BGP?&lt;/h4&gt;
&lt;p&gt;Usually referring to the current version 4.  Just read it: &lt;a href=&#34;https://en.wikipedia.org/wiki/Border_Gateway_Protocol&#34;&gt;https://en.wikipedia.org/wiki/Border_Gateway_Protocol&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Seriously, What is BGP for though?&lt;/h4&gt;
&lt;p&gt;In order to have a service (or anything) available on the Internet it needs to be announced.  Usually, your Internet Provider does this announcing for you.  If you want to be the master of your own destiny you need to announce yourself.  Literally, you say &amp;ldquo;here I am&amp;rdquo; to your provider.  Your provider talks to other providers and before long everyone knows how to find you.  When a user connects to their Internet provider they send a request for your service. Since you have made yourself known they can find you&lt;/p&gt;

&lt;p&gt;BGP is how we find people on the Internet.&lt;/p&gt;
&lt;h4&gt;How can I start announcing myself?&lt;/h4&gt;
&lt;p&gt;In order to announce that you exist you need to have IP addresses.  It&amp;#39;s a non-human way for tracking down a  resource; think phone numbers.  The gentlemen at ARIN keep a big list of addresses in use.  If you want to use BGP; you need addressing.  If you want addressing; you talk to ARIN.  There are two simultaneous IP address pools.  The old is IPv4 and we are scraping the bottom of the bucket.  That bucket was large enough to get the Internet this far (4 Billion+ addresses with a large chunk carved out for special reservations). The second bucket is called IPv6.  IPv6 is a much deeper bucket, 3.4 x 10 to the 38th power.  That is far, far, far more addresses than IPv4 has available.  IPv6 has addresses reserved already for the Moon.  Seriously.&lt;/p&gt;

&lt;p&gt;To get addresses you apply.  It&amp;#39;s that simple.  &lt;a href=&#34;https://www.arin.net/resources/request.html&#34;&gt;https://www.arin.net/resources/request.html&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;&amp;hellip;almost that simple.&lt;/h4&gt;
&lt;p&gt;IPv4 is a dwindling resource.  But it has been one for a long time.  In my experience, getting an IPv6 block is very easy.  Getting an IPv4 block requires more justification.  Scarce resources are more valued.  Without a  block of my own addresses can I use BGP?  Well, maybe.  Some providers will allocate you a block of addresses from their pool.  You don&amp;#39;t own them.  You may be able to advertise them out another provider if both providers agree that is reasonable.  BGP is all about relationships.  No provider has to allow you to announce your block on their network whether it has been issued to you or them.  Thankfully providers are in the business of making money, and the only way to make money for them is to move traffic.  If you can get an address block of your very own it is called Provider Independent Address Space.  Meaning you can take your addresses and move to any provider that will have you.  If you talk a provider into allocating you a block of addresses it is called Provider Dependent Address Space.  In order to change providers you have to change IP blocks.  It can be done.&lt;/p&gt;
&lt;h4&gt;Understanding Addressing&lt;/h4&gt;
&lt;p&gt;All address space given out is public information.  &lt;/p&gt;

&lt;p&gt;Getting ARIN info for deviantART.com&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/bgp/arin-whois.png&#34; alt=&#34;arin query&#34; title=&#34;ARIN Whois&#34;&gt;&lt;br&gt;
&lt;img src=&#34;/assets/images/bgp/arin-info.png&#34; alt=&#34;arin info&#34; title=&#34;ARIN Info&#34;&gt;&lt;/p&gt;

&lt;p&gt;Yahoo: &lt;a href=&#34;http://whois.arin.net/rest/customer/C00146168&#34;&gt;http://whois.arin.net/rest/customer/C00146168&lt;/a&gt;&lt;br&gt;
Mozilla: &lt;a href=&#34;http://whois.arin.net/rest/customer/C01111858&#34;&gt;http://whois.arin.net/rest/customer/C01111858&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Wait&amp;hellip;They want my ASN?&lt;/h4&gt;
&lt;p&gt;ASN is automomous system number.  It is both a technical and a nontechnical entity.  In a non-technical sense it is a number assigned to networks under a singular control.  Some companies have multiple ASN&amp;#39;s, but in general you join ARIN and you get an ASN.  This ASN is unique to you, and it is how providers will know you.  &lt;/p&gt;

&lt;p&gt;BGP thinks in ASN&amp;#39;s.&lt;/p&gt;

&lt;p&gt;It&amp;#39;s like this: You have a 1:1 relationship with your ASN, but a one-to-many relationship with your addressing space.&lt;/p&gt;

&lt;p&gt;Sort of like:   You have a 1:1 relationship with your house address, but a one-to-many relationship for your house address&lt;br&gt;
                to phone numbers associated with your address.&lt;/p&gt;

&lt;p&gt;Just Read it: &lt;a href=&#34;http://en.wikipedia.org/wiki/Autonomous_System_(Internet)&#34;&gt;http://en.wikipedia.org/wiki/Autonomous_System_(Internet)&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Why ASN&amp;#39;s &lt;em&gt;AND&lt;/em&gt; IP addresses?&lt;/h4&gt;
&lt;p&gt;When providers talk BGP to each other they refer to you and themselves by ASN number.  That&amp;#39;s the short version.&lt;/p&gt;

&lt;p&gt;BGP is a routing protocol.  Most routing protocols rely on an addressing hierarchy.  Therefore it&amp;#39;s easy to follow the numbers and find your destination.  If two roomates live in a house together and use the network 192.168.0.0/16 and they link up with their neighbors who use 172.16.0.0/16.  They can point routes at each other and communications happens. If one roomate in the first house wants his own subnet they can break things down.  192.168.0.0/16 becomes 192.168.0.0/24  (first roomate) AND 192.168.1.0/24 (second roomate).  But their neighbors still only use 192.168.0.0/16 as it&amp;#39;s &amp;#39;good enough&amp;#39; to get to their house, and their house router knows how to distinguish between their rooms.&lt;/p&gt;

&lt;p&gt;BGP exists on a larger playing field.  10.0.1.0/24 and 10.0.2.0/24 could be assigned to people or companies that have no relationship to each other.  Addressing on the Internet is not assigned in a way that makes it contiguous.&lt;/p&gt;

&lt;p&gt;It would be like if the two roomates were still using 192.168.0.0/24 and 192.168.1.0/24 but had now moved to different addresses.  We would need to find a way to associate their IP block with their new location.  The location would be the ASN and the address block &amp;hellip;would be the address block.&lt;/p&gt;

&lt;p&gt;So when two routers talk BGP to each other they say: ASN 1 has 192.168.0.0/24.  ASN 2 has 192.168.1.0/24&lt;/p&gt;

&lt;p&gt;So if BGPRouter1 says this to BGPRouter2.  BGPRouter1 has to be associated with an ASN too.  Let&amp;#39;s say BGPRouter1 has ASN 3.  Now BGPRouter2 knows: when I need to get to ASN1 or ASN2 I send things to ASN3.  Like, if I need to mail this letter to Les Sauvages, France the first step is getting it to France.&lt;/p&gt;
&lt;h4&gt;Summation&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;BGP is how people find each other on the Internet.  Usually providers worry about it.&lt;/li&gt;
&lt;li&gt;BGP is complex, but the basics are very straight forward.&lt;/li&gt;
&lt;li&gt;BGP is fundamental to understanding the Internet.&lt;/li&gt;
&lt;li&gt;ASN&amp;#39;s can be assigned by ARIN.  All you need to do is join.&lt;/li&gt;
&lt;li&gt;Addressing can be assigned by ARIN.  All you need to do is apply.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/Border_Gateway_Protocol&#34;&gt;BGP wiki&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://en.wikipedia.org/wiki/IP_address&#34;&gt;IP Address wiki&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>beginning bgp configuration</title>
                <link rel="alternate" href="/2013/04/16/beginning-bgp-configuration/" type="text/html" />
                <id>/2013/04/16/beginning-bgp-configuration/</id>
                <updated>2013-04-16T21:34:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Getting started with BGP&lt;/p&gt;
&lt;h4&gt;Configuring Basic BGP (full table)&lt;/h4&gt;
&lt;p&gt;This configuration is Cisco based but JunOS isn&amp;#39;t too far of a stretch in my experience.&lt;/p&gt;

&lt;p&gt;First off: you need your ASN.  You need your address block.  Your address block must be at least /24.&lt;/p&gt;

&lt;p&gt;A general rule of thumb for awhile has been 2 GB of memory per full BGP table.  Sometimes more is required and sometimes significantly less.  The table is still growing and 2 GB is my personal baseline required.&lt;/p&gt;
&lt;h4&gt;Aliases: you will learn to like them&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;alias exec sumbgp6 show bgp ipv6 unicast summary
alias exec sumbgp show ip bgp summary
alias exec sbgp show run | section bgp
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Basic BGP stanza&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
config t
ip bgp-community new-format
!insert your ASN
router bgp &lt;OUR_ASN&gt;
 !your router id should be set explicitly
 bgp router-id &lt;OUR_ROUTER_ID&gt;
 no bgp fast-external-fallover
 !notify syslog of bgp changes
 bgp log-neighbor-changes
 bgp graceful-restart restart-time 120
 bgp graceful-restart stalepath-time 360
 bgp graceful-restart
 neighbor &lt;OUR_PROVIDER_IP&gt; remote-as &lt;YOUR_PROVIDERS_ASN&gt;
 neighbor &lt;OUR_PROVIDER_IP&gt; description &lt;OUR_PROVIDERS_NAME&gt;
 neighbor &lt;OUR_PROVIDER_IP&gt; version 4
 neighbor &lt;OUR_PROVIDER_IP&gt; activate
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Our First BGP Summary&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
RTRME(config-router)####do sumbgp
BGP router identifier &lt;OUR_ROUTER_ID&gt;, local AS number &lt;OUR_ASN&gt;
BGP table version is 464187, main routing table version 464187
446501 network entries using 66082148 bytes of memory
446501 path entries using 28576064 bytes of memory
73561/73558 BGP path/bestpath attribute entries using 9415808 bytes of memory
69308 BGP AS-PATH entries using 2555070 bytes of memory
68 BGP community entries using 1904 bytes of memory
0 BGP route-map cache entries using 0 bytes of memory
0 BGP filter-list cache entries using 0 bytes of memory
BGP using 106630994 total bytes of memory
BGP activity 460823/1679 prefixes, 461759/2621 paths, scan interval 60 secs

Neighbor        V           AS MsgRcvd MsgSent   TblVer  InQ OutQ Up/Down  State/PfxRcd
&lt;OUR_PROVIDER_IP&gt;  4         2914   79993      80   464166    0    0 01:11:19   446501
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;BGP: Why you no work?&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
RTRME(config-router)####do sh ip bgp neighbor &lt;OUR_PROVIDER_IP&gt; advertised-routes

Total number of prefixes 0 
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;To Advertise it: We need to know where it is&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
RTRME(config)####sh ip bgp &lt;OUR_ADVERTISED_SUBNET&gt;
% Network not in table

RTRME(config)####ip route &lt;OUR_ADVERTISED_SUBNET&gt; &lt;OUR_ADVERTISED_SM&gt; null 0 200

RTRME(config)####do sh ip bgp &lt;OUR_ADVERTISED_SUBNET&gt;
BGP routing table entry for &lt;OUR_ADVERTISED_SUBNET&gt;, version 464822
Paths: (1 available, best ####1, table default)
Multipath: eBGP
  Not advertised to any peer
  Refresh Epoch 1
  Local
    0.0.0.0 from 0.0.0.0 (&lt;OUR_ROUTER_ID&gt;)
      Origin IGP, metric 0, localpref 100, weight 32768, valid, sourced, local, best
RTRME(config)####
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Resetting BGP&lt;/h4&gt;
&lt;p&gt;This is very aggressive and will reset your peering status.  Lookup soft in/out if you are alreadying using BGP in production.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
RTRME####clear ip bgp *
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Things we know about our neighbor&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;What is their status?&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;javascript:toggleDiv(&#39;hideme&#39;);&#34;&gt;sh ip bgp neighbors&lt;/a&gt;&lt;/p&gt;

&lt;div id=&#34;hideme&#34; style=&#34;display:none;&#34;&gt;
&lt;pre&gt;&lt;code&gt;
RTRME####sh ip bgp neighbors &lt;OUR_PROVIDER_IP&gt;
BGP neighbor is &lt;OUR_PROVIDER_IP&gt;,  remote AS &lt;PROVIDER_ASN&gt;, external link
 Description: &lt;OUR_PROVIDERS_NAME&gt;
  BGP version 4, remote router ID &lt;OUR_PROVIDERS_RTR_ID&gt;
  BGP state = Established, up for 00:02:11
  Last read 00:00:03, last write 00:00:21, hold time is 180, keepalive interval is 60 seconds
  Neighbor sessions:
    1 active, is not multisession capable (disabled)
  Neighbor capabilities:
    Route refresh: advertised and received(new)
    Four-octets ASN Capability: advertised and received
    Address family IPv4 Unicast: advertised and received
    Address family IPv4 Multicast: received
    Graceful Restart Capability: advertised
    Enhanced Refresh Capability: advertised
    Multisession Capability: 
    Stateful switchover support enabled: NO for session 1
  Message statistics:
    InQ depth is 0
    OutQ depth is 0
    
                         Sent       Rcvd
    Opens:                  1          1
    Notifications:          0          0
    Updates:                2      74253
    Keepalives:             2          2
    Route Refresh:          0          0
    Total:                  5      74256
  Default minimum time between advertisement runs is 30 seconds

 For address family: IPv4 Unicast
  Session: &lt;OUR_PROVIDER_IP&gt;
  BGP table version 446725, neighbor version 442403/446725
  Output queue size : 0
  Index 3, Advertise bit 0
  3 update-group member
  Slow-peer detection is disabled
  Slow-peer split-update-group dynamic is disabled
                                 Sent       Rcvd
  Prefix activity:               ----       ----
    Prefixes Current:               1     446496 (Consumes 28575744 bytes)
    Prefixes Total:                 1     446688
    Implicit Withdraw:              0        159
    Explicit Withdraw:              0         33
    Used as bestpath:             n/a     446496
    Used as multipath:            n/a          0

                                   Outbound    Inbound
  Local Policy Denied Prefixes:    --------    -------
    AS_PATH loop:                       n/a          1
    Bestpath from this peer:         442397        n/a
    Invalid Path:                         2        n/a
    Total:                           442399          1
  Number of NLRIs in the update sent: max 1, min 0
  Last detected as dynamic slow peer: never
  Dynamic slow peer recovered: never
  Refresh Epoch: 1
  Last Sent Refresh Start-of-rib: never
  Last Sent Refresh End-of-rib: never
  Last Received Refresh Start-of-rib: never
  Last Received Refresh End-of-rib: never
                               Sent   Rcvd
    Refresh activity:          ----   ----
          Refresh Start-of-RIB          0          0
      Refresh End-of-RIB            0          0
          
  Address tracking is enabled, the RIB does have a route to &lt;OUR_PROVIDER_IP&gt;
  Connections established 3; dropped 2
  Last reset 00:02:22, due to Peer closed the session
  Transport(tcp) path-mtu-discovery is enabled
  Graceful-Restart is enabled, restart-time 120 seconds, stalepath-time 360 seconds
Connection state is ESTAB, I/O status: 1, unread input bytes: 0        
Connection is ECN Disabled
Mininum incoming TTL 0, Outgoing TTL 1
Local host: &lt;LOCAL_IP&gt;, Local port: &lt;OUR_ASN&gt;
Foreign host: &lt;OUR_PROVIDER_IP&gt;, Foreign port: 179
Connection tableid (VRF): 0
          
Enqueued packets for retransmit: 0, input: 0  mis-ordered: 0 (0 bytes)
          
Event Timers (current time is 0x4FFF0E):
Timer          Starts    Wakeups            Next
Retrans             6          0             0x0
TimeWait            0          0             0x0
AckHold           583          8             0x0
SendWnd             0          0             0x0
KeepAlive           0          0             0x0
GiveUp              0          0             0x0
PmtuAger            1          0        0x572440
DeadWait            0          0             0x0
Linger              0          0             0x0
          
iss:  606418243  snduna:  606418426  sndnxt:  606418426     sndwnd:  65353
irs:  236441019  rcvnxt:  244436657  rcvwnd:      15353  delrcvwnd:   1031

SRTT: 176 ms, RTTO: 1244 ms, RTV: 1068 ms, KRTT: 0 ms
minRTT: 94 ms, maxRTT: 397 ms, ACK hold: 200 ms
Status Flags: none
Option Flags: higher precendence, nagle, path mtu capable
          
Datagrams (max data segment is 1424 bytes):
Rcvd: 5643 (out of order: 0), with data: 5627, total data bytes: 7995637
Sent: 5645 (retransmit: 0 fastretransmit: 0),with data: 5, total data bytes: 182
&lt;/code&gt;&lt;/pre&gt;
&lt;/div&gt;

&lt;p&gt;&lt;em&gt;What are we advertising to them?&lt;/em&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
RTRME####sh ip bgp neighbors &lt;OUR_PROVIDER_IP&gt; advertised-routes 
BGP table version is 447010, local router ID is &lt;OUR_ROUTER_ID&gt;
Status codes: s suppressed, d damped, h history, * valid, &gt; best, i - internal,
              r RIB-failure, S Stale, m multipath, b backup-path, x best-external, f RT-Filter, a additional-path
Origin codes: i - IGP, e - EGP, ? - incomplete

   Network          Next Hop            Metric LocPrf Weight Path
*&gt; &lt;OUR_ADVERTISED_SUBNET&gt;     0.0.0.0                  0         32768 i

Total number of prefixes 1 
&lt;/code&gt;&lt;/pre&gt;    
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cisco.com/en/US/tech/tk365/technologies_tech_note09186a00800945ff.shtml&#34;&gt;Troubleshooting When BGP Routes Are Not Advertised&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://lg.above.net/lg.cgi&#34;&gt;BGP looking glass&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/tech/tk365/technologies_configuration_example09186a0080094309.shtml&#34;&gt;Configuring and Verifying the BGP Conditional Advertisement Feature&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>virsh halting a host</title>
                <link rel="alternate" href="/2013/04/10/virsh-halting-a-host/" type="text/html" />
                <id>/2013/04/10/virsh-halting-a-host/</id>
                <updated>2013-04-10T21:33:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;KVM is great but I&amp;#39;m making a note so I remember because this command gives me pause every time.&lt;/p&gt;
&lt;h4&gt;Sometimes &amp;#39;shutdown&amp;#39; in the virtual shell for KVM fails.&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;virsh # shutdown myvm
Domain myvm is being shutdown
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;But&amp;hellip;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;114 myvm            running
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In order to shutdown this host I use the &amp;#39;destroy&amp;#39; command.  Destroy does not&lt;br&gt;
remove any files or otherwise permanently change the host data.  Which for me, &lt;br&gt;
is unintuitive.  It does remove it from the list of hosts shown with the &amp;#39;list&amp;#39;&lt;br&gt;
command.  Destroy is like pulling the plug.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;virsh #destroy myvm
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The command that does what I would expect destroy to do is: &amp;#39;undefine&amp;#39;.&lt;/p&gt;
&lt;h4&gt;the &amp;#39;Sometimes&amp;#39; update&lt;/h4&gt;
&lt;p&gt;When a new VM has no OS or doesn&amp;#39;t make it past the bootloader it appears to be non-responsive for the graceful shutdown command.&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://docs.fedoraproject.org/en-US/Fedora/13/html/Virtualization_Guide/chap-Virtualization-Managing_guests_with_virsh.html&#34;&gt;fedora project virsh doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cyberciti.biz/faq/linux-kvm-stop-start-guest-virtual-machine/&#34;&gt;cyberciti doc&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>IOS granular permissions</title>
                <link rel="alternate" href="/2013/04/03/ios-granular-permissions/" type="text/html" />
                <id>/2013/04/03/ios-granular-permissions/</id>
                <updated>2013-04-03T16:41:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;If you have tiered levels of administrators, or you want to create an account for automation purposes best practice is to define a custom security level in IOS.&lt;/p&gt;

&lt;p&gt;Levels 1 and 15 are defined by default.&lt;/p&gt;
&lt;h4&gt;Allowing lower levels to see your configuration: IOS&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;conf t
username backup privilege 3 secret &amp;lt;SECRET&amp;gt;
privilege exec level 3 show startup-config
privilege exec level 3 show
wr mem
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Allowing lower levels to see your configuration: FreeRADIUS:&lt;/h4&gt;
&lt;p&gt;/etc/freeradius/users&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
backup
    Service-Type = NAS-Prompt-User,
    cisco-avpair = &#34;shell:priv-lvl=3&#34;,
    Auth-Type = System,
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Looks Like&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
cisco#show start
Building configuration...

--CONFIGURATION--
end
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Defining the next user tier for NAT information: IOS&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;conf t
username natinfo privilege 4 secret &amp;lt;SECRET&amp;gt;
privilege exec level 4 show nat64 statistics
wr mem
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Defining the next user tier for NAT information: FreeRADIUS&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
natinfo
    Service-Type = NAS-Prompt-User,
    cisco-avpair = &#34;shell:priv-lvl=4&#34;,
    Auth-Type = System,
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Looks Like&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;cisco#show ip nat statistics
--STATS--
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;NOTES&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Permissions stack up which means a user at Level 4 can also issue &amp;#39;show startup-configuration&amp;#39;&lt;/li&gt;
&lt;li&gt;&amp;#39;show running-config&amp;#39; command does not work in this way for the IOS devices I have tried.&lt;br&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This does not work how you think it does:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;privilege exec level 3 show running-config
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.techrepublic.com/article/understand-the-levels-of-privilege-in-the-cisco-ios/&#34;&gt;tech republic cisco priv doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/docs/ios/12_2/security/configuration/guide/scfpass.html&#34;&gt;cisco sec guide&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>puppet disables itself if disk fills up</title>
                <link rel="alternate" href="/2013/03/31/puppet-disables-itself-if-disk-fills-up/" type="text/html" />
                <id>/2013/03/31/puppet-disables-itself-if-disk-fills-up/</id>
                <updated>2013-03-31T01:11:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;A quick note if someone is wondering why puppet has disabled itself.  Make sure&lt;br&gt;
your disks have not filled up.  Not sure if only the /var partition will cause this&lt;br&gt;
but in my case:&lt;/p&gt;
&lt;h4&gt;This machine is behind on it&amp;#39;s configuration.&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;df -Th

Filesystem    Type    Size  Used Avail Use% Mounted on
&amp;#47;dev&amp;#47;sda1      xfs     94G  91G   91G   100% &amp;#47;

puppet agent --test

Skipping run of Puppet configuration client; administratively disabled 
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Once the space has been cleared&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;puppet agent --enable &amp;amp;&amp;amp; puppet agent --test
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>basic redis python pubsub</title>
                <link rel="alternate" href="/2013/03/26/basic-redis-python-pubsub/" type="text/html" />
                <id>/2013/03/26/basic-redis-python-pubsub/</id>
                <updated>2013-03-26T16:43:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I am serializing a dict as JSON and publishing it.  The subscriber will receive and print.  It is not necessary to use JSON as redis has awesome datatype compatibility with python: &lt;a href=&#34;http://redis.io/topics/data-types&#34;&gt;type ref&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Using pubsub to distribute messages is often the &amp;#39;right way&amp;#39;.&lt;/p&gt;

&lt;p&gt;This is using &lt;a href=&#34;http://packages.debian.org/wheezy/python-redis&#34;&gt;python-redis&lt;/a&gt; from the debian repos.&lt;/p&gt;
&lt;h4&gt;Publishing an event:&lt;/h4&gt;
&lt;p&gt;This is just an example.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
    import redis
    import time
    import json
    r_server = redis.Redis(&#34;redis&#34;, db=1)
    payload = {}
    payload[&#39;event&#39;] = &#39;played with legos&#39;
    payload[&#39;ts&#39;] = time.time()
    json_values = json.dumps(payload, separators=(&#39;,&#39;, &#39;:&#39;))
    r_server.publish(&#39;kidsgames&#39;, json_values)
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Subscribing to events&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
    import redis
    import time
    import json
    r_server = redis.Redis(&#34;redis&#34;, db=1)
    r_server.subscribe(&#39;kidsgames&#39;)
    while True:
        for m in r_server.listen():
            if m[&#39;type&#39;] == &#39;subscribe&#39;:
                if m[&#39;data&#39;] == 1:
                    log.info(&#39;subscribed to: %s&#39; % (m[&#39;channel&#39;]))
            #this is what most pubsub submissions will match
            elif m[&#39;type&#39;] == &#39;message&#39;:
                #our payload is in the data field of the response
                print json.loads(m[&#39;data&#39;])
            else:
                print m
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;**** EDIT for Debian Wheezy ****&lt;/h3&gt;
&lt;p&gt;It seems redis.StrictRedis the way to go now.&lt;/p&gt;
&lt;h4&gt;Client Example Using StrictRedis&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
import json
import redis
import time
redis_server = &#34;localhost&#34;
redis_db = 1
redis_channels = [&#39;kidsgames&#39;]
r_server = redis.StrictRedis(redis_server, db=redis_db)

def rsub_connect(rinstance, channels):
    print &#39;subscribing to: %s&#39; % (&#39;,&#39;.join(channels),)
    sub = rinstance.pubsub()
    map(sub.psubscribe, redis_channels)
    return sub

try:
    pubsub = rsub_connect(r_server, redis_channels)
    for m in pubsub.listen():
        print m
except redis.exceptions.ConnectionError as e:
    print &#39;warning -- &#39;, str(e)
    raise
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://redis.io/topics/pubsub&#34;&gt;redis pubsub&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://redis-py.readthedocs.org/en/latest/&#34;&gt;redis py doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/andymccurdy/redis-py&#34;&gt;redis py github&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>query puppetdb facts from cli</title>
                <link rel="alternate" href="/2013/03/15/query-puppetdb-facts-from-cli/" type="text/html" />
                <id>/2013/03/15/query-puppetdb-facts-from-cli/</id>
                <updated>2013-03-15T21:33:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;A need to get host facts when the host itself is not available.  PuppetDB has cached them, and I like the CLI.&lt;/p&gt;
&lt;h4&gt;This doesn&amp;#39;t work like you think it does&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;puppet facts find &amp;lt;myhost.com&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This always returns the facts for the &lt;em&gt;puppetmaster&lt;/em&gt; itself.&lt;/p&gt;
&lt;h4&gt;Setting Terminus&lt;/h4&gt;
&lt;p&gt;If you want to query the puppetdb store directly set the terminus.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;puppet facts find &amp;lt;myhost.com&amp;gt; --terminus puppetdb
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This returns the &amp;#39;right stuff&amp;#39;.  Beware it could be old because it&amp;#39;s last cached values.&lt;/p&gt;
&lt;h4&gt;Readability Counts&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;puppet facts find &amp;lt;myhost.com&amp;gt; --terminus puppetdb | python -m json.tool
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://docs.puppetlabs.com/puppetdb/latest/api/query/v2/fact-names.html&#34;&gt;puppet fact names doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://docs.python.org/2/library/json.html&#34;&gt;python json&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>puppet file resources in masterless mode</title>
                <link rel="alternate" href="/2013/03/06/puppet-file-resources-in-masterless-mode/" type="text/html" />
                <id>/2013/03/06/puppet-file-resources-in-masterless-mode/</id>
                <updated>2013-03-06T21:33:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Accessing file stores via puppet manifests in the real world.&lt;/p&gt;

&lt;p&gt;If you use Puppet to distribute file resources and you also test configuration changes locally it can be a pain.&lt;/p&gt;
&lt;h4&gt;Define a file resource for Puppet:&lt;/h4&gt;
&lt;p&gt;&lt;em&gt;fileserver.conf:&lt;/em&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
[configfiles]
  path /var/configfiles
  allow *.com
  deny *.lan
  allow 192.168.0.0/24
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Refer to file resource in manifest&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;source =&amp;gt; &amp;quot;puppet:&amp;#47;&amp;#47;&amp;#47;configfiles&amp;#47;&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;and puppet will magically use this source.  &lt;/p&gt;
&lt;h4&gt;Local Runs Now Have Issues&lt;/h4&gt;
&lt;p&gt;But when you run something locally like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; puppet apply --debug test.pp
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Errors occurr: &lt;/p&gt;
&lt;pre&gt;&lt;code&gt; Could not evaluate: Could not retrieve information from environment production source
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Making localruns clean&lt;/h4&gt;
&lt;p&gt;You can set things up so that Puppet will try your masterful resource and if it&lt;br&gt;
fails it will do (essentially) a noop by serving a directory to itself.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
#if run in master mode grabs files from configfile resource
#if run locally essentially does a noop refering file source to itself
$remote_source =&#34;puppet:///configfiles/myconfig&#34;
$fname = &#34;/tmp/what&#34;
node default {
    source =
    file {$fname:
        ensure =&gt; &#39;file&#39;
        source  =&gt; [$remote_source,
                    $fname,
                    inline_template(&#39;&lt;%= remote_source.gsub /^puppet:\/\/\//,
                    &#34;file://#{Dir.pwd}/&#34; %&gt;&#39;)],
    }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This can be misleading when you test locally because you are not seeing the actual behavior,&lt;br&gt;
but there is not a way to see the actual behavior because testing locally in a master/slave&lt;br&gt;
setup only goes so far.  The big advantage to this is that operations that were previously &lt;br&gt;
failing because of this falsly accussed dependency now can be debugged.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>Finding your metrics.</title>
                <link rel="alternate" href="/2013/03/01/graphite-all-metrics/" type="text/html" />
                <id>/2013/03/01/graphite-all-metrics/</id>
                <updated>2013-03-01T19:29:00Z</updated>
                
                <summary type="html">This will return a &amp;#39;list&amp;#39; of all of your metrics:</summary>
                <content type="html">&lt;p&gt;This will return a &amp;#39;list&amp;#39; of all of your metrics:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http:&amp;#47;&amp;#47;graphite&amp;#47;metrics&amp;#47;index.json
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Or more efficiently you can use the &amp;#39;find&amp;#39; api:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;http:&amp;#47;&amp;#47;graphite&amp;#47;metrics&amp;#47;find?query=*
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>allowing env magic via sudo</title>
                <link rel="alternate" href="/2013/02/25/allowing-env-magic-via-sudo/" type="text/html" />
                <id>/2013/02/25/allowing-env-magic-via-sudo/</id>
                <updated>2013-02-25T16:43:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;In an environment with heavy automation and numerous service account users it is easy to end up in a situation where compromising one service becomes compromising an entire system.&lt;/p&gt;
&lt;h4&gt;Granting permission to a single command&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;vi &amp;#47;etc&amp;#47;sudoers.d&amp;#47;makingpie

myuser ALL = NOPASSWD: &amp;#47;usr&amp;#47;local&amp;#47;bin&amp;#47;makepie
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Looks Like&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;myuser:#sudo makepie
&amp;gt;&amp;gt;&amp;gt;&amp;gt;mmmmm...pie
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;What if my user needs to call out to a proxy but &amp;#39;makepie&amp;#39; doesn&amp;#39;t support it?&lt;/h4&gt;
&lt;p&gt;We use proxychains.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo LD_PRELOAD=libproxychains.so.3 makepie
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Sudo is extra granular and doesn&amp;#39;t like this idea.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo: sorry, you are not allowed to set the following environment variables: LD_PRELOAD
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;The heavy handed way&lt;/h4&gt;
&lt;p&gt;Don&amp;#39;t reset user enviroments when using sudo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;visudo
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Replace: “Defaults env_reset” with: “Defaults !env_reset”&lt;/p&gt;
&lt;h4&gt;Piecemeal way&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;vi &amp;#47;etc&amp;#47;sudoers.d&amp;#47;ld_preload

#allow users to use proxychains env variable (using sudo)
Defaults env_keep += &amp;quot;LD_PRELOAD&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://brandonhutchinson.com/wiki/Sudo_and_environment_variables&#34;&gt;sudo and env blog&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://unixhelp.ed.ac.uk/CGI/man-cgi?sudoers+5&#34;&gt;unix help doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://webonrails.com/2012/07/02/allowing-user-to-set-environment-variable-with-sudo/&#34;&gt;blog doc allow&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://superuser.com/questions/232231/how-do-i-make-sudo-preserve-my-environment-variables&#34;&gt;preserving env&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://askubuntu.com/questions/128413/setting-the-path-so-it-applies-to-all-users-including-root-sudo&#34;&gt;ask ubuntu doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.ibm.com/developerworks/aix/library/au-sudo/&#34;&gt;ibm info doc&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>making trivial debian packages</title>
                <link rel="alternate" href="/2013/02/19/making-trivial-debian-packages/" type="text/html" />
                <id>/2013/02/19/making-trivial-debian-packages/</id>
                <updated>2013-02-19T22:06:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;When possible it is beneficial having a canonical reference for resources installed on a server.  Binary packages have built in logic for upgrade, downgrade, install, etc.  This makes them an attractive, yet sometimes, overcomplicated distribution mechanisms.&lt;/p&gt;

&lt;p&gt;I am going to demonstrate making a simple script into a debian binary and installing it.  Adding this to an in-house repo would be a nice next step.&lt;/p&gt;
&lt;h4&gt;Getting Packages&lt;/h4&gt;
&lt;p&gt;Assuming you have dpkg but if not we need it.  Fakeroot we use to make packages with the right permissions on files.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aptitude install dpkg fakeroot lintian
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We will be using dpkg-deb which is generally considered &amp;#39;built in&amp;#39; to debian.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:# dpkg -S /usr/bin/dpkg-deb
dpkg: /usr/bin/dpkg-debø
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Package: my-files.&lt;/h4&gt;
&lt;p&gt;Starting at version 1.0 and meant for all architectures.  &amp;#39;all&amp;#39; is a common assignment for architecture when the files/scripts are interpreted such as with python or ruby.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mkdir my-files_1.0_all
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Making my package tree&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mkdir -p my-files_1.0_all&amp;#47;usr&amp;#47;local&amp;#47;bin&amp;#47;
mkdir -p my-files_1.0_all&amp;#47;DEBIAN
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;My script: aptitude easter eggs&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;nano my-files_1.0_all&amp;#47;usr&amp;#47;local&amp;#47;bin&amp;#47;moo
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
#!/bin/bash
aptitude -v -v -v -v -v moo
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Adding my &amp;#39;control&amp;#39; file&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#this file contains my package metadata
nano my-files_1.0_all&amp;#47;DEBIAN&amp;#47;control
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Looks Like&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
Package: my-files
Priority: optional
Section: misc
Maintainer: Chase &lt;mail@example.com&gt;
Architecture: all
Version: 1.0
Description: stuff I need
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Making my script executable on install&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#postint will be run at the tail end of install by default
echo &amp;quot;chmod +x &amp;#47;usr&amp;#47;local&amp;#47;bin&amp;#47;moo&amp;quot; &amp;gt; my-files_1.0_all&amp;#47;DEBIAN&amp;#47;postinst
#set correct permissions to avoid build errors
chmod 555 my-files_1.0_all&amp;#47;DEBIAN&amp;#47;postinst
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;My full package tree&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
my-files_1.0_all
|-- DEBIAN
|   |-- control
|   `-- postinst
`-- usr
    `-- local
        `-- bin
            `-- moo
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Building my binary&lt;/h4&gt;
&lt;p&gt;Fakeroot should fix up your permissions, permissions are taken very literally by&lt;br&gt;
dpkg-deb.  So if you build with a user that does not exist on a host that installs&lt;br&gt;
this package things break.  But even if you don&amp;#39;t run into that it is considered&lt;br&gt;
bad form to leave your user permissions as artifacts on binary packaged files.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;fakeroot dpkg-deb -b my-files_1.0_all&amp;#47;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Looks Like&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;dpkg-deb: building package `my-files&amp;#39; in `my-files_1.0_all.deb&amp;#39;.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Installing and Examining my package&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
me@vm:# dpkg -i my-files_1.0_all.deb 
Selecting previously unselected package my-files.
(Reading database ... 49666 files and directories currently installed.)
Unpacking my-files (from my-files_1.0_all.deb) ...
Setting up my-files (1.0) ...
me@vm:# 

me@vm:# dpkg -L my-files             
/.
/usr
/usr/local
/usr/local/bin
/usr/local/bin/moo

me@vm:~/pkg# dpkg -s my-files
Package: my-files
Status: install ok installed
Priority: optional
Section: misc
Maintainer: Chase &lt;mail@example.com&gt;
Architecture: all
Version: 1.0
Description: stuff I need
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Using Lintian&lt;/h4&gt;
&lt;p&gt;Lintian breaks down deb binaries and examines them.  If we are making a package for &lt;br&gt;
repo distribution or contribution upstream in some manner we want this output to look&lt;br&gt;
at nice as it can.  For this package I am just making sure we understanding what&lt;br&gt;
compromises we are making.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
me@vm:~/pkg$ lintian my-files_1.0_all.deb 
E: my-files: control-file-has-bad-permissions postinst 0555 != 0755
E: my-files: no-copyright-file
E: my-files: extended-description-is-empty
E: my-files: dir-in-usr-local usr/local/bin/
E: my-files: file-in-usr-local usr/local/bin/moo
W: my-files: file-in-unusual-dir usr/local/bin/moo
W: my-files: script-not-executable usr/local/bin/moo
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Running my command&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
me@vm:# moo
All right, you win.

                               /----\
                       -------/      \
                      /               \
                     /                |
   -----------------/                  --------\
   ----------------------------------------------
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://manpages.ubuntu.com/manpages/hardy/man1/dpkg-deb.1.html&#34;&gt;dpkg-deb reference&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://askubuntu.com/questions/62534/adding-post-deb-install-scripts&#34;&gt;post install scripts doc&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.debian.org/doc/devel-manuals#maint-guidea&#34;&gt;debian maint guide&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.debian.org/doc/manuals/debian-faq/ch-pkg_basics.en.html&#34;&gt;packaging basics&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://unix.stackexchange.com/questions/30303/how-to-create-a-deb-file-manually&#34;&gt;se deb howto&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://ailoo.net/2009/06/repack-a-deb-archive-with-dpkg-deb/&#34;&gt;deb howto blog post&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://tldp.org/HOWTO/html_single/Debian-Binary-Package-Building-HOWTO/#AEN108&#34;&gt;tldp deb howto&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>simple nat outbound cisco asa</title>
                <link rel="alternate" href="/2013/01/23/simple-nat-outbound-asa/" type="text/html" />
                <id>/2013/01/23/simple-nat-outbound-asa/</id>
                <updated>2013-01-23T21:32:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;NAT on the ASA can get complicated but 90% of remote sites need some version of this basic configuration.&lt;/p&gt;
&lt;h4&gt;Interfaces&lt;/h4&gt;
&lt;p&gt;Establish your NAT roles.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
!
interface Ethernet0/0
 nameif Outside
 security-level 0
 ip address &lt;external_ip&gt; &lt;ext_mask&gt;
!
interface Ethernet0/1
 nameif Inside
 security-level 100
 ip address &lt;interval_ip&gt; &lt;internal_mask&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Client Pool&lt;/h4&gt;
&lt;p&gt;Define who gets an address for going out.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
object network NAT-CLIENTS
 !can be a subnet also, etc
 range 192.168.1.1 192.168.1.10
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;NAT Enable&lt;/h4&gt;
&lt;p&gt;Associate your clients with your external interface for NAT.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
nat (Inside,Outside) source dynamic NAT-CLIENTS interface
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;NOTES&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;This does not require extra global IP&amp;#39;s.&lt;/li&gt;
&lt;li&gt;This dynamic IP may supercede intended static NAT IP&amp;#39;s&lt;/li&gt;
&lt;li&gt;Firewall restrictions still apply. See docs on security levels.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://sso.cisco.com/autho/forms/CDClogin.html#wp1118157&#34;&gt;cisco nat docs&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>cli password generation</title>
                <link rel="alternate" href="/2013/01/15/cli-password-generation/" type="text/html" />
                <id>/2013/01/15/cli-password-generation/</id>
                <updated>2013-01-15T21:32:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I notice people using online password generators such as &lt;a href=&#34;http://www.pctools.com/guides/password/&#34;&gt;pctools&lt;/a&gt; and similar sites.  This is less than ideal.  APG is my generator of choice.&lt;/p&gt;
&lt;h4&gt;Six twelve character choices&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@vm:~# apg -m 12
recEbrArkyan
eevocdeirpUd
tejvivFedAt*
loolNuag&amp;gt;olk
ejfoctOdofmu
pidChiemp2of
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Six twelve character choices with phonetics&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@vm:~# apg -m 12 -t
daHedVuobgis (da-Hed-Vu-ob-gis)
lokhanKujTue (lok-han-Kuj-Tue)
ebviHeetsos$ (eb-vi-Heets-os-DOLLAR_SIGN)
agborjotnans (ag-borj-ot-nans)
RutElAmJomt8 (Rut-El-Am-Jomt-EIGHT)
DeOsacFerhyu (De-Os-ac-Fer-hyu)
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;One twelve character password&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@vm:~# apg -m 12 -t -n 1
JetHikAgVup1 (Jet-Hik-Ag-Vup-ONE)
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;One twelve character password with readback&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@vm:~# apg -m 12 -t -n 1 -l
yoawhathuct3 (yoaw-hat-huct-THREE) yankee-oscar-alfa-whiskey-hotel-alfa-tango-hotel-uniform-charlie-tango-THREE
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Increasing randomness with manual entry&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@vm:~# apg -m 12 -t -n 1 -l -s
Please enter some random data (only first 16 are significant)
(eg. your old password):&amp;gt;
yufNifEyLyff (yuf-Nif-Ey-Lyff) yankee-uniform-foxtrot-November-india-foxtrot-Echo-yankee-Lima-yankee-foxtrot-foxtrot
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.pctools.com/guides/password/&#34;&gt;online random password gen &amp;ndash; don&amp;#39;t use&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.linux-magazine.com/Online/Features/Testing-Password-Quality&#34;&gt;article in linux mag&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://help.ubuntu.com/community/StrongPasswords#Installing%20APG&#34;&gt;installing apg&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>mysql cleanup</title>
                <link rel="alternate" href="/2013/01/11/mysql-cleanup/" type="text/html" />
                <id>/2013/01/11/mysql-cleanup/</id>
                <updated>2013-01-11T21:32:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Show me my non-default databases:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;for d in $(mysql -u root -e &amp;quot;show databases&amp;quot; | \
    grep -v &amp;#39;Database\|mysql\|performance_schema\|information_schema&amp;#39;); \
do echo $d; done
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Clean non-default databases:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;for d in $(mysql -u root -e &amp;quot;show databases&amp;quot; | \
    grep -v &amp;#39;Database\|mysql\|performance_schema\|information_schema&amp;#39;); \
do echo $d; mysql -u root -e &amp;quot;drop database $d;&amp;quot;; done
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>linux format code academy python bug</title>
                <link rel="alternate" href="/2012/12/20/linux-format-code-academy-python-bug/" type="text/html" />
                <id>/2012/12/20/linux-format-code-academy-python-bug/</id>
                <updated>2012-12-20T21:32:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I noticed an interesting but simple bug in this issue of Code Academy from the Linux Format guys.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/codeacademy/cacover.png&#34; alt=&#34;cover&#34;&gt;&lt;/p&gt;
&lt;h4&gt;On page 20 regarding the &amp;#39;back to basics section&amp;#39;:&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;/assets/images/codeacademy/capage.png&#34; alt=&#34;cover&#34;&gt;&lt;/p&gt;
&lt;h4&gt;text that is misinformation:&lt;/h4&gt;
&lt;p&gt;&lt;img src=&#34;/assets/images/codeacademy/caexample.png&#34; alt=&#34;cover&#34;&gt;&lt;/p&gt;

&lt;p&gt;&amp;ldquo;Since there is no operator that in Python that lets us switch the position of two elements&amp;hellip;&amp;rdquo;&lt;/p&gt;
&lt;h4&gt;Rebuttal&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
&gt;&gt;&gt; x = 1
&gt;&gt;&gt; y = 2
&gt;&gt;&gt; x
1
&gt;&gt;&gt; y
2
&gt;&gt;&gt; x, y = y, x
&gt;&gt;&gt; x
2
&gt;&gt;&gt; y
1
&gt;&gt;&gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Not a big thing but very misleading especially if you are doing some practical sorting.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>cisco ios xe monitoring oid collection</title>
                <link rel="alternate" href="/2012/12/13/cisco-ios-xe-monitoring-oid-collection/" type="text/html" />
                <id>/2012/12/13/cisco-ios-xe-monitoring-oid-collection/</id>
                <updated>2012-12-13T21:31:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Cisco IOS-XE OID&amp;#39;s for monitoring&lt;/p&gt;
&lt;h4&gt;Memory Walk OID&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;.1.3.6.1.4.1.9.9.48.1.1.1
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This should provide your memory bank OID space.&lt;/p&gt;
&lt;h4&gt;OID keys for memory stats&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mem_bank = 1.3.6.1.4.1.9.9.48.1.1.1.2.
mem_used = 1.3.6.1.4.1.9.9.48.1.1.1.5.
mem_free = 1.3.6.1.4.1.9.9.48.1.1.1.6.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;CPU Walk OID&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;.1.3.6.1.4.1.9.9.109.1.1.1.1.2
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;OID key for CPU usage&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;.1.3.6.1.4.1.9.9.109.1.1.1.1.8.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Interface Walk OID&amp;#39;s&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;64 bit counter use: .1.3.6.1.2.1.31.1.1.1
32 bit counter use: .1.3.6.1.2.1.2.2
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;32 bit counter interface oid&amp;#39;s&lt;/p&gt;
&lt;h4&gt;32bit counter MIBs&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
ifname = 1.3.6.1.2.1.2.2.1.2.
mtu = 1.3.6.1.2.1.2.2.1.4.
ifspeed = 1.3.6.1.2.1.2.2.1.5.
ifAdminStatus = 1.3.6.1.2.1.2.2.1.7.
ifOperStatus = 1.3.6.1.2.1.2.2.1.8.
ifInOctets = .1.3.6.1.2.1.31.1.1.1.6.
ifOutOctets = 1.3.6.1.2.1.2.2.1.16.
physadd = 1.3.6.1.2.1.2.2.1.6.
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;64 bit counter interface oid&amp;#39;s&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
ifname = 1.3.6.1.2.1.31.1.1.1.1.
ifspeed = 1.3.6.1.2.1.31.1.1.1.15.
ifoperstatus = 1.3.6.1.2.1.31.1.1.1.17.
ifinoctets = 1.3.6.1.2.1.31.1.1.1.6.
ifalias = 1.3.6.1.2.1.31.1.1.1.18.
ifinmulticastpkts = 1.3.6.1.2.1.31.1.1.1.2.
ifoutmulticastpkts = 1.3.6.1.2.1.31.1.1.1.4.
ifinbroadcastpkts = 1.3.6.1.2.1.31.1.1.1.3.
ifoutbroadcastpkts = 1.3.6.1.2.1.31.1.1.1.5.
ifoutoctets = 1.3.6.1.2.1.31.1.1.1.10.
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Using The Above OID Successfully&lt;/h4&gt;
&lt;p&gt;So take the memory walk oid.  Want to discover what memory banks we can monitor.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;snmpwalk -v 2c -c community yourhostip .1.3.6.1.4.1.9.9.48.1.1.1
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
CISCO-SMI::ciscoMgmt.48.1.1.1.2.1 = STRING: &#34;Processor&#34;
CISCO-SMI::ciscoMgmt.48.1.1.1.2.14 = STRING: &#34;lsmpi_io&#34;
CISCO-SMI::ciscoMgmt.48.1.1.1.3.1 = INTEGER: 0
CISCO-SMI::ciscoMgmt.48.1.1.1.3.14 = INTEGER: 0
CISCO-SMI::ciscoMgmt.48.1.1.1.4.1 = INTEGER: 1
CISCO-SMI::ciscoMgmt.48.1.1.1.4.14 = INTEGER: 1
CISCO-SMI::ciscoMgmt.48.1.1.1.5.1 = Gauge32: 643028280
CISCO-SMI::ciscoMgmt.48.1.1.1.5.14 = Gauge32: 6294116
CISCO-SMI::ciscoMgmt.48.1.1.1.6.1 = Gauge32: 1097647748
CISCO-SMI::ciscoMgmt.48.1.1.1.6.14 = Gauge32: 972
CISCO-SMI::ciscoMgmt.48.1.1.1.7.1 = Gauge32: 1097325320
CISCO-SMI::ciscoMgmt.48.1.1.1.7.14 = Gauge32: 968
&lt;/code&gt;&lt;/pre&gt; 

&lt;p&gt;Above we can see two distinct memory banks.  One with OID&amp;#39;s ending in &amp;#39;14 and one with&lt;br&gt;
OID&amp;#39;s ending in &amp;#39;1&amp;#39;.&lt;/p&gt;
&lt;h4&gt;Getting our stats for the &amp;#39;lsmpi_io&amp;#39; mem bank, or &amp;#39;14&amp;#39;&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
snmpget -v 2c -c community yourhostip 1.3.6.1.4.1.9.9.48.1.1.1.2..14
1.3.6.1.4.1.9.9.48.1.1.1.2..14: Unknown Object Identifier (Sub-id not found: ciscoMgmt -&gt; .14)

snmpget -v 2c -c community yourhostip 1.3.6.1.4.1.9.9.48.1.1.1.2.14
CISCO-SMI::ciscoMgmt.48.1.1.1.2.14 = STRING: &#34;lsmpi_io&#34;

snmpget -v 2c -c community yourhostip 1.3.6.1.4.1.9.9.48.1.1.1.5.14
CISCO-SMI::ciscoMgmt.48.1.1.1.5.14 = Gauge32: 6294116

snmpget -v 2c -c community yourhostip 1.3.6.1.4.1.9.9.48.1.1.1.6.14
CISCO-SMI::ciscoMgmt.48.1.1.1.6.14 = Gauge32: 972
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Notes&lt;/h4&gt;
&lt;p&gt;This is the way to walk and drill down into any SNMP data set.  Using&lt;br&gt;
MIB&amp;#39;s is much easier but if you know what the OID&amp;#39;s correspond to not&lt;br&gt;
necessary.&lt;/p&gt;

&lt;p&gt;If you are using this to walk the interface index and get statistics it&lt;br&gt;
is important to be aware of &lt;a href=&#34;http://www.cisco.com/en/US/tech/tk648/tk362/technologies_tech_note09186a0080134eec.shtml&#34;&gt;ifindex persist&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>cisco asa oid</title>
                <link rel="alternate" href="/2012/12/11/cisco-asa-oid/" type="text/html" />
                <id>/2012/12/11/cisco-asa-oid/</id>
                <updated>2012-12-11T19:26:00Z</updated>
                
                <summary type="html">Useful ASA OID&amp;#39;s to monitor stats on Cisco ASA OS =&amp;lt; 8.3</summary>
                <content type="html">&lt;p&gt;Useful ASA OID&amp;#39;s to monitor stats on Cisco ASA OS =&amp;lt; 8.3&lt;/p&gt;

&lt;p&gt;fivemincpu = .1.3.6.1.4.1.9.9.109.1.1.1.1.5.1&lt;br&gt;
ikeactivetunnels = .1.3.6.1.4.1.9.9.171.1.2.1.1.0&lt;br&gt;
ikedroppedpacketsin = .1.3.6.1.4.1.9.9.171.1.2.1.5.0&lt;br&gt;
ikedroppedpacketsout = .1.3.6.1.4.1.9.9.171.1.2.1.13.0&lt;br&gt;
iketrafficin = 1.3.6.1.4.1.9.9.171.1.2.1.3.0&lt;br&gt;
iketrafficout = 1.3.6.1.4.1.9.9.171.1.2.1.11.0&lt;br&gt;
ipsecactivetunnels = .1.3.6.1.4.1.9.9.171.1.3.1.1.0&lt;br&gt;
memfree = 1.3.6.1.4.1.9.9.48.1.1.1.6.1&lt;br&gt;
memused = .1.3.6.1.4.1.9.9.48.1.1.1.5.1&lt;br&gt;
rasessions = 1.3.6.1.4.1.9.9.392.1.3.1.0&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>bash then and now</title>
                <link rel="alternate" href="/2012/12/03/bash-then-and-now/" type="text/html" />
                <id>/2012/12/03/bash-then-and-now/</id>
                <updated>2012-12-03T19:26:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Very small doses of limited Bash wisdom.   Changes in my every day&lt;br&gt;
Bash behavior that are small but overtime I think make me more productive.&lt;/p&gt;
&lt;h4&gt;Going home&lt;/h4&gt;
&lt;p&gt;then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd ~
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Erasing the contents of a file&lt;/h4&gt;
&lt;p&gt;then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cat &amp;#47;dev&amp;#47;null &amp;gt; file
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt; file
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Navigating relative dir&amp;#39;s with cd&lt;/h4&gt;
&lt;p&gt;then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd ..&amp;#47;..&amp;#47;..
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;uuu
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
alias u=&#39;cd .. &amp;&amp; ls&#39;
alias uu=&#39;cd ../.. &amp;&amp; ls&#39;
alias uuu=&#39;cd ../../.. &amp;&amp; ls&#39;
alias uuuu=&#39;cd ../../../.. &amp;&amp; ls&#39;
alias uuuuu=&#39;cd ../../../../..&amp;&amp; ls&#39;
alias uuuuuu=&#39;cd ../../../../../.. &amp;&amp; ls&#39;
alias uuuuuuu=&#39;cd ../../../../../../.. &amp;&amp; ls&#39;
alias uuuuuuuu=&#39;cd ../../../../../../../.. &amp;&amp; ls&#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Switching between directories&lt;/h4&gt;
&lt;p&gt;then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd &amp;#47;get&amp;#47;me&amp;#47;there
cd &amp;#47;back&amp;#47;to&amp;#47;you
cd &amp;#47;get&amp;#47;me&amp;#47;there
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cd &amp;#47;get&amp;#47;me&amp;#47;there
cd &amp;#47;back&amp;#47;to&amp;#47;you
cd -

env | grep OLDPWD
OLDPWD=&amp;#47;back&amp;#47;to&amp;#47;you
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Realizing I&amp;#39;m not ready to run a command yet&lt;/h4&gt;
&lt;p&gt;then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;~#get#### stuff#### done &amp;lt;realizing now ready&amp;gt;
&amp;lt;grab mouse, highlight, copy&amp;gt;
&amp;lt;do pre-get#### stuff#### done&amp;gt;
&amp;lt;grab mouse, click, paste&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#command_one... &amp;lt;realizing now ready&amp;gt;
&amp;lt;cntrl+a enter&amp;gt; #goto beginning of line
&amp;lt;cntrl+k enter&amp;gt; #puts in buffer
#do thing that gets me ready for command_one
&amp;lt;cntrl+y enter&amp;gt; #paste from buffer
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;No mouse required.&lt;/p&gt;
&lt;h4&gt;Getting my boxes IP&lt;/h4&gt;
&lt;p&gt;then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ifconfig

&amp;lt;visually search for ip&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#ips
eth0 10.0.0.1&amp;#47;16
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;bash aliases&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;alias ips=&amp;#39;ip brief&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
#IP SHORTCUTS
ip () {
    case &#34;$1&#34; in
        &#39;br&#39;)
            ip brief
            ;;
        &#39;brief&#39;)
            sudo ip addr show | grep inet | grep -v 127 | awk &#39;{print $7, $2}&#39; | grep -v &#39;::&#39;
            ;;
        &#39;alias&#39;)
            echo $&#34;Usage: ip 
                         [alias|br|brief]&#34;
            ;;
        *)
        sudo /bin/ip $@
    esac
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Grepping files&lt;/h4&gt;
&lt;p&gt;then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt; cat &amp;#47;etc&amp;#47;services | grep telnet
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;grep telnet &amp;#47;etc&amp;#47;services
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Exiting (hey&amp;hellip;saves a few keystrokes)&lt;/h4&gt;
&lt;p&gt;then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#exit
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#e

alias EXIT=&amp;quot;exit&amp;quot;
alias e=&amp;#39;exit&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;New dir trees&lt;/h4&gt;
&lt;p&gt;Then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mkdir &amp;#47;one
mkdir &amp;#47;one&amp;#47;two
mkdir &amp;#47;one&amp;#47;two&amp;#47;three
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;mkdir -p one&amp;#47;two&amp;#47;three
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Show routing table&lt;/h4&gt;
&lt;p&gt;Then:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;route -n
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ip route show
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>convert mp3 for asterisk</title>
                <link rel="alternate" href="/2012/11/24/convert-mp3-for-asterisk/" type="text/html" />
                <id>/2012/11/24/convert-mp3-for-asterisk/</id>
                <updated>2012-11-24T01:05:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;I want to use mp3&amp;#39;s for hold music, and for fun.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Convert all mp3&amp;#39;s in a directory for use with asterisk.&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
for f in `ls *.mp3` ; do FILE=$(basename $f .mp3) ; \
ffmpeg -i $FILE.mp3 -ar 8000 -ac 1 -ab 64 $FILE.wav -ar 8000 \
-ac 1 -ab 64 -f mulaw $FILE.pcm -map 0:0 -map 0:0 ; done
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Asterisk Configuration&lt;/h4&gt;
&lt;p&gt;extensions.conf&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;; Answer required as Music On Hold does not answer the call
exten =&amp;gt; 2112,1,Answer
exten =&amp;gt; 2112,2,MusicOnHold(rush)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;I used this to play 2112 whenever you dial extension 2112.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>cisco ios-xe history size</title>
                <link rel="alternate" href="/2012/11/21/cisco-ios-history-size/" type="text/html" />
                <id>/2012/11/21/cisco-ios-history-size/</id>
                <updated>2012-11-21T19:25:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Changing your session buffer for better command navigation.&lt;/p&gt;
&lt;h3&gt;Per VTY&lt;/h3&gt;
&lt;p&gt;History buffer size in IOS is weird.  It&amp;#39;s per VTY.  So you have to &lt;br&gt;
change it for all virtual terminals in service.&lt;/p&gt;

&lt;p&gt;Your VTY configuration probably looks something like:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;line vty 0 4
 transport input ssh
 escape-character 3
line vty 5 15
 transport input ssh
&lt;/code&gt;&lt;/pre&gt;&lt;h3&gt;Change settings for VTY&amp;#39;s&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;line vty 0 15
 !256 is the max
 history size 256
&lt;/code&gt;&lt;/pre&gt;&lt;h3&gt;Alias&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;alias exec hg show history | include
&lt;/code&gt;&lt;/pre&gt;&lt;h3&gt;Looks like:&lt;/h3&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;your_device&amp;gt;#hg conf
    hg conf
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>puppet tagged runs</title>
                <link rel="alternate" href="/2012/11/08/puppet-tagged-runs/" type="text/html" />
                <id>/2012/11/08/puppet-tagged-runs/</id>
                <updated>2012-11-08T21:31:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Updating only relevant Puppet configuration sections&lt;/p&gt;

&lt;p&gt;As a puppet installation grows the list of used modules can get large.  Especially, if you are pulling from &lt;a href=&#34;https://forge.puppetlabs.com/&#34;&gt;puppetlabs&lt;/a&gt;.  Testing in its final stages is usually done via puppet to ensure repeatability.  The test runs get longer and longer.&lt;/p&gt;
&lt;h4&gt;A full catalog run with no expected changes&lt;/h4&gt;
&lt;p&gt;&lt;pre&gt;&lt;code&gt;&lt;br&gt;
sudo /usr/bin/puppet agent --test --logdest syslog&lt;br&gt;
&lt;/pre&gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;pre&gt;&lt;code&gt;&lt;br&gt;
Info: Retrieving plugin&lt;br&gt;
Info: Caching catalog for &lt;myhost&gt;&lt;br&gt;
Info: Applying configuration version &amp;#39;1371116293&amp;#39;&lt;br&gt;
Finished catalog run in 16.35 seconds&lt;br&gt;
&lt;/pre&gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;If you need to rerun this every time you tweak a config file 16 seconds can be a long time.&lt;/p&gt;

&lt;p&gt;If you are only updating a module called &amp;#39;dhcp&amp;#39; you can do:&lt;/p&gt;

&lt;p&gt;&lt;pre&gt;&lt;code&gt;&lt;br&gt;
sudo /usr/bin/puppet agent --test --logdest syslog --tags dhcp&lt;br&gt;
&lt;/pre&gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;pre&gt;&lt;code&gt;&lt;br&gt;
Info: Retrieving plugin&lt;br&gt;
Info: Caching catalog for &lt;myhost&gt;&lt;br&gt;
Info: Applying configuration version &amp;#39;1371116293&amp;#39;&lt;br&gt;
Finished catalog run in 8.46 seconds&lt;br&gt;
&lt;/pre&gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;This cut the time in half.  Doing tagged runs still compiles the entire update.  That is to&lt;br&gt;
say, Puppet still runs in the usual way figuring out dependencies and such, but when it &lt;br&gt;
comes to applicable changes it only looks for changes at the specified tagged resources.&lt;/p&gt;

&lt;p&gt;If you put &amp;#39;&amp;ndash;debug&amp;#39; into the update command you will see a lot of:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Debug: &amp;#47;Stage[main]&amp;#47;Mcollective::Client&amp;#47;Package[mcollective-client]: Not tagged with dhcp
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This resource does not match the tag specified, and as such will not be updated.&lt;/p&gt;

&lt;p&gt;Tags can be explicit or implicit.  That is to say you can assign them and there are some&lt;br&gt;
that are assigned by design.  All class/module names are also tags.&lt;/p&gt;
&lt;h4&gt;This automatically creates a tag called &amp;#39;hiera&amp;#39;:&lt;/h4&gt;
&lt;p&gt;&lt;pre&gt;&lt;code&gt;&lt;br&gt;
class hiera {&lt;br&gt;
}&lt;br&gt;
&lt;/pre&gt;&lt;/code&gt;&lt;/p&gt;
&lt;h4&gt;Resource types are generally given a tag as well.&lt;/h4&gt;
&lt;p&gt;To update file resources only:&lt;/p&gt;

&lt;p&gt;&lt;pre&gt;&lt;code&gt;&lt;br&gt;
sudo /usr/bin/puppet agent --test --logdest syslog --tags file&lt;br&gt;
&lt;/pre&gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;pre&gt;&lt;code&gt;&lt;br&gt;
Info: Retrieving plugin&lt;br&gt;
Info: Caching catalog for &lt;myhost&gt;&lt;br&gt;
Info: Applying configuration version &amp;#39;1371116293&amp;#39;&lt;br&gt;
Finished catalog run in 12.39 seconds&lt;br&gt;
&lt;/pre&gt;&lt;/code&gt;&lt;/p&gt;
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://docs.puppetlabs.com/puppet/2.7/reference/lang_tags.html&#34;&gt;puppet docs&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>mysql full partition</title>
                <link rel="alternate" href="/2012/11/02/mysql-full-partition/" type="text/html" />
                <id>/2012/11/02/mysql-full-partition/</id>
                <updated>2012-11-02T16:37:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Ever go to start mysql and there is not enough disk space.  We need to get MySQL past disk full warnings.&lt;/p&gt;

&lt;p&gt;I tried to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#47;etc&amp;#47;init.d&amp;#47;mysql start
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And saw:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#47;etc&amp;#47;init.d&amp;#47;mysql: ERROR: The partition with &amp;#47;var&amp;#47;lib&amp;#47;mysql is too full! ... failed!
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Usage&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;df -Th
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Filesystem    Type    Size  Used Avail Use% Mounted on
/dev/sda1     ext3    7.6G  7.5G     0 100% /
tmpfs        tmpfs    249M     0  249M   0% /lib/init/rw
udev         tmpfs    244M  172K  244M   1% /dev
tmpfs        tmpfs    249M     0  249M   0% /dev/shm
overflow     tmpfs    1.0M  1.0M     0 100% /tmp
.host:/trunk
            vmhgfs    233G  127G  107G  55% /www/repo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;So I want to take a look at my top disk hogs:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;du -a | sort -nr | head
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
7920858 .
5334316 ./var
3137636 ./var/log
1220480 ./usr
1079740 ./var/cache
1073176 ./var/cache/apt
1040900 ./var/cache/apt/archives
983716  ./var/lib
888564  ./var/log/kern.log
852852  ./var/log/messages
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Looks like /var/log and apt cache are out of control.&lt;/p&gt;

&lt;p&gt;many rm -fR&amp;#39;s later&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
/dev/sda1     ext3    7.6G  5.5G  1.7G  77% /
tmpfs        tmpfs    249M     0  249M   0% /lib/init/rw
udev         tmpfs    244M  172K  244M   1% /dev
tmpfs        tmpfs    249M     0  249M   0% /dev/shm
overflow     tmpfs    1.0M  1.0M     0 100% /tmp
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Let&amp;#39;s try to start:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#47;etc&amp;#47;init.d&amp;#47;mysql start
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Starting MySQL (Percona Server) database server: mysqld ..
Checking for corrupt, not cleanly closed and upgrade needing tables..
ERROR 1030 (HY000) at line 2: Got error 28 from storage engine
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a href=&#34;http://stackoverflow.com/questions/10631387/1030-got-error-28-from-storage-engine&#34;&gt;StackOverflow&lt;/a&gt; tells us this still means &amp;#39;not enough disk space&amp;#39;.&lt;/p&gt;

&lt;p&gt;Obviously we need to clean up /tmp&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
/dev/sda1     ext3    7.6G  5.5G  1.7G  77% /
tmpfs        tmpfs    249M     0  249M   0% /lib/init/rw
udev         tmpfs    244M  172K  244M   1% /dev
tmpfs        tmpfs    249M     0  249M   0% /dev/shm
overflow     tmpfs    1.0M  1.0M     0 100% /tmp
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;rm -fR &amp;#47;tmp&amp;#47;*
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
/dev/sda1     ext3    7.6G  5.5G  1.7G  77% /
tmpfs        tmpfs    249M     0  249M   0% /lib/init/rw
udev         tmpfs    244M  172K  244M   1% /dev
tmpfs        tmpfs    249M     0  249M   0% /dev/shm
overflow     tmpfs    1.0M     0  1.0M   0% /tmp
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Ta-da&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;#47;etc&amp;#47;init.d&amp;#47;mysql start

Starting MySQL (Percona Server) database server: mysqld already running.
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install tmpreaper
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://packages.debian.org/search?keywords=tmpreaper&#34;&gt;Debian tmpreaper&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://stackoverflow.com/questions/10631387/1030-got-error-28-from-storage-engine&#34;&gt;so errors ref&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.merriam-webster.com/dictionary/ta-da&#34;&gt;ta-da&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>mib basics</title>
                <link rel="alternate" href="/2012/10/29/mib-basics/" type="text/html" />
                <id>/2012/10/29/mib-basics/</id>
                <updated>2012-10-29T18:44:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;SNMP is nice but MIB translations can be a pain.  It can also be necessary for figuring&lt;br&gt;
out what certain numbers mean in the MIB tree.&lt;/p&gt;
&lt;h4&gt;Where does SNMP look for MIBs?&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;net-snmp-config --default-mibdirs
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Make user specific directory (needs to be in above path)&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mkdir -p &amp;#47;home&amp;#47;&amp;lt;me&amp;gt;&amp;#47;.snmp&amp;#47;mibs
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Grab MIB data from Cisco (or wherever)&lt;/h4&gt;
&lt;p&gt;Example MIB for Firewall info:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ftp:&amp;#47;&amp;#47;ftp.cisco.com&amp;#47;pub&amp;#47;mibs&amp;#47;v2&amp;#47;CISCO-UNIFIED-FIREWALL-MIB.my
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Copy to:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#47;home&amp;#47;&amp;lt;me&amp;gt;&amp;#47;.snmp&amp;#47;mibs&amp;#47;CISCO-UNIFIED-FIREWALL-MIB
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Enable MIB&lt;/h4&gt;
&lt;p&gt;Find out where SNMP is looking for configuration parameters:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;net-snmp-config --snmpconfpath
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Edit your user snmp configuration (if path is included in above command)&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;n &amp;#47;home&amp;#47;&amp;lt;me&amp;gt;&amp;#47;.snmp&amp;#47;snmp.conf
mib +CISCO-UNIFIED-FIREWALL-MIB
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Try walking the top OID tree&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;snmpwalk -v2c &amp;lt;community&amp;gt; &amp;lt;remote_device_ip&amp;gt;

MIB search path: &amp;#47;home&amp;#47;&amp;lt;me&amp;gt;&amp;#47;.snmp&amp;#47;mibs:&amp;#47;usr&amp;#47;share&amp;#47;mibs&amp;#47;site:&amp;#47;usr&amp;#47;share&amp;#47;snmp&amp;#47;mibs:&amp;#47;usr&amp;#47;share&amp;#47;mibs&amp;#47;iana:&amp;#47;usr&amp;#47;share&amp;#47;mibs&amp;#47;ietf:&amp;#47;usr&amp;#47;share&amp;#47;mibs&amp;#47;netsnmp
Cannot find module (CISCO-SMI): At line 37 in &amp;#47;home&amp;#47;&amp;lt;me&amp;gt;&amp;#47;.snmp&amp;#47;mibs&amp;#47;CISCO-UNIFIED-FIREWALL-MIB
Cannot find module (CISCO-FIREWALL-TC): At line 46 in &amp;#47;home&amp;#47;&amp;lt;me&amp;gt;&amp;#47;.snmp&amp;#47;mibs&amp;#47;CISCO-UNIFIED-FIREWALL-MIB
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;What&amp;#39;s with?  &amp;#39;Cannot find module&amp;#39;&lt;/h4&gt;
&lt;p&gt;This means there are MIB dependencies.  You can probably retrieve these from &lt;a href=&#34;ftp://ftp.cisco.com/pub/mibs/v2&#34;&gt;ftp://ftp.cisco.com/pub/mibs/v2&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;#47;home&amp;#47;&amp;lt;me&amp;gt;&amp;#47;.snmp&amp;#47;mibs&amp;#47;CISCO-SMI
&amp;#47;home&amp;#47;&amp;lt;me&amp;gt;&amp;#47;.snmp&amp;#47;mibs&amp;#47;CISCO-FIREWALL-TC
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Enable these MIBs as well.&lt;/p&gt;
&lt;h4&gt;Walk the tree and enjoy MIB goodness&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;me&amp;gt;@&amp;lt;box&amp;gt;:~# snmpwalk -v2c -c &amp;lt;community&amp;gt; &amp;lt;remote_device_ip&amp;gt; &amp;gt;&amp;gt; snmpinfo.txt
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Show me the basic SNMP catagories&lt;/h4&gt;
&lt;p&gt;You can use cut to see the basics as a full snmpwalk can be a lot of data.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;cut -d: -f 1 snmpinfo.txt | uniq | sort

SNMPv2-MIB
Technical Support
Copyright (c) 1986-2013 by Cisco Systems, Inc.
SNMPv2-MIB
DISMAN-EVENT-MIB
SNMPv2-MIB
IF-MIB
RFC1213-MIB
IP-MIB
IP-FORWARD-MIB
IP-MIB
TCP-MIB
UDP-MIB
SNMPv2-SMI
SNMPv2-MIB
SNMPv2-SMI
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;You can check out DISMAN-EVENT-MIB using grep.  If you find a MIB you can use SNMPGET next time.&lt;/p&gt;
&lt;h4&gt;Retrieve Uptime Using MIB&amp;#39;s and SNMPGET&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;&amp;lt;me&amp;gt;@&amp;lt;box&amp;gt;:~# snmpget -v2c -c &amp;lt;community&amp;gt; &amp;lt;remote_device_ip&amp;gt; DISMAN-EVENT-MIB::sysUpTimeInstance

DISMAN-EVENT-MIB::sysUpTimeInstance = Timeticks: (151866995) 17 days, 13:51:09.95
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;ftp://ftp.cisco.com/pub/mibs/v2/CISCO-SMI.my&#34;&gt;SMI-MIB&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;ftp://ftp.cisco.com/pub/mibs/v2/CISCO-FIREWALL-TC.my&#34;&gt;FIRWALL-MIB&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/public/sw-center/netmgmt/cmtk/mibs.shtml&#34;&gt;MIBS Ref&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.net-snmp.org/wiki/index.php/TUT:Using_and_loading_MIBS&#34;&gt;NETSNMP Howto&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://wiki.debian.org/SNMP&#34;&gt;Debian SNMP Wiki&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/docs/routers/asr1000/mib/guide/asr1mib2.html#wp1034752&#34;&gt;ASR MIB Info One&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/docs/routers/asr1000/mib/guide/asr1mib2.html#wp1024774&#34;&gt;ASR MIB Info Two&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;ftp://ftp.cisco.com/pub/mibs/v2&#34;&gt;Cisco MIB FTP&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>email log alerts</title>
                <link rel="alternate" href="/2012/10/23/email-log-alerts/" type="text/html" />
                <id>/2012/10/23/email-log-alerts/</id>
                <updated>2012-10-23T21:30:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Getting emails based on strings that appear in a log file.&lt;/p&gt;

&lt;p&gt;Heavy duty logging platforms are nice but sometimes you have to make do with the basics.&lt;/p&gt;
&lt;h4&gt;Install&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install log2mail rsyslog
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Rsyslog configuration&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#one dir&amp;#47;file per receiver IP
$template FILENAME,&amp;quot;&amp;#47;var&amp;#47;log&amp;#47;%fromhost-ip%&amp;#47;syslog.log&amp;quot;
*.* ?FILENAME
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Editing log2mail config&lt;/h4&gt;
&lt;p&gt;We want to match a text string in our log file.&lt;/p&gt;

&lt;p&gt;Edit: /etc/log2mail/config/default&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
file = /var/log/&lt;IP&gt;/syslog.log
    pattern = &#34;&lt;YOUR_TEXT_PATTERN&gt;&#34;
    mailto = &lt;you&gt;@&lt;yourdomain&gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;The default alert email&lt;/h4&gt;
&lt;p&gt;Once your string is matched you should get an email:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Hello!

We have matched your pattern &amp;quot;&amp;lt;YOUR_TEXT_PATTERN&amp;gt;&amp;quot; in &amp;quot;&amp;lt;YOUR_LOG_FILE&amp;gt;&amp;quot; 5 times:

&amp;lt;YOUR LOG FILE MATCHES&amp;gt;

Yours,
log2mail.
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;To edit this default template you need to change: /etc/log2mail/mail&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://people.debian.org/%7Eenrico/log2mail/&#34;&gt;log2mail ref&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>iptables flush all rules</title>
                <link rel="alternate" href="/2012/10/15/iptables-flush-all-rules/" type="text/html" />
                <id>/2012/10/15/iptables-flush-all-rules/</id>
                <updated>2012-10-15T19:24:00Z</updated>
                
                <summary type="html">Handy for testing.  Flush iptables.</summary>
                <content type="html">&lt;p&gt;Handy for testing.  Flush iptables.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
iptables -F
iptables -X
iptables -t nat -F
iptables -t nat -X
iptables -t mangle -F
iptables -t mangle -X
iptables -P INPUT ACCEPT
iptables -P FORWARD ACCEPT
iptables -P OUTPUT ACCEPT
iptables -L -n -v
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Dumps empty list when finished&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
Chain INPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain FORWARD (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination         

Chain OUTPUT (policy ACCEPT 0 packets, 0 bytes)
 pkts bytes target     prot opt in     out     source               destination 
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>adding a logfile to splunk</title>
                <link rel="alternate" href="/2012/10/02/adding-a-logfile-to-splunk/" type="text/html" />
                <id>/2012/10/02/adding-a-logfile-to-splunk/</id>
                <updated>2012-10-02T18:42:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Getting standard logfiles into Splunk&lt;/h4&gt;
&lt;p&gt;inputs.conf&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[monitor:&amp;#47;&amp;#47;&amp;#47;var&amp;#47;log&amp;#47;my&amp;#47;file.log]
disabled = false
followTail = 0
host = &amp;lt;HOST&amp;gt;
host_segment = 4
sourcetype = &amp;lt;SOURCE_TYPE_NAME&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;You should add it to to logrotate, Splunk will &amp;quot;tail&amp;quot; it correctly
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>nix lights out failsafe</title>
                <link rel="alternate" href="/2012/09/30/nix-lights-out-failsafe/" type="text/html" />
                <id>/2012/09/30/nix-lights-out-failsafe/</id>
                <updated>2012-09-30T16:45:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Just like for &lt;a href=&#34;http://rush898.github.io/2013/05/29/cisco-lights-out-failsafe/&#34;&gt;cisco&lt;/a&gt; a scheduled reboot can be an aggressive but necessary recovery option.  If you are doing iptables maintenance remote I always like to store my rules in a script and run them without saving.  With a scheduled reboot pending locking myself out is a recoverable offense.&lt;/p&gt;
&lt;h4&gt;/usr/local/bin/rsched&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
#!/bin/bash
if [ -z &#34;$1&#34; ]
  then
    echo &#34;Usage: $0 &lt;minutes_until_reboot&gt;&#34;
    exit 1
fi
echo &#34;reboot interval $1 minutes&#34;
now=`date +&#34;%s&#34;`
#convert seconds to minutes
future_time=`expr $1 \\* 60`
rtime=`expr $now + $future_time`
#convert epoch to shutdown friendly format
time=`date -d @$rtime +&#34;%H:%M&#34;`
echo $time
#issue shutdown
shutdown -k -r $time
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Looks like&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@vm:~# rsched 10
reboot interval 10 minutes
14:11

The system is going DOWN for reboot in 10 minutes!&amp;#47;0) (Wed Jul 10 14:01:57 20
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Scheduling&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@vm:~# nohup rsched 10 &amp;amp;

Broadcast message from root@vm (Wed Jul 10 14:03:02 2013):

The system is going DOWN for reboot in 10 minutes!
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;do my fw maint&lt;/strong&gt;&lt;/p&gt;
&lt;h4&gt;Canceling&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@vm:~# fg
nohup rsched 10

&amp;lt;cntrl+c&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;redirect bg process with &amp;amp;&amp;gt; &amp;#47;tmp&amp;#47;reboot
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>watching linux filesystem events</title>
                <link rel="alternate" href="/2012/09/18/watching-linux-filesystem-events/" type="text/html" />
                <id>/2012/09/18/watching-linux-filesystem-events/</id>
                <updated>2012-09-18T18:42:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;When you need to watch file system events efficiently.&lt;/p&gt;
&lt;h4&gt;Install user land tools:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install inotify-tools
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Waiting for a delete&lt;/h4&gt;
&lt;p&gt;This waits for a file to be deleted and then echo&amp;#39;s:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
inotifywait -e delete_self .&amp;#47;hi&amp;#47;yes  &amp;amp;&amp;amp; echo &amp;quot;gone&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Waiting for a create&lt;/h4&gt;
&lt;p&gt;This watches for files created in a directory and then echo&amp;#39;s.  This&lt;br&gt;
is more appropriately done with the -m option in real life:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
while true; do

inotifywait -e create .&amp;#47;hi  &amp;amp;&amp;amp; echo &amp;quot;yo&amp;quot;
done
&lt;/code&gt;&lt;/pre&gt;&lt;h3&gt;Watching for changes in /home&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
#!/bin/bash
while true; do
    touch /var/log/changes
    inotifywait -r -e create &#34;/home&#34; |
    while read filename eventlist eventfile
    do
        echo &#34;see new $eventfile&#34;
        echo &#34;creation $eventfile&#34; &gt;&gt; /var/log/changes
    done
done
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.infoq.com/articles/inotify-linux-file-system-event-monitoring&#34;&gt;inotify article&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://pyinotify.sourceforge.net/&#34;&gt;pyinotify libs&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.ibm.com/developerworks/library/l-inotify/&#34;&gt;IBM docs&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://blog.lagentz.com/general/automate-your-shell-scripts-using-inotify-and-inotifywait/&#34;&gt;shell script article&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://linux.die.net/man/1/inotifywait&#34;&gt;inotifywait man&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/splitbrain/Watcher&#34;&gt;Python Watch Script&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>monitor interface usage</title>
                <link rel="alternate" href="/2012/09/13/monitor-interface-usage/" type="text/html" />
                <id>/2012/09/13/monitor-interface-usage/</id>
                <updated>2012-09-13T21:30:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I like to use utilities like iftop, but sometimes simple is better.  I found a small example of this but I believe I &lt;br&gt;
have improved the conversions.&lt;/p&gt;
&lt;h4&gt;Example found&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.madmadmod.com/sysadmin/54-how-to-get-the-current-network-bandwidth-usage-on-linux.html&#34;&gt;madmadmod script&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;My version&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
#!/bin/bash

if [ -z &#34;$1&#34; ]; then
        echo
        echo usage: $0 network-interface
        echo
        echo e.g. $0 eth0
        echo
        exit
fi

IF=$1

function bytes2Mbps {
    Mbps=`expr $1 \* 8 / 1048576`
    echo $Mbps
}

while true
do
        R1=`cat /sys/class/net/$1/statistics/rx_bytes`
        T1=`cat /sys/class/net/$1/statistics/tx_bytes`
        sleep 1
        R2=`cat /sys/class/net/$1/statistics/rx_bytes`
        T2=`cat /sys/class/net/$1/statistics/tx_bytes`
        TBPS=`expr $T2 - $T1`
        RBPS=`expr $R2 - $R1`

        TRATE=`bytes2Mbps $TBPS`
        if [ $TRATE -lt 1 ]
        then
            TRATE=`expr $TBPS \* 8`
            TRATE=&#34;$TRATE b/s&#34;
        else
            TRATE=&#34;$TRATE Mb/s&#34;
        fi

        RRATE=`bytes2Mbps $RBPS`
        if [ $RRATE -lt 1 ]
        then
            RRATE=`expr $RBPS \* 8`
            RRATE=&#34;$RRATE b/s&#34;
        else
            RRATE=&#34;$RRATE Mb/s&#34;
        fi

        echo &#34;tx $1: $TRATE rx $1: $RRATE&#34;
done
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Looks like&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;root@&amp;lt;host&amp;gt;:~# .&amp;#47;bw.sh eth0
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If throughput is less than 1Mbps you see:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tx eth0: 0 b&amp;#47;s rx eth0: 528 b&amp;#47;s
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If greater than you get:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;tx eth0: 39 Mb&amp;#47;s rx eth0: 47 Mb&amp;#47;s
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>puppet cert signing</title>
                <link rel="alternate" href="/2012/09/03/puppet-cert-signing/" type="text/html" />
                <id>/2012/09/03/puppet-cert-signing/</id>
                <updated>2012-09-03T23:14:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Setting up a new host with Puppet.  This assumes you have a Puppet Master already going.  One nice thing to do is &lt;br&gt;
have a cname that forwards the &amp;#39;puppet&amp;#39; name to your Puppet Master so that hosts find it easily as the default.&lt;/p&gt;
&lt;h4&gt;Did a host have this name previously?&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@pmaster:~# puppet cert -l -all | g foo.com
+ &amp;quot;foo.com&amp;quot;           (SHA1) &amp;lt;hash&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Remove old serverside cert&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@pmaster:~# puppet cert --clean foo.com 
Revoked certificate with serial 596
Removing file Puppet::SSL::Certificate foo.com at &amp;#39;&amp;#47;var&amp;#47;lib&amp;#47;puppet&amp;#47;ssl&amp;#47;ca&amp;#47;signed&amp;#47;foo.com.pem&amp;#39;
Removing file Puppet::SSL::Certificate foo.com at &amp;#39;&amp;#47;var&amp;#47;lib&amp;#47;puppet&amp;#47;ssl&amp;#47;certs&amp;#47;foo.com.pem&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Request new cert on the client&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;puppet agent --test
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Verify the request is now pending server side&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@pmaster:~# puppet cert -l
&amp;quot;blah.com&amp;quot;           (SHA256) &amp;lt;hash&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Sign your cert&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;me@pmaster:~# puppet cert -s blah.com
Signed certificate request for blah.com
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Run Puppet client side:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;puppet agent --test
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;And done.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>examining PXE boot</title>
                <link rel="alternate" href="/2012/08/29/examining-pxe-boot/" type="text/html" />
                <id>/2012/08/29/examining-pxe-boot/</id>
                <updated>2012-08-29T23:14:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;I have a host with MAC 00:30:48:60:f3:ca.  This host is configured to look for a PXE server, but was not matching &lt;br&gt;
the correct profile.&lt;/p&gt;
&lt;h4&gt;Verify my configuration&lt;/h4&gt;
&lt;p&gt;dhcpd.conf:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;
option PXE.mtftp-cport          code 2 = unsigned integer 16;
option PXE.mtftp-sport          code 3 = unsigned integer 16;
option PXE.mtftp-tmout          code 4 = unsigned integer 8;
option PXE.mtftp-delay          code 5 = unsigned integer 8;
option PXE.discovery-control    code 6 = unsigned integer 8;
option PXE.discovery-mcast-addr code 7 = ip-address;

authoritative;

class &#34;PXEclients&#34; {
    match if (
          (substring (option vendor-class-identifier, 0, 9) = &#34;PXEClient&#34;)
      or  (substring (option vendor-class-identifier, 0, 9) = &#34;Etherboot&#34;));
    option vendor-class-identifier &#34;PXEClient&#34;;
    vendor-option-space PXE;
    option PXE.mtftp-ip 0.0.0.0;
    filename &#34;PXElinux.0&#34;;
    next-server &lt;PXE_server_ip&gt;;
}
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;is DHCP serving correctly?&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
&lt;pxe/tftp/server&gt;.da.bootps &gt; &lt;otherhost&gt;.da.bootpc: BOOTP/DHCP, Reply, length 300
&lt;dhcp_relay&gt;.bootps &gt; &lt;pxe/tftp/server&gt;.da.bootps: BOOTP/DHCP, Request from 00:30:48:60:f3:ca (oui Unknown), length 548
&lt;pxe/tftp/server&gt;.da.bootps &gt; &lt;dhcp_relay&gt;.bootps: BOOTP/DHCP, Reply, length 319
&lt;dhcp_relay&gt;.bootps &gt; &lt;pxe/tftp/server&gt;.da.bootps: BOOTP/DHCP, Request from 00:30:48:60:f3:ca (oui Unknown), length 548
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Is TFTP matching correctly?&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
&lt;me&gt;@&lt;pxe/tftp/server&gt;:~# tcpdump port 69
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on eth0, link-type EN10MB (Ethernet), capture size 65535 bytes
10.0.254.247.2070 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  27 RRQ &#34;PXElinux.0&#34; octet tsize 0
10.0.254.247.2071 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  32 RRQ &#34;PXElinux.0&#34; octet blksize 1456
10.0.254.247.49152 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  79 RRQ &#34;PXElinux.cfg/53d19f64-d663-a017-8922-00304860f3ca&#34; octet tsize 0 blksize 1408
10.0.254.247.49153 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  63 RRQ &#34;PXElinux.cfg/01-00-30-48-60-f3-ca&#34; octet tsize 0 blksize 1408
10.0.254.247.49154 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  51 RRQ &#34;PXElinux.cfg/0A00FEF7&#34; octet tsize 0 blksize 1408
10.0.254.247.49155 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  50 RRQ &#34;PXElinux.cfg/0A00FEF&#34; octet tsize 0 blksize 1408
10.0.254.247.49156 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  49 RRQ &#34;PXElinux.cfg/0A00FE&#34; octet tsize 0 blksize 1408
10.0.254.247.49157 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  48 RRQ &#34;PXElinux.cfg/0A00F&#34; octet tsize 0 blksize 1408
10.0.254.247.49158 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  47 RRQ &#34;PXElinux.cfg/0A00&#34; octet tsize 0 blksize 1408
10.0.254.247.49159 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  46 RRQ &#34;PXElinux.cfg/0A0&#34; octet tsize 0 blksize 1408
10.0.254.247.49160 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  45 RRQ &#34;PXElinux.cfg/0A&#34; octet tsize 0 blksize 1408
10.0.254.247.49161 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  44 RRQ &#34;PXElinux.cfg/0&#34; octet tsize 0 blksize 1408
10.0.254.247.49162 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  50 RRQ &#34;PXElinux.cfg/default&#34; octet tsize 0 blksize 1408
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;PXE is looking for entries that match itself.  So PXE thinks it is:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;53d19f64-d663-a017-8922-00304860f3ca
01-00-30-48-60-f3-ca
0A00FEF7
0A00FEF
0A00FE
0A00F
0A00
0A0
0A
0
default
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;If you look in &amp;#39;/var/tftp/PXElinux.cfg&amp;#39; you see this:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;me&amp;gt;@&amp;lt;pxe&amp;#47;tftp&amp;#47;server&amp;gt;:&amp;#47;var&amp;#47;tftp&amp;#47;PXElinux.cfg# ls -al
-rw-r--r--  1 &amp;lt;me&amp;gt; &amp;lt;me&amp;gt; 1833 May  6 16:58 default
-rw-r--r--  1 &amp;lt;me&amp;gt; &amp;lt;me&amp;gt; 1833 May  6 16:58 reinstall
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This means PXE found the default correctly but I wanted it to find another profile&lt;/p&gt;
&lt;h4&gt;Create a new match:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;ln -s reinstall 01-00-30-48-60-f3-ca

&amp;lt;me&amp;gt;@&amp;lt;pxe&amp;#47;tftp&amp;#47;server&amp;gt;:&amp;#47;var&amp;#47;tftp&amp;#47;PXElinux.cfg# ls -al
lrwxrwxrwx  1 &amp;lt;me&amp;gt; &amp;lt;me&amp;gt;    9 May 24 15:02 01-00-30-48-60-f3-ca -&amp;gt; reinstall
-rw-r--r--  1 &amp;lt;me&amp;gt; &amp;lt;me&amp;gt;  166 May  6 16:58 unattended
-rw-r--r--  1 &amp;lt;me&amp;gt; &amp;lt;me&amp;gt; 1833 May  6 16:58 reinstall
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now I have a match for my PXE host to find that has non-default instructions.  An unattended install.&lt;/p&gt;
&lt;h4&gt;Verify TFTP got the changes&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
&lt;me&gt;@&lt;pxe/tftp/server&gt;:~# tcpdump port 69
lab01.da.2070 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  27 RRQ &#34;PXElinux.0&#34; octet tsize 0
lab01.da.2071 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  32 RRQ &#34;PXElinux.0&#34; octet blksize 1456
lab01.da.49152 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  79 RRQ &#34;PXElinux.cfg/53d19f64-d663-a017-8922-00304860f3ca&#34; octet tsize 0 blksize 1408
lab01.da.49153 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  63 RRQ &#34;PXElinux.cfg/01-00-30-48-60-f3-ca&#34; octet tsize 0 blksize 1408
lab01.da.49154 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  35 RRQ &#34;linux&#34; octet tsize 0 blksize 1408
IP lab01.da.49155 &gt; &lt;pxe/tftp/server&gt;.da.tftp:  39 RRQ &#34;initrd.gz&#34; octet tsize 0 blksize 1408
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;PXE has now matched and my host is reinstalling.&lt;/p&gt;
&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://wiki.debian.org/PXEBootInstall&#34;&gt;pxe debian wiki&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.debian.org/releases/stable/i386/ch04s05.html.en&#34;&gt;relase info&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://andys.org.uk/bits/2010/03/22/pxe-booting-a-debian-squeeze-install/&#34;&gt;howto&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>ssh go forth and do my will</title>
                <link rel="alternate" href="/2012/08/21/ssh-go-forth-and-do-my-will/" type="text/html" />
                <id>/2012/08/21/ssh-go-forth-and-do-my-will/</id>
                <updated>2012-08-21T21:29:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Commands run via SSH silently as a background process.&lt;/p&gt;

&lt;p&gt;Occassionally, I need to run a command on a remote host and I don&amp;#39;t have time to wait for the output.  If success or &lt;br&gt;
failure isn&amp;#39;t a big deal I sometimes use the following method.&lt;/p&gt;
&lt;h4&gt;ls remotely&lt;/h4&gt;
&lt;p&gt;Let&amp;#39;s say I badly need a recursive ls on a box&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;ssh &amp;lt;me&amp;gt;@&amp;lt;server&amp;gt; &amp;#39;nohup ls -R &amp;amp;&amp;gt; &amp;#47;tmp&amp;#47;ls.txt &amp;amp;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Breaking it down&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;ssh         -- obviously you need the client and server
&amp;lt;me&amp;gt;@&amp;lt;server&amp;gt;   -- Please be using key based authentication
&amp;#39;&amp;#39;          -- ssh will accept a one and done command instead of going fully interactive
nohup       -- tell the command do not listen to HUP signal
ls -R       -- for fun we need that file list
&amp;amp;&amp;gt;          -- redirect output.  this is a newer version of this.
&amp;#47;tmp&amp;#47;ls.txt     -- for me to look at later.  note &amp;#47;tmp does not survive reboots.
&amp;amp;           -- run me in the background!
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Looks like&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;rush:~$ ssh rush@&amp;lt;server&amp;gt; &amp;#39;nohup sudo ls -R &amp;amp;&amp;gt; &amp;#47;tmp&amp;#47;ls.txt &amp;amp;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;No output to speak of&amp;hellip;like I said just go do it.&lt;/p&gt;
&lt;h4&gt;What happened&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;rush:~$ ssh rush@&amp;lt;server&amp;gt; &amp;#39;cat &amp;#47;tmp&amp;#47;ls.txt&amp;#39;
.:
1.TXT
bin
git
test.txt
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/Nohup&#34;&gt;nohup wiki&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://stackoverflow.com/questions/954302/how-to-make-a-programme-continue-to-run-after-log-out-from-ssh&#34;&gt;so notes&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>puppet core dump control</title>
                <link rel="alternate" href="/2012/08/17/puppet-core-dump-control/" type="text/html" />
                <id>/2012/08/17/puppet-core-dump-control/</id>
                <updated>2012-08-17T21:29:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;If you have crashes you can enable core dumps via Puppet&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;file { &amp;#39;&amp;#47;var&amp;#47;core&amp;#39;:
    ensure =&amp;gt; directory,
    mode   =&amp;gt; &amp;#39;1777&amp;#39;,
}
-&amp;gt;
# %e = executable name
# %t = timestamp
# %p = pid
sysctl { &amp;#39;kernel.core_pattern&amp;#39;: value =&amp;gt; &amp;#39;&amp;#47;var&amp;#47;core&amp;#47;core.%e.%t.%p&amp;#39; }
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.cyberciti.biz/tips/linux-core-dumps.html&#34;&gt;cyberciti notes&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>last puppet update</title>
                <link rel="alternate" href="/2012/08/16/last-puppet-update/" type="text/html" />
                <id>/2012/08/16/last-puppet-update/</id>
                <updated>2012-08-16T18:44:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;When was this host last updated via puppet?&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
#prints time since last recorded puppet update
#you know...for debugging
last=`grep last_run &amp;#47;var&amp;#47;lib&amp;#47;puppet&amp;#47;state&amp;#47;last_run_summary.yaml | awk {&amp;#39;print $2&amp;#39;}`
now=`date +%s`
SECONDS=`expr $nowa - $last`
MIN=`expr $SECONDS &amp;#47; 60`
HOURS=`expr $MIN &amp;#47; 60`
DAYS=`expr $HOURS &amp;#47; 24`

echo &amp;quot;Since last puppet update&amp;quot;
echo &amp;#39;seconds: &amp;#39;$SECONDS
echo &amp;#39;minutes: &amp;#39;$MIN
if [ $HOURS -gt 0 ]; then
    echo &amp;#39;hours: &amp;#39;$HOURS
fi

if [ $HOURS -gt 0 ]; then
    echo &amp;#39;hours: &amp;#39;$HOURS
fi

if [ $DAYS -gt 0 ]; then
    echo &amp;#39;days: &amp;#39;$DAYS
fi
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Looks like:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;Since last puppet update
seconds: 1345
minutes: 22
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Hours and days are only printed if present.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>simple deb from github python</title>
                <link rel="alternate" href="/2012/08/08/simple-deb-from-github-python/" type="text/html" />
                <id>/2012/08/08/simple-deb-from-github-python/</id>
                <updated>2012-08-08T21:29:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;One of the things I do often is download projects from github.  Pypi (py-pee-eye) is nice and so is pip, but I like to have one reference for packages on a host.  If at all possible I prefer to make binaries.  It is nice for reporting, and because we run our own internal repostories it affords us certain advantages for reporting and dependency handling.&lt;/p&gt;
&lt;h4&gt;Install a few packages:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;aptitude install build-essential python-dev python-setuptools python-stdeb python-support
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Download a project: &lt;a href=&#34;https://github.com/xb95/nagios-api.git&#34;&gt;https://github.com/xb95/nagios-api.git&lt;/a&gt;&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;git clone https:&amp;#47;&amp;#47;github.com&amp;#47;xb95&amp;#47;nagios-api.git
cd nagios-api&amp;#47;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Making a Deb&lt;/h4&gt;
&lt;p&gt;This where with traditional disutils you would do &lt;em&gt;python setup.py install&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;But we can also do&amp;hellip;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;sudo python setup.py --command-packages=stdeb.command bdist_deb

&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;
running bdist_deb
running sdist_dsc
working around Debian #548392, changing XS-Python-Version: to &amp;#39;current&amp;#39;
CALLING dpkg-source -b nagios-api-1.2.1 nagios-api_1.2.1.orig.tar.gz (in dir deb_dist)
dpkg-source: info: using source format `1.0&amp;#39;
...
dpkg-deb: building package `python-nagios-api&amp;#39; in `..&amp;#47;python-nagios-api_1.2.1-1_all.deb&amp;#39;.
dpkg-deb: warning: ignoring 1 warning about the control file(s)
dpkg-genchanges -b &amp;gt;..&amp;#47;nagios-api_1.2.1-1_amd64.changes
dpkg-genchanges: binary-only upload - not including any source code
dpkg-source --after-build nagios-api-1.2.1
dpkg-buildpackage: binary only upload (no source included)
&amp;lt;&amp;#47;code&amp;gt;&amp;lt;&amp;#47;pre&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;That was all it took to create a fully installable binary package:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;dpkg -i deb_dist&amp;#47;python-nagios-api_1.2.1-1_all.deb 

&amp;lt;pre&amp;gt;&amp;lt;code&amp;gt;
Selecting previously deselected package python-nagios-api.
(Reading database ... 38260 files and directories currently installed.)
Unpacking python-nagios-api (from ...&amp;#47;python-nagios-api_1.2.1-1_all.deb) ...
Setting up python-nagios-api (1.2.1-1) ...
Processing triggers for python-support ...
&amp;lt;&amp;#47;code&amp;gt;&amp;lt;&amp;#47;pre&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Changing package particulars&lt;/h4&gt;
&lt;p&gt;stdeb allows you to specify many options you would normally need to provide in a debian control file.  For example&lt;br&gt;
in order to change the name of the package we end up with from &amp;#39;python-nagios-api&amp;#39; to just nagios-api we can do&lt;br&gt;
the the following.&lt;/p&gt;

&lt;p&gt;cd nagios-api/&lt;/p&gt;

&lt;p&gt;n stdeb.cfg #should be in the same dir as setup.py&lt;/p&gt;

&lt;p&gt;contents:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[DEFAULT]
Package: nagios-api
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;
&lt;p&gt;Some repositories will have a problem with the lack of changelog file or other particulars.  Almost always this can &lt;br&gt;
be overcome, but if necessary then you can use:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;python setup.py dh_make
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Reference:&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;https://pypi.python.org/pypi&#34;&gt;pypi&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://lists.debian.org/debian-python/2004/10/msg00017.html&#34;&gt;debian list notes&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/xb95/nagios-api.git&#34;&gt;nagios-api github&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://pypi.python.org/pypi/stdeb#stdeb-cfg-configuration-file&#34;&gt;stdeb pypi&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>extract data with regex python</title>
                <link rel="alternate" href="/2012/08/02/extract-data-with-regex-python/" type="text/html" />
                <id>/2012/08/02/extract-data-with-regex-python/</id>
                <updated>2012-08-02T18:40:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;When dealing with totally unstructured data sometimes it is necessary to go full regex.&lt;/p&gt;
&lt;h4&gt;Extracting values from a string using regex&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;

import re
string = &#39;working on X000 for Y1111&#39;

tag_matches = {&#39;x&#39;: &#39;X\d{1,6}&#39;,
               &#39;y&#39;: &#39;Y\d{1,6}&#39;}

for k, v in tag_matches.iteritems():
    title_search = re.search(v, string, re.IGNORECASE)
    if title_search:
        print k, title_search.group(0)

&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Looks Like:&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;y Y1111
x X000
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Notes&lt;/h4&gt;
&lt;p&gt;One thing I see people do a lot is use regex to replace values in a string.  In python this&lt;br&gt;
is as easy as.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a = &amp;#39;one two three&amp;#39;
print a.replace(&amp;#39;one&amp;#39;, &amp;#39;turtles&amp;#39;)
turles two three
&lt;/code&gt;&lt;/pre&gt;</content>
            </entry>
        
            <entry>
                <title>basic json rest api client</title>
                <link rel="alternate" href="/2012/07/24/basic-json-rest-api-client/" type="text/html" />
                <id>/2012/07/24/basic-json-rest-api-client/</id>
                <updated>2012-07-24T18:42:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;A basic client example for using something like the &lt;a href=&#34;https://github.com/xb95/nagios-api&#34;&gt;nagios api&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;JSON REST API&amp;#39;s are increasingly common and useful.&lt;/p&gt;
&lt;h4&gt;Creating a generic client library&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
import sys
import os
import urllib
import json
import urllib2

class JSONRestClient(object):
    def __init__(self, remote):
        self.url = remote

    def _get(self, trail):
        getme = self.url + trail
        req = urllib2.Request(getme)
        return json.loads(urllib2.urlopen(req, timeout=120).read())

    def _post(self, trail, **kwargs):
        data = json.dumps(kwargs)
        req = urllib2.Request(self.url + trail, data, {&#39;Content-Type&#39;: &#39;application/json&#39;})
        f = urllib2.urlopen(req)
        response = f.read()
        f.close()
        return json.loads(response)

    def state(self):
        return self._get(&#39;state&#39;)
&lt;/code&gt;&lt;/pre&gt;
&lt;h3&gt;Getting state info from nagios api&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;
r = JSONRestClient(&#39;http://remotehost:8080&#39;)
print r.state()
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>modular message of day (debian style)</title>
                <link rel="alternate" href="/2012/07/21/modular-message-of-day-debian-style/" type="text/html" />
                <id>/2012/07/21/modular-message-of-day-debian-style/</id>
                <updated>2012-07-21T18:40:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Granular control over Debian MOTD&lt;/p&gt;

&lt;p&gt;MOTD should be used for more than welcome messages&lt;/p&gt;
&lt;h4&gt;What version am I on?&lt;/h4&gt;
&lt;p&gt;cat /etc/issue&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;Debian GNU&amp;#47;Linux 6.0 \n \l
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;PAM has the ability to build a motd on demand&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;mkdir &amp;#47;etc&amp;#47;update-motd.d&amp;#47;
nano &amp;#47;etc&amp;#47;update-motd.d&amp;#47;test

#!&amp;#47;bin&amp;#47;bash
echo &amp;#39;test&amp;#39;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;em&gt;logout&lt;/em&gt;&lt;br&gt;
&lt;em&gt;login&lt;/em&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;test
rush@&amp;lt;box&amp;gt;:~$ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This way different teams can update the motd, and they can be ordered like 10test, 20test, 30test.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>json api post with curl</title>
                <link rel="alternate" href="/2012/07/18/json-api-post-with-curl/" type="text/html" />
                <id>/2012/07/18/json-api-post-with-curl/</id>
                <updated>2012-07-18T18:10:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Using curl to test a json rest api&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
curl -H &#34;Content-Type: application/json&#34; \
     -X POST -d &#39;{&#34;key&#34;: &#34;value&#34;}&#39; \
      http://localhost:8080/test
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>cisco octets to mbps</title>
                <link rel="alternate" href="/2012/07/12/cisco-octets-to-mbps/" type="text/html" />
                <id>/2012/07/12/cisco-octets-to-mbps/</id>
                <updated>2012-07-12T18:40:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Counters&lt;/h4&gt;
&lt;p&gt;Depending on the type of counter you want to track you can use one of the two&lt;/p&gt;

&lt;p&gt;following oid&amp;#39;s&amp;hellip;&lt;/p&gt;

&lt;p&gt;&amp;#39;64&amp;#39; bit counter =&amp;gt; oid =&amp;gt; &amp;#39;.1.3.6.1.2.1.31.1.1.1&amp;#39;&lt;br&gt;
&amp;#39;32&amp;#39; bit counter =&amp;gt; oid =&amp;gt; &amp;#39;.1.3.6.1.2.1.2.2&amp;#39;&lt;/p&gt;
&lt;h4&gt;Example&lt;/h4&gt;
&lt;p&gt;Transferred octets;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;28879519327687
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;10 seconds later:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;28879428276119
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;That&amp;#39;s 91051568 octets in 10 seconds.&lt;/p&gt;

&lt;p&gt;Divide by 10 for per second value: 9105156&lt;/p&gt;

&lt;p&gt;Multiply by 8 for bits: 72841248&lt;/p&gt;

&lt;p&gt;Divide by 1048576 for Mbps: 69&lt;/p&gt;

&lt;p&gt;Convert octets to Mbps.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&amp;gt;&amp;gt;&amp;gt; 28879519327687 - 28879428276119
91051568
&amp;gt;&amp;gt;&amp;gt; 91051568 &amp;#47; 10 
9105156
&amp;gt;&amp;gt;&amp;gt; 9105156 * 8
72841248
&amp;gt;&amp;gt;&amp;gt; 72841248 &amp;#47; 1048576
69
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Reference:&lt;br&gt;
&lt;a href=&#34;http://www.webnms.com/webnms/tutorials/ges_tutorial/help/appendix/calculating_bandwidth_utilization.html&#34;&gt;howto calc bw&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/tech/tk648/tk362/technologies_tech_note09186a008009496e.shtml&#34;&gt;cisco docs one&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.cisco.com/en/US/tech/tk648/tk362/technologies_q_and_a_item09186a00800b69ac.shtml&#34;&gt;cisco docs two&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>reading json from bash with python</title>
                <link rel="alternate" href="/2012/05/28/reading-json-from-bash-with-python/" type="text/html" />
                <id>/2012/05/28/reading-json-from-bash-with-python/</id>
                <updated>2012-05-28T18:41:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Getting JSON from a flat file in a shell script&lt;/p&gt;

&lt;p&gt;JSON is become a defacto serialization standard.  Getting at the info in Bash is nice.&lt;/p&gt;
&lt;h4&gt;Say you have a file with a json serialized dict from python&lt;/h4&gt;
&lt;p&gt;file: &lt;pre&gt;&lt;code&gt;/var/myfile&lt;/code&gt;&lt;/pre&gt;&lt;/p&gt;

&lt;p&gt;json contents: &lt;pre&gt;&lt;code&gt;{&amp;#39;this&amp;#39;: &amp;#39;you&amp;#39;}&lt;/code&gt;&lt;/pre&gt;&lt;/p&gt;
&lt;h4&gt;Create a script that can access this data&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#!&amp;#47;bin&amp;#47;bash
set -e
FILE=&amp;#39;&amp;#47;var&amp;#47;file&amp;#39;
if [[ ! -a $FILE ]]; then
    exit 0
fi
dict_value=`python -c &amp;#39;import json, os; d=json.loads(open(&amp;quot;&amp;#47;var&amp;#47;file&amp;quot;).read()); print d[&amp;quot;this&amp;quot;]&amp;#39;`
echo $dict_value
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Run it as a command&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;#.&amp;#47;script.sh
you
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;There really doesn&amp;#39;t seem to be a better way to parse json from bash, but this isn&amp;#39;t too bad.&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>asa vpn user admin</title>
                <link rel="alternate" href="/2012/03/19/asa-vpn-user-admin/" type="text/html" />
                <id>/2012/03/19/asa-vpn-user-admin/</id>
                <updated>2012-03-19T21:28:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;The ASA does VPN quite well.  I use some form of &lt;a href=&#34;http://www.cisco.com/en/US/products/ps6120/products_configuration_example09186a00808efbd2.shtml&#34;&gt;this&lt;/a&gt; setup involving a self-signed CA on the ASA and the anyconnect client.  I also like to use the downloadable ACL feature with Cisco ACS or Freeradius.  If you get this going you need to administer users.  This is a brief showing of that.&lt;/p&gt;
&lt;h4&gt;Summary&lt;/h4&gt;&lt;pre&gt;&lt;code&gt;asa# show vpn-sessiondb summary
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
---------------------------------------------------------------------------
VPN Session Summary                                                        
---------------------------------------------------------------------------
                               Active : Cumulative : Peak Concur : Inactive
                             ----------------------------------------------
AnyConnect Client            :      6 :       1193 :          28 :       18
  SSL/TLS/DTLS               :      6 :       1193 :          28 :       18
Clientless VPN               :      1 :          1 :           1
  Browser                    :      1 :          1 :           1
IKEv1 IPsec/L2TP IPsec       :      0 :        977 :           4
---------------------------------------------------------------------------
Total Active and Inactive    :     25             Total Cumulative :   2171
Device Total VPN Capacity    :    250
Device Load                  :    10%
---------------------------------------------------------------------------
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Add/allow/remove&lt;/h4&gt;
&lt;p&gt;Available user commands.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;asa# crypto ca server user-db ?
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
  add        Add a user to the user enrollment database
  allow      Allow enrollment for a user already in the user database
  email-otp  Send One Time Password to the user via e-mail
  remove     Remove a user from the user enrollment database
  show-otp   Show One Time Password
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Adding a user.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;asa# crypto ca server user-db add testuser
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
asa# crypto ca server user-db show-otp user testuser 
Username: testuser
OTP: 12345678910
Enrollment Allowed Until: 09:27:46 PDT Thu Aug 22 2013
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Removing a user.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;asa# crypto ca server user-db remove testuser
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Are you sure you want to remove this user? [yes/no]: yes
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;User Connection Details&lt;/h4&gt;
&lt;p&gt;Getting details on current sessions.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;asa# show vpn-sessiondb anyconnect
&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;
Username     : me                               Index        : 2252
Assigned IP  : 10.x.x.x                         Public IP    : 1.1.1.1
Protocol     : AnyConnect-Parent SSL-Tunnel &lt;-- tunnel protocol
License      : AnyConnect Essentials
Encryption   : RC4 RC4                Hashing      : SHA1 SHA1
Bytes Tx     : 131357                 Bytes Rx     : 90010
Group Policy : &lt;GP applied&gt;           Tunnel Group : &lt;tun grp used&gt;
Login Time   : 09:25:40 PDT Mon Aug 19 2013
Duration     : 0h:06m:44s
Inactivity   : 0h:00m:00s
NAC Result   : Unknown
VLAN Mapping : N/A                    VLAN         : none
&lt;/code&gt;&lt;/pre&gt;
</content>
            </entry>
        
            <entry>
                <title>proxychains</title>
                <link rel="alternate" href="/2012/02/18/proxychains/" type="text/html" />
                <id>/2012/02/18/proxychains/</id>
                <updated>2012-02-18T22:52:00Z</updated>
                
                
                <content type="html">&lt;h4&gt;Preamble&lt;/h4&gt;
&lt;p&gt;Some commands do not natively support a proxy (RE: telnet).  Other times it is just easier to do a one-off instance rather than mess with environment settings.  A lot of people use this with Tor.&lt;/p&gt;
&lt;h4&gt;ProxyChains&lt;/h4&gt;
&lt;p&gt;Allows you to send traffic through a proxy without the command itself having foreknowledge.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;aptitude install proxychains
&lt;/code&gt;&lt;/pre&gt;&lt;h4&gt;Config file options&lt;/h4&gt;
&lt;p&gt;Pick one:&lt;/p&gt;

&lt;p&gt;1  ./proxychains.conf&lt;br&gt;
2  $(HOME)/.proxychains/proxychains.conf&lt;br&gt;
3 /etc/proxychains.conf&lt;/p&gt;
&lt;h4&gt;/etc/proxychains.conf the global option&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
strict_chain
quiet_mode
tcp_read_time_out 15000
tcp_connect_time_out 8000
[ProxyList]
#replace this with your proxy
http    192.168.1.1 8080
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;telnet Before Proxychains (behind a proxy)&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
me@vm:~/pkg$ telnet google.com 80
Trying 2404:6800:4005:806::1006...
Trying 173.194.127.196...
Trying 173.194.127.193...
Trying 173.194.127.200...
Trying 173.194.127.201...
Trying 173.194.127.198...
Trying 173.194.127.199...
Trying 173.194.127.195...
Trying 173.194.127.192...
Trying 173.194.127.206...
Trying 173.194.127.194...
Trying 173.194.127.197...
telnet: Unable to connect to remote host: Network is unreachable
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;telnet after ProxyChains (behind a proxy)&lt;/h4&gt;
&lt;pre&gt;&lt;code&gt;
me@vm:~/pkg$ proxychains telnet google.com 80
ProxyChains-3.1 (http://proxychains.sf.net)
Trying 2404:6800:4005:806::1006...
Trying 173.194.127.196...
Connected to google.com.
Escape character is &#39;^]&#39;.
&lt;/code&gt;&lt;/pre&gt;
&lt;h4&gt;Excluding traffic from your proxy&lt;/h4&gt;
&lt;p&gt;In theory you can set the localnet option in your configuration file to exclude the local LAN by default from proxy  behavior.  This has not worked for me with proxychains under Debian 6.0&lt;/p&gt;

&lt;p&gt;In case you are interested though: &lt;a href=&#34;https://github.com/haad/proxychains/issues/6#issuecomment-4041824&#34;&gt;localnet docs&lt;/a&gt;&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://benizi.com/postfix-proxychains&#34;&gt;article one&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://www.jameslovecomputers.com/how-to-install-configure-and-use-proxychains/&#34;&gt;article two&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://proxychains.sourceforge.net/howto.html&#34;&gt;official howto&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;https://github.com/haad/proxychains&#34;&gt;github&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>internet notoriety</title>
                <link rel="alternate" href="/2012/02/07/internet-notoriety-one/" type="text/html" />
                <id>/2012/02/07/internet-notoriety-one/</id>
                <updated>2012-02-07T21:26:00Z</updated>
                
                <summary type="html">My second day at my last job I showed up early.  I came in the unlocked doors and I set off an insane alarm.  Strobe lights were in effect.  I left a voicemail for my boss that has become something of urban legend.  One of my coworkers posted it on his &lt;a href=&#34;http://www.caffeinatedcoder.com/new-employee-hall-of-fame/&#34;&gt;blog&lt;/a&gt; and it got picked up by someone who blogs regularly at Microsoft.  It was associated with another urban legend story at MS about a new employee dinging the car of someone with the lastname Gates.</summary>
                <content type="html">&lt;p&gt;My second day at my last job I showed up early.  I came in the unlocked doors and I set off an insane alarm.  Strobe lights were in effect.  I left a voicemail for my boss that has become something of urban legend.  One of my coworkers posted it on his &lt;a href=&#34;http://www.caffeinatedcoder.com/new-employee-hall-of-fame/&#34;&gt;blog&lt;/a&gt; and it got picked up by someone who blogs regularly at Microsoft.  It was associated with another urban legend story at MS about a new employee dinging the car of someone with the lastname Gates.&lt;/p&gt;

&lt;p&gt;The original post:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/ione/i1first.png&#34; alt=&#34;the post&#34; title=&#34;blog post&#34;&gt;&lt;/p&gt;

&lt;p&gt;The traceback:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;/assets/images/ione/ione-back2.png&#34; alt=&#34;backtrace&#34; title=&#34;backtrace&#34;&gt;&lt;/p&gt;

&lt;p&gt;I find the whole thing funny.  It is part of my history now.  Someday I may own up my second &amp;#39;Internet Notorious&amp;#39; moment.&lt;/p&gt;
&lt;h4&gt;Reference&lt;/h4&gt;
&lt;p&gt;&lt;a href=&#34;http://www.caffeinatedcoder.com/new-employee-hall-of-fame/&#34;&gt;caffeine coder&lt;/a&gt;&lt;br&gt;
&lt;a href=&#34;http://blogs.msdn.com/b/oldnewthing/archive/2007/09/26/5131601.aspx&#34;&gt;msdn traceback&lt;/a&gt;&lt;/p&gt;
</content>
            </entry>
        
            <entry>
                <title>previous blog long gone -- new beginnings</title>
                <link rel="alternate" href="/2012/02/06/starting-over/" type="text/html" />
                <id>/2012/02/06/starting-over/</id>
                <updated>2012-02-06T17:23:00Z</updated>
                
                <summary type="html">I used to blog useful tidbits and even ran a wiki at one point.  I have decided to start adding new things to this blog, and I will try to track down old posts and incorporate them.  So here&amp;#39;s to someone finding something useful and me learning to express my thoughts more clearly than before!</summary>
                <content type="html">&lt;p&gt;I used to blog useful tidbits and even ran a wiki at one point.  I have decided to start adding new things to this blog, and I will try to track down old posts and incorporate them.  So here&amp;#39;s to someone finding something useful and me learning to express my thoughts more clearly than before!&lt;/p&gt;
</content>
            </entry>
        
    </feed>
